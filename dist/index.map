{"version":3,"sources":["misc-functions/context.ts","misc-functions/creators.ts","consts.ts","misc-functions/namespace.ts","misc-functions/group-resources.ts","misc-functions/file-errors.ts","brigadier/errors.ts","types.ts","misc-functions/return-helper.ts","misc-functions/promisified-fs.ts","misc-functions/third_party/typed-keys.ts","misc-functions/datapack-folder.ts","misc-functions/translation.ts","misc-functions/lsp-conversions.ts","misc-functions/node-tree.ts","data/cache.ts","misc-functions/security.ts","misc-functions/setup.ts","misc-functions/parsing/namespace.ts","misc-functions/parsing/nmsp-tag.ts","misc-functions/index.ts","brigadier/string-reader.ts","parsers/brigadier/bool.ts","parsers/brigadier/string.ts","parsers/brigadier/integer.ts","parsers/brigadier/float.ts","parsers/brigadier/index.ts","parsers/literal.ts","parsers/minecraft/block.ts","parsers/minecraft/component.ts","parsers/minecraft/coordinates.ts","parsers/minecraft/item.ts","colors.ts","data/lists/item-slot.ts","data/lists/scoreboard-slot.ts","data/lists/statics.ts","parsers/minecraft/lists.ts","parsers/minecraft/message.ts","parsers/minecraft/namespace-list.ts","parsers/minecraft/resources.ts","data/lists/criteria.ts","parsers/minecraft/scoreboard.ts","parsers/get-parser.ts","completions.ts","test/blanks.ts","actions.ts","data/extractor/mapfunctions.ts","data/nbt/buffer-stream.ts","data/nbt/parser.ts","data/nbt/nbt-cache.ts","data/datapack-resources.ts","data/extractor/collect-data.ts","data/extractor/download.ts","data/extractor/extract-data.ts","data/extractor/index.ts","data/noncached.ts","data/manager.ts","misc-functions/third_party/merge-deep.ts","parse.ts","index.ts"],"names":[],"mappings":"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","file":"index.map","sourceRoot":"..\\src","sourcesContent":["import { CommandNodePath } from \"../data/types\";\n\nexport interface ContextPath<T> {\n    data: T;\n    path: CommandNodePath;\n}\n\nexport function resolvePaths<T>(\n    paths: Array<ContextPath<T>>,\n    argPath: CommandNodePath\n): T | undefined {\n    for (const path of paths) {\n        if (stringArrayEqual(argPath, path.path)) {\n            return path.data;\n        }\n    }\n    return undefined;\n}\n\nfunction stringArrayEqual(arr1: string[], arr2: string[]): boolean {\n    return arr1.length === arr2.length && arr1.every((v, i) => v === arr2[i]);\n}\n\nexport function startPaths<T>(\n    paths: Array<ContextPath<T>>,\n    argpath: CommandNodePath\n): T | undefined {\n    let best: [number, T?] = [0, undefined];\n    for (const option of paths) {\n        if (\n            option.path.length > best[0] &&\n            option.path.length <= argpath.length &&\n            option.path.every((v, i) => v === argpath[i])\n        ) {\n            best = [option.path.length, option.data];\n        }\n    }\n    return best[1];\n}\n","import { CommandNode, CommandNodePath } from \"../data/types\";\nimport {\n    CommandContext,\n    CommandLine,\n    CommmandData,\n    ParserInfo\n} from \"../types\";\n\n/**\n * Build parser info from the data required\n */\nexport function createParserInfo(\n    node: CommandNode,\n    data: CommmandData,\n    path: CommandNodePath,\n    context: CommandContext,\n    suggesting: boolean\n): ParserInfo {\n    const result: ParserInfo = {\n        context,\n        data,\n        node_properties: node.properties || {},\n        path,\n        suggesting\n    };\n    return result;\n}\n\n/**\n * Convert a string into CommandLines based on newline characters\n */\nexport function splitLines(text: string): CommandLine[] {\n    return createCommandLines(text.split(/\\r?\\n/));\n}\n\n/**\n * Convert the given string array into a blank CommandLine Array\n */\nexport function createCommandLines(lines: string[]): CommandLine[] {\n    const result: CommandLine[] = [];\n    for (const line of lines) {\n        result.push({ text: line });\n    }\n    return result;\n}\n","export const COMMENT_START = \"#\";\nexport const SPACE = \" \";\n\n// Namespaces\nexport const DEFAULT_NAMESPACE = \"minecraft\";\nexport const NAMESPACE = \":\";\nexport const DATAFOLDER = \"data\";\nexport const SLASH = \"/\";\nexport const SLASHREGEX = /\\//g;\nexport const SLASHREPLACEREGEX = /\\\\/g;\nexport const MCMETAFILE = \"pack.mcmeta\";\n\n// Blocks\nexport const TAG_START = \"#\";\n","import { DEFAULT_NAMESPACE, NAMESPACE } from \"../consts\";\nimport { NamespacedName } from \"../data/types\";\n\nexport function namespacesEqual(\n    first: NamespacedName,\n    second: NamespacedName\n): boolean {\n    return namesEqual(first, second) && first.path === second.path;\n}\n\nexport function namesEqual(\n    first: NamespacedName,\n    second: NamespacedName\n): boolean {\n    return (\n        first.namespace === second.namespace ||\n        (isNamespaceDefault(first) && isNamespaceDefault(second))\n    );\n}\n\nexport function isNamespaceDefault(name: NamespacedName): boolean {\n    return name.namespace === undefined || name.namespace === DEFAULT_NAMESPACE;\n}\n\nexport function stringifyNamespace(namespace: NamespacedName): string {\n    return (\n        (namespace.namespace ? namespace.namespace : DEFAULT_NAMESPACE) +\n        NAMESPACE +\n        namespace.path\n    );\n}\n\nexport function convertToNamespace(\n    input: string,\n    splitChar: string = NAMESPACE\n): NamespacedName {\n    const index = input.indexOf(splitChar);\n    if (index >= 0) {\n        const pathContents = input.substring(\n            index + splitChar.length,\n            input.length\n        );\n        // Path contents should not have a : in the contents, however this is to be checked higher up.\n        // This simplifies using the parsed result when parsing options\n\n        // Related: https://bugs.mojang.com/browse/MC-91245 (Fixed)\n        if (index >= 1) {\n            return { namespace: input.substring(0, index), path: pathContents };\n        } else {\n            return { path: pathContents };\n        }\n    } else {\n        return { path: input };\n    }\n}\n","import {\n    GlobalData,\n    MinecraftResource,\n    NamespacedName,\n    Resources,\n    WorldInfo\n} from \"../data/types\";\nimport { CommmandData } from \"../types\";\nimport { namespacesEqual } from \"./namespace\";\n\nexport function getResourcesofType<\n    T extends MinecraftResource = MinecraftResource\n>(resources: CommmandData, type: keyof Resources): T[] {\n    return getResourcesSplit<T>(\n        type,\n        resources.globalData,\n        resources.localData\n    );\n}\n\nexport function getResourcesSplit<\n    T extends MinecraftResource = MinecraftResource\n>(type: keyof Resources, globalData: GlobalData, packsInfo?: WorldInfo): T[] {\n    const results: MinecraftResource[] = [];\n    const globalResources = globalData.resources[type];\n    if (!!globalResources) {\n        results.push(...globalResources);\n    }\n    if (packsInfo) {\n        for (const packId in packsInfo.packs) {\n            if (packsInfo.packs.hasOwnProperty(packId)) {\n                const pack = packsInfo.packs[packId];\n                if (pack.data.hasOwnProperty(type)) {\n                    const data = pack.data[type];\n                    if (!!data) {\n                        results.push(...data);\n                    }\n                }\n            }\n        }\n    }\n    return results as T[];\n}\n\nexport function getMatching<T extends NamespacedName>(\n    resources: T[],\n    value: T\n): T[] {\n    const results: T[] = [];\n    for (const resource of resources) {\n        if (namespacesEqual(resource, value)) {\n            results.push(resource);\n        }\n    }\n    return results;\n}\n","import { MiscInfo } from \"../types\";\n\nexport function createExtensionFileError(\n    filePath: string,\n    expected: string,\n    actual: string\n): MiscInfo {\n    return {\n        filePath,\n        group: \"extension\",\n        kind: \"FileError\",\n        message: `File has incorrect extension: Expected ${expected}, got ${actual}.`\n    };\n}\n\nexport function createJSONFileError(filePath: string, error: any): MiscInfo {\n    return {\n        filePath,\n        group: \"json\",\n        kind: \"FileError\",\n        message: `JSON parsing failed: '${error}'`\n    };\n}\n\nexport function createFileClear(filePath: string, group?: string): MiscInfo {\n    return { kind: \"ClearError\", filePath, group };\n}\n","import { DiagnosticSeverity } from \"vscode-languageserver/lib/main\";\nimport { MCFormat } from \"../misc-functions\";\n\n/**\n * A blank command error\n */\nexport interface BlankCommandError {\n    /**\n     * The code of this error, usable for translation?\n     */\n    code: string;\n    /**\n     * The severity of this error.\n     */\n    severity: DiagnosticSeverity;\n    /**\n     * The substitutions to insert into the error text.\n     */\n    substitutions?: string[];\n    /**\n     * The cached text of this error.\n     */\n    text: string;\n}\n\n/**\n * An error inside a command.\n */\nexport interface CommandError extends BlankCommandError {\n    /**\n     * The range of this error.\n     */\n    range: {\n        end: number;\n        start: number;\n    };\n}\n\n/**\n * Helper class to create command errors\n */\nexport class CommandErrorBuilder {\n    private readonly code: string;\n    private readonly default: string;\n    private readonly severity: DiagnosticSeverity;\n\n    public constructor(\n        code: string,\n        explanation: string,\n        severity: DiagnosticSeverity = DiagnosticSeverity.Error\n    ) {\n        this.code = code;\n        this.default = explanation;\n        this.severity = severity;\n    }\n\n    public create(\n        start: number,\n        end: number,\n        ...substitutions: string[]\n    ): CommandError {\n        const diagnosis: CommandError = Object.assign(\n            this.createBlank(...substitutions),\n            { range: { start, end } }\n        );\n        return diagnosis;\n    }\n\n    public createBlank(...substitutions: string[]): BlankCommandError {\n        return {\n            code: this.code,\n            severity: this.severity,\n            substitutions,\n            text: MCFormat(this.default, ...substitutions)\n        };\n    }\n}\n\n/**\n * Transform `err` into a real command error.\n * MODIFIES `err`\n * @param err The error to transform\n * @param start The starting location in the line of the error\n * @param end The end position\n */\nexport function fillBlankError(\n    err: BlankCommandError,\n    start: number,\n    end: number\n): CommandError {\n    return { ...err, range: { start, end } };\n}\n","import { DataInterval, Interval, IntervalTree } from \"node-interval-tree\";\nimport { JSONDocument } from \"vscode-json-languageservice\";\nimport {\n    CompletionItemKind,\n    InsertTextFormat,\n    MarkedString,\n    MarkupContent,\n    TextDocument\n} from \"vscode-languageserver/lib/main\";\nimport { BlankCommandError, CommandError } from \"./brigadier/errors\";\nimport { StringReader } from \"./brigadier/string-reader\";\nimport { CommandNodePath, GlobalData, LocalData } from \"./data/types\";\nimport { PackLocationSegments } from \"./misc-functions\";\n\n//#region Document\nexport interface FunctionInfo {\n    lines: CommandLine[];\n    /**\n     * The filesystem path to the `datapacks` folder this is part of - NOT the folder of the single datapack\n     */\n    pack_segments: PackLocationSegments | undefined;\n}\n\nexport interface WorkspaceSecurity {\n    // CustomParsers?: boolean;\n    JarPath?: boolean;\n    JavaPath?: boolean;\n}\n\nexport interface CommandLine {\n    /**\n     * A cache of the tree of actions\n     */\n    actions?: IntervalTree<SubAction>;\n    nodes?: IntervalTree<ParseNode>;\n    parseInfo?: StoredParseResult | false;\n    text: string;\n}\n//#endregion\n\n//#region Interaction with parsers\nexport interface ParserInfo {\n    /**\n     * The immutable context\n     */\n    context: CommandContext;\n    data: CommmandData;\n    node_properties: Dictionary<any>;\n    path: CommandNodePath; // Will be > 0\n    /**\n     * When suggesting, the end of the reader's string will be the cursor position\n     */\n    suggesting: boolean;\n}\n\nexport interface CommmandData {\n    globalData: GlobalData;\n    /**\n     * Data from datapacks\n     */\n    localData?: LocalData;\n}\n\nexport interface Suggestion {\n    description?: string | MarkupContent;\n    insertTextFormat?: InsertTextFormat;\n    kind?: CompletionItemKind;\n    label?: string;\n    /**\n     * The start from where value should be replaced. 0 indexed character gaps.\n     * E.g. `@e[na` with the suggestion `{value:\"name=\",start:3}`\n     * would make `@e[name=` when accepted.\n     */\n    start: number;\n    text: string;\n}\n\nexport type SuggestResult = Suggestion | string;\n\n/**\n * A change to the shared context\n */\nexport type ContextChange = Partial<CommandContext> | undefined;\n\nexport interface CommandContext {\n    /**\n     * Whether the executor is definitely a player.\n     * (Currently unused)\n     */\n    isPlayer?: boolean;\n    [key: string]: any;\n}\n\nexport interface Parser {\n    /**\n     * The default suggestion kind for suggestions from this parser\n     */\n    kind?: CompletionItemKind;\n    /**\n     * Parse the argument as described in NodeProperties against this parser in the reader.\n     * Gets both suggestions and success\n     */\n    parse(\n        reader: StringReader,\n        properties: ParserInfo\n    ): ReturnedInfo<ContextChange | undefined>;\n}\n\n//#endregion\n//#region ParsingData\nexport interface ParseNode extends Interval {\n    context: CommandContext;\n    final: boolean;\n    path: CommandNodePath;\n}\n\nexport interface StoredParseResult {\n    actions: SubAction[];\n    errors: CommandError[];\n    nodes: ParseNode[];\n}\n\ninterface SubActionBase<U extends string, T> extends DataInterval<T> {\n    type: U;\n}\n\nexport interface JSONDocInfo {\n    json: JSONDocument;\n    text: TextDocument;\n}\n\nexport type SubAction =\n    // See https://github.com/Microsoft/language-server-protocol/issues/518.\n    | SubActionBase<\"hover\", MarkedString>\n    | SubActionBase<\"format\", string>\n    | SubActionBase<\"source\", string>\n    | SubActionBase<\"json\", JSONDocInfo>;\n// | SubActionBase<\"rename\", RenameRequest>;\n//#endregion\nexport type Success = true;\nexport const success: Success = true;\n\nexport const failure: Failure = false;\nexport type Failure = false;\n\n//#region ReturnData\nexport interface ReturnData<ErrorKind extends BCE = CE> {\n    actions: SubAction[];\n    errors: ErrorKind[];\n    /**\n     * Points not related to a specific line being parsed.\n     * This includes errors inside a file for example.\n     */\n    misc: MiscInfo[];\n    suggestions: SuggestResult[];\n}\n\ntype MiscInfoBase<kind extends string, value> = value & {\n    kind: kind;\n};\n\nexport type MiscInfo =\n    | MiscInfoBase<\"FileError\", FileError>\n    | MiscInfoBase<\"ClearError\", ClearFileError>;\n\ninterface FileError {\n    filePath: string;\n    group: string;\n    message: string;\n}\n\ninterface ClearFileError {\n    filePath: string;\n    group?: string;\n}\n\n/**\n * A general return type which can either succeed or fail, bringing other data\n */\nexport type ReturnedInfo<T, ErrorKind extends BCE = CE, E = undefined> =\n    | ReturnSuccess<T, ErrorKind>\n    | ReturnFailure<E, ErrorKind>;\n\nexport interface ReturnFailure<K = undefined, ErrorKind extends BCE = CE>\n    extends ReturnData<ErrorKind> {\n    data: K;\n    kind: Failure;\n}\n\nexport interface ReturnSuccess<T, ErrorKind extends BCE = CE>\n    extends ReturnData<ErrorKind> {\n    data: T;\n    kind: Success;\n}\n//#endregion\n// Helper types to lower the amount of repetition of the names\nexport type BCE = BlankCommandError;\nexport type CE = CommandError;\n","import {\n    BlankCommandError,\n    CommandError,\n    fillBlankError\n} from \"../brigadier/errors\";\nimport {\n    BCE,\n    CE,\n    Failure,\n    failure,\n    MiscInfo,\n    ParserInfo,\n    ReturnData,\n    ReturnedInfo,\n    ReturnFailure,\n    ReturnSuccess,\n    SubAction,\n    success,\n    Success,\n    Suggestion,\n    SuggestResult\n} from \"../types\";\n\n/**\n * Create an instance of the common return type\n */\nfunction createReturn<ErrorKind extends BCE = CE>(): ReturnData<ErrorKind> {\n    return { actions: [], errors: [], suggestions: [], misc: [] };\n}\n\n/**\n * Test if `input` is successful\n * @param input The info to test\n */\nexport function isSuccessful<T, E extends BCE = CE>(\n    input: ReturnedInfo<T, E, any>\n): input is ReturnSuccess<T, E> {\n    return input.kind === success;\n}\n\n/**\n * Fill the blank errors in data with 'real' errors\n * MODIFIES `data`\n * @param data The data to modify\n * @param start The starting position of the area the errors should cover\n * @param end The end position\n */\nexport function fillBlanks<T>(\n    data: ReturnedInfo<T, BCE>,\n    start: number,\n    end: number\n): ReturnedInfo<T>;\nexport function fillBlanks(\n    data: ReturnData<BCE>,\n    start: number,\n    end: number\n): ReturnData {\n    const errors = [];\n    for (const err of data.errors) {\n        errors.push(fillBlankError(err, start, end));\n    }\n    return { ...data, errors };\n}\n\nexport class ReturnHelper<Errorkind extends BlankCommandError = CommandError> {\n    private readonly data: ReturnData<Errorkind> = createReturn<Errorkind>();\n    private readonly suggesting?: boolean;\n\n    public constructor(suggesting?: ParserInfo | boolean) {\n        if (typeof suggesting !== \"undefined\") {\n            if (typeof suggesting === \"boolean\") {\n                this.suggesting = suggesting;\n                return;\n            }\n            this.suggesting = suggesting.suggesting;\n        }\n    }\n\n    public addActions(...actions: SubAction[]): this {\n        if (this.suggesting === undefined || !this.suggesting) {\n            this.data.actions.push(...actions);\n        }\n        return this;\n    }\n\n    public addErrors(...errs: Errorkind[]): this {\n        if (this.suggesting === undefined || !this.suggesting) {\n            this.data.errors.push(...errs);\n        }\n        return this;\n    }\n\n    public addFileErrorIfFalse(\n        option: boolean,\n        filePath: string,\n        group: string,\n        message: string\n    ): option is true {\n        if (!option) {\n            this.addMisc({ group, message, filePath, kind: \"FileError\" });\n        } else {\n            this.addMisc({ group, filePath, kind: \"ClearError\" });\n        }\n        return option;\n    }\n    public addMisc(...others: MiscInfo[]): this {\n        if (this.suggesting === undefined || !this.suggesting) {\n            this.data.misc.push(...others);\n        }\n        return this;\n    }\n\n    public addSuggestion(\n        start: number,\n        text: string,\n        kind?: Suggestion[\"kind\"],\n        description?: string\n    ): this {\n        if (this.suggesting === undefined || this.suggesting) {\n            this.addSuggestions({\n                description,\n                kind,\n                start,\n                text\n            });\n        }\n        return this;\n    }\n    public addSuggestions(...suggestions: SuggestResult[]): this {\n        if (this.suggesting === undefined || this.suggesting) {\n            this.data.suggestions.push(...suggestions);\n        }\n        return this;\n    }\n\n    public fail(err?: Errorkind): ReturnFailure<undefined, Errorkind> {\n        if (!!err && !this.suggesting) {\n            this.addErrors(err);\n        }\n        return {\n            ...this.getShared(),\n            kind: failure as Failure\n        } as ReturnFailure<undefined, Errorkind>;\n    }\n\n    public failWithData<T>(data: T): ReturnFailure<T, Errorkind> {\n        return { ...this.getShared(), data, kind: failure as Failure };\n    }\n    public getShared(): ReturnData<Errorkind> {\n        return this.data;\n    }\n\n    public merge<T>(\n        merge: ReturnedInfo<T, Errorkind, any>,\n        suggestOverride?: boolean\n    ): merge is ReturnSuccess<T, Errorkind> {\n        this.mergeChain(merge, suggestOverride);\n        return isSuccessful(merge);\n    }\n\n    public mergeChain(\n        merge: ReturnedInfo<any, Errorkind>,\n        suggestOverride?: boolean\n    ): this {\n        let suggest: boolean | undefined;\n        if (suggestOverride !== undefined) {\n            suggest = suggestOverride;\n        } else {\n            if (this.suggesting !== undefined) {\n                suggest = this.suggesting;\n            }\n        }\n        switch (suggest) {\n            case true:\n                this.mergeSuggestions(merge);\n                break;\n            case false:\n                this.mergeSafe(merge);\n                break;\n            default:\n                this.mergeSuggestions(merge);\n                this.mergeSafe(merge);\n        }\n        return this;\n    }\n\n    public return<T, E>(\n        other: ReturnedInfo<T, Errorkind, E>\n    ): ReturnedInfo<T, Errorkind, E> {\n        if (this.merge(other)) {\n            return this.succeed(other.data);\n        } else {\n            return this.failWithData(other.data);\n        }\n    }\n\n    public succeed<T extends undefined>(\n        data?: T\n    ): ReturnSuccess<undefined, Errorkind>;\n    public succeed<T>(data: T): ReturnSuccess<T, Errorkind>;\n    public succeed<T>(data: T): ReturnSuccess<T, Errorkind> {\n        return { ...this.getShared(), data, kind: success as Success };\n    }\n\n    private mergeSafe(merge: ReturnData<Errorkind>): void {\n        this.addActions(...merge.actions);\n        this.addErrors(...merge.errors);\n        this.addMisc(...merge.misc);\n    }\n\n    private mergeSuggestions(merge: ReturnData<Errorkind>): void {\n        this.addSuggestions(...merge.suggestions);\n    }\n}\n\nexport function prepareForParser(\n    info: ReturnedInfo<any>,\n    suggesting: boolean | ParserInfo\n): ReturnedInfo<undefined> {\n    const helper = new ReturnHelper(suggesting);\n    if (helper.merge(info)) {\n        return helper.succeed();\n    } else {\n        return helper.fail();\n    }\n}\n","import * as fs from \"fs\";\nimport * as path from \"path\";\nimport { shim } from \"util.promisify\";\nshim();\nimport { promisify } from \"util\";\nimport { ReturnedInfo } from \"../types\";\nimport { createJSONFileError } from \"./file-errors\";\nimport { ReturnHelper } from \"./return-helper\";\n\nexport const readFileAsync = promisify(fs.readFile);\nexport const saveFileAsync = promisify(fs.writeFile);\nexport const mkdirAsync = promisify(fs.mkdir);\nexport const readDirAsync = promisify(fs.readdir);\nexport const statAsync = promisify(fs.stat);\n\nexport async function readJSONRaw<T>(filePath: string): Promise<T> {\n    const buffer = await readFileAsync(filePath);\n    return JSON.parse(buffer.toString());\n}\n\nexport async function writeJSON(filepath: string, o: object): Promise<void> {\n    await saveFileAsync(filepath, JSON.stringify(o, undefined, 4));\n}\n\nexport async function readJSON<T>(filePath: string): Promise<ReturnedInfo<T>> {\n    const helper = new ReturnHelper();\n    let buffer: Buffer;\n    try {\n        buffer = await readFileAsync(filePath);\n    } catch (error) {\n        mcLangLog(`File at '${filePath}' not available: ${error}`);\n        return helper.fail();\n    }\n    try {\n        const result = JSON.parse(buffer.toString());\n        return helper.succeed<T>(result);\n    } catch (e) {\n        return helper.addMisc(createJSONFileError(filePath, e)).fail();\n    }\n}\n\nexport async function walkDir(currentPath: string): Promise<string[]> {\n    const subFolders: string[] = [];\n    try {\n        subFolders.push(...(await readDirAsync(currentPath)));\n    } catch (error) {\n        return [];\n    }\n    const promises = subFolders.map(async sub => {\n        try {\n            const files: string[] = [];\n            const subFile = path.join(currentPath, sub);\n            if ((await statAsync(subFile)).isDirectory()) {\n                files.push(...(await walkDir(subFile)));\n            } else {\n                files.push(subFile);\n            }\n            return files;\n        } catch (error) {\n            return [];\n        }\n    });\n    const results = await Promise.all(promises);\n    return ([] as string[]).concat(...results);\n}\n","/**\n * Get the keys of the object in a way friendly to\n * the typescript compiler.\n * Taken from https://github.com/Microsoft/TypeScript/pull/12253#issuecomment-353494273\n * @param o The object to get the keys of.\n */\nexport function typed_keys<O>(o: O): Array<keyof O> {\n    return Object.keys(o) as Array<keyof O>;\n}\n","import * as defaultPath from \"path\";\nimport {\n    DATAFOLDER,\n    SLASH,\n    SLASHREGEX,\n    SLASHREPLACEREGEX,\n    TAG_START\n} from \"../consts\";\nimport {\n    DataResource,\n    GlobalData,\n    MinecraftResource,\n    NamespacedName,\n    Resources,\n    Tag,\n    WorldInfo\n} from \"../data/types\";\nimport { ReturnSuccess } from \"../types\";\nimport { getMatching, getResourcesSplit } from \"./group-resources\";\nimport { convertToNamespace } from \"./namespace\";\nimport { readJSON } from \"./promisified-fs\";\nimport { ReturnHelper } from \"./return-helper\";\nimport { typed_keys } from \"./third_party/typed-keys\";\n\n/** A minimal path module for use in this file */\ntype PathModule = Pick<\n    typeof import(\"path\").posix, // N.B. `.posix` is required.\n    \"extname\" | \"sep\" | \"format\" | \"isAbsolute\" | \"join\" | \"normalize\" | \"parse\"\n>;\n\nexport interface PackLocationSegments {\n    pack: string;\n    packsFolder: string;\n    rest: string;\n}\n\n/**\n * Find the datapacks folder a file is in.\n * @param fileLocation The URI of the file\n * @param path The path module to use (allows for testing).\n */\nexport function parseDataPath(\n    fileLocation: string,\n    path: PathModule = defaultPath\n): PackLocationSegments | undefined {\n    const parsed = path.parse(path.normalize(fileLocation));\n    const dirs = parsed.dir.split(path.sep);\n    const packsFolderIndex = dirs.indexOf(\"datapacks\");\n    if (packsFolderIndex !== -1) {\n        const remainder = dirs.slice(packsFolderIndex + 1);\n        if (remainder.length >= 1) {\n            let packsFolder = path.join(...dirs.slice(0, packsFolderIndex + 1));\n            // Ugly hack because path.join ignores a leading empty dir, leading to the result of\n            // `/home/datapacks` going to `home/datapacks`\n            if (path.sep === \"/\" && !path.isAbsolute(packsFolder)) {\n                packsFolder = path.sep + packsFolder;\n            }\n            packsFolder = path.format({ dir: packsFolder });\n            const rest = path.join(...remainder.slice(1), parsed.base);\n            return { packsFolder, pack: remainder[0], rest };\n        }\n    }\n    return undefined;\n}\n\ninterface ResourceInfo<U extends keyof Resources> {\n    extension: string;\n    path: [U] | string[]; // Custom tuple improves autocomplete mostly.\n    mapFunction?(\n        value: NonNullable<Resources[U]> extends Array<infer T> ? T : never,\n        packroot: string,\n        globalData: GlobalData,\n        packsInfo?: WorldInfo\n    ): Promise<ReturnSuccess<typeof value>>;\n}\n\nexport const resourceTypes: { [T in keyof Resources]-?: ResourceInfo<T> } = {\n    advancements: { extension: \".json\", path: [\"advancements\"] },\n    block_tags: {\n        extension: \".json\",\n        mapFunction: async (v, packroot, globalData, packsInfo) =>\n            readTag(\n                v,\n                packroot,\n                \"block_tags\",\n                getResourcesSplit(\"block_tags\", globalData, packsInfo),\n                s => globalData.blocks.hasOwnProperty(s)\n            ),\n        path: [\"tags\", \"blocks\"]\n    },\n    function_tags: {\n        extension: \".json\",\n        mapFunction: async (v, packroot, globalData, packsInfo) => {\n            const functions = getResourcesSplit(\n                \"functions\",\n                globalData,\n                packsInfo\n            );\n            return readTag(\n                v,\n                packroot,\n                \"function_tags\",\n                getResourcesSplit(\"function_tags\", globalData, packsInfo),\n                s => getMatching(functions, convertToNamespace(s)).length > 0\n            );\n        },\n        path: [\"tags\", \"functions\"]\n    },\n    functions: { extension: \".mcfunction\", path: [\"functions\"] },\n    item_tags: {\n        extension: \".json\",\n        mapFunction: async (v, packroot, globalData, packsInfo) =>\n            readTag(\n                v,\n                packroot,\n                \"item_tags\",\n                getResourcesSplit(\"item_tags\", globalData, packsInfo),\n                s => globalData.items.indexOf(s) !== -1\n            ),\n        path: [\"tags\", \"items\"]\n    },\n    loot_tables: { extension: \".json\", path: [\"loot_tables\"] },\n    recipes: { extension: \".json\", path: [\"recipes\"] },\n    structures: { extension: \".nbt\", path: [\"structures\"] }\n};\n\ninterface KindNamespace {\n    kind: keyof Resources;\n    location: NamespacedName & { namespace: string };\n}\n\nexport function getKindAndNamespace(\n    rest: string,\n    path: PathModule = defaultPath\n): KindNamespace | undefined {\n    const sections = path.normalize(rest).split(path.sep);\n    if (sections[0] === DATAFOLDER && sections.length > 2) {\n        // Namespace,data,\n        const remainder = sections.splice(2);\n        for (const kind of typed_keys(resourceTypes)) {\n            const typeInfo = resourceTypes[kind];\n            if (\n                (typeInfo.path as string[]).every((v, i) => remainder[i] === v)\n            ) {\n                const namespace = sections[1];\n                const further = remainder.slice(typeInfo.path.length);\n                if (further.length > 0) {\n                    const last = further[further.length - 1];\n                    if (path.extname(last) === typeInfo.extension) {\n                        const pth = path\n                            .join(\n                                ...further.slice(0, -1),\n                                last.slice(0, -typeInfo.extension.length)\n                            )\n                            .replace(SLASHREPLACEREGEX, SLASH);\n                        return {\n                            kind,\n                            location: {\n                                namespace,\n                                path: pth\n                            }\n                        };\n                    }\n                }\n            }\n        }\n    }\n    return undefined;\n}\n\nexport function getPath(\n    resource: MinecraftResource,\n    packroot: string,\n    kind: keyof Resources,\n    path: PathModule = defaultPath\n): string {\n    return path.join(\n        packroot,\n        DATAFOLDER,\n        resource.namespace,\n        ...resourceTypes[kind].path,\n        resource.path\n            .replace(SLASHREGEX, path.sep)\n            .concat(resourceTypes[kind].extension)\n    );\n}\n\nexport function buildPath(\n    resource: MinecraftResource,\n    packs: WorldInfo,\n    kind: keyof Resources,\n    path: PathModule = defaultPath\n): string | undefined {\n    if (resource.pack !== undefined) {\n        const pack = packs.packs[resource.pack];\n        return getPath(\n            resource,\n            path.join(packs.location, pack.name),\n            kind,\n            path\n        );\n    } else {\n        return undefined;\n    }\n}\n\nasync function readTag(\n    resource: MinecraftResource,\n    packRoot: string,\n    type: keyof Resources,\n    options: MinecraftResource[],\n    isKnown: (value: string) => boolean\n): Promise<ReturnSuccess<DataResource<Tag> | MinecraftResource>> {\n    const helper = new ReturnHelper();\n    const filePath = getPath(resource, packRoot, type);\n    const tag = await readJSON<Tag>(filePath);\n    if (helper.merge(tag)) {\n        if (\n            helper.addFileErrorIfFalse(\n                !!tag.data.values,\n                filePath,\n                \"InvalidTagNoValues\",\n                `tag does not have a values key: ${JSON.stringify(tag.data)}`\n            )\n        ) {\n            if (\n                helper.addFileErrorIfFalse(\n                    Array.isArray(tag.data.values),\n                    filePath,\n                    \"InvalidTagValuesNotArray\",\n                    `tag values is not an array: ${JSON.stringify(\n                        tag.data.values\n                    )}`\n                )\n            ) {\n                if (\n                    helper.addFileErrorIfFalse(\n                        // tslint:disable-next-line:strict-type-predicates\n                        tag.data.values.every(v => typeof v === \"string\"),\n                        filePath,\n                        \"InvalidTagValuesNotString\",\n                        `tag values contains a non string value: ${JSON.stringify(\n                            tag.data.values\n                        )}`\n                    )\n                ) {\n                    const seen = new Set<string>();\n                    const duplicates = new Set<string>();\n                    const unknowns = new Set<string>();\n                    for (const value of tag.data.values) {\n                        if (seen.has(value)) {\n                            duplicates.add(value);\n                        }\n                        seen.add(value);\n                        if (value.startsWith(TAG_START)) {\n                            const result = getMatching(\n                                options,\n                                convertToNamespace(value)\n                            );\n                            if (result.length === 0) {\n                                unknowns.add(value);\n                            }\n                        } else if (!isKnown(value)) {\n                            unknowns.add(value);\n                        }\n                    }\n                    helper.addFileErrorIfFalse(\n                        duplicates.size === 0,\n                        filePath,\n                        \"InvalidTagValuesDuplicates\",\n                        `Tag contains duplicate values: \"${[...duplicates].join(\n                            '\", \"'\n                        )}\"`\n                    );\n                    helper.addFileErrorIfFalse(\n                        unknowns.size === 0,\n                        filePath,\n                        \"InvalidTagValuesUnknown\",\n                        `Tag contains unknown values: \"${[...unknowns].join(\n                            '\", \"'\n                        )}\"`\n                    );\n                    return helper.succeed({\n                        ...resource,\n                        data: tag.data\n                    });\n                }\n            }\n        }\n    }\n    return helper.succeed(resource);\n}\n","import { vsprintf } from \"sprintf-js\";\n\nexport function shouldTranslate(): boolean {\n    return mcLangSettings.translation.lang.toLowerCase() !== \"en-us\";\n}\n\nexport function MCFormat(base: string, ...substitutions: string[]): string {\n    return vsprintf(base, substitutions);\n}\n","import {\n    Diagnostic,\n    DidChangeTextDocumentParams,\n    Range\n} from \"vscode-languageserver/lib/main\";\nimport { CommandError } from \"../brigadier/errors\";\nimport { FunctionInfo } from \"../types\";\nimport { splitLines } from \"./creators\";\nimport { shouldTranslate } from \"./translation\";\n\n/**\n * Turn a command error into a language server diagnostic\n */\nexport function commandErrorToDiagnostic(\n    error: CommandError,\n    line: number\n): Diagnostic {\n    const range: Range = {\n        end: { line, character: error.range.end },\n        start: { line, character: error.range.start }\n    };\n    // Run Translation stuff on the error?\n    const text = shouldTranslate()\n        ? `'${error.text}': Translation is not yet supported` // Translate(error.code)\n        : error.text;\n    return Diagnostic.create(\n        range,\n        text,\n        error.severity,\n        error.code,\n        \"mcfunction\"\n    );\n}\n\nexport function runChanges(\n    changes: DidChangeTextDocumentParams,\n    functionInfo: FunctionInfo\n): number[] {\n    const changed: number[] = [];\n    for (const change of changes.contentChanges) {\n        if (!!change.range) {\n            // Appease the compiler, as the change interface seems to have range optional\n            const { start, end }: Range = change.range;\n            const newLineContent = functionInfo.lines[start.line].text\n                .substring(0, start.character)\n                .concat(\n                    change.text,\n                    functionInfo.lines[end.line].text.substring(end.character)\n                );\n            const difference = end.line - start.line + 1;\n            const newLines = splitLines(newLineContent);\n            functionInfo.lines.splice(start.line, difference, ...newLines);\n            changed.forEach((v, i) => {\n                if (v > start.line) {\n                    changed[i] = v - difference + newLines.length;\n                }\n            });\n            changed.push(\n                ...Array.from(\n                    new Array(newLines.length),\n                    (_, i) => start.line + i\n                )\n            );\n        }\n    }\n    const unique = changed.filter(\n        (value, index, self) => self.indexOf(value) === index\n    );\n    unique.sort((a, b) => a - b);\n    return unique;\n}\n","import {\n    CommandNode,\n    CommandNodePath,\n    CommandTree,\n    MCNode\n} from \"../data/types\";\n\nexport function followPath<T extends MCNode<T>>(\n    tree: MCNode<T>,\n    path: CommandNodePath\n): MCNode<T> {\n    // There are no protections here, because if a path is given it should be correct.\n    let current = tree;\n    for (const section of path) {\n        if (!!current.children && !!current.children[section]) {\n            current = current.children[section];\n        }\n    }\n    return current;\n}\n\nexport function getNextNode(\n    node:\n        | CommandNode\n        | MCNode<CommandNode> & {\n              executable?: boolean;\n              redirect?: CommandNodePath;\n          }, // Allow use of node.redirect without a tsignore\n    nodePath: CommandNodePath,\n    tree: CommandTree\n): GetNodeResult {\n    const redirect: CommandNodePath | undefined = node.redirect;\n    if (!!redirect) {\n        return { node: followPath(tree, redirect), path: redirect };\n    } else {\n        if (!node.children && !node.executable) {\n            // In this case either tree is malformed or in `execute run`\n            // So we just return the entire tree\n            return { node: tree, path: [] };\n        }\n        return { node, path: nodePath };\n    }\n}\n\ninterface GetNodeResult {\n    node: MCNode<CommandNode>;\n    path: CommandNodePath;\n}\n","import * as path from \"path\";\n\nimport {\n    mkdirAsync,\n    readJSONRaw,\n    saveFileAsync,\n    writeJSON\n} from \"../misc-functions/promisified-fs\";\nimport { typed_keys } from \"../misc-functions/third_party/typed-keys\";\nimport { WorkspaceSecurity } from \"../types\";\nimport { Cacheable } from \"./types\";\n\nif (!process.env.MCFUNCTION_CACHE_DIR) {\n    throw new Error(\"Environment variable MCFUNCTION_CACHE_DIR must be set\");\n}\nconst cacheFolder = process.env.MCFUNCTION_CACHE_DIR;\n\nconst cacheFileNames: { [K in keyof Cacheable]: string } = {\n    blocks: \"blocks.json\",\n    commands: \"commands.json\",\n    items: \"items.json\",\n    meta_info: \"meta_info.json\",\n    resources: \"resources.json\"\n};\n\nexport async function readCache(): Promise<Cacheable> {\n    const data: Cacheable = {} as Cacheable;\n    const keys = typed_keys(cacheFileNames);\n    await Promise.all(\n        keys.map(async key => {\n            data[key] = await readJSONRaw<Cacheable[typeof key]>(\n                path.join(cacheFolder, cacheFileNames[key])\n            );\n        })\n    );\n    return data;\n}\n\nexport async function cacheData(data: Cacheable): Promise<void> {\n    try {\n        await mkdirAsync(cacheFolder, \"777\");\n    } catch (_) {\n        // Don't use the error, which is normally thrown if the folder doesn't exist\n    }\n    const keys: Array<keyof typeof cacheFileNames> = typed_keys(cacheFileNames);\n    await Promise.all(\n        keys.map(async key =>\n            writeJSON(path.join(cacheFolder, cacheFileNames[key]), data[key])\n        )\n    );\n    return;\n}\n\nexport async function storeSecurity(\n    security: WorkspaceSecurity\n): Promise<void> {\n    await saveFileAsync(\n        path.join(cacheFolder, \"security.json\"),\n        JSON.stringify(security)\n    );\n}\n\nexport async function readSecurity(): Promise<WorkspaceSecurity> {\n    try {\n        return await readJSONRaw(path.join(cacheFolder, \"security.json\"));\n    } catch (error) {\n        return {};\n    }\n}\n","import { IConnection } from \"vscode-languageserver/lib/main\";\nimport { storeSecurity } from \"../data/cache\";\nimport { WorkspaceSecurity } from \"../types\";\n\n/**\n * Check if the given change requires security confirmation\n */\nexport function securityIssues(\n    settings: McFunctionSettings,\n    security: WorkspaceSecurity\n): Array<keyof WorkspaceSecurity> {\n    const results: Array<keyof WorkspaceSecurity> = [];\n    if (!!settings.data) {\n        if (!!settings.data.customJar && security.JarPath !== true) {\n            results.push(\"JarPath\");\n        }\n        if (!!settings.data.javaPath && security.JavaPath !== true) {\n            results.push(\"JavaPath\");\n        }\n    }\n    if (!!settings.parsers /* && security.CustomParsers !== true */) {\n        /* const names = Object.keys(settings.parsers);\n        if (names.length > 0) {\n            results.push(\"CustomParsers\");\n        } */\n        throw new Error(`Custom parsers are not supported for client implementations.\nTo request this feature be enabled, open an issue at https://github.com/Levertion/mcfunction-langserver`);\n    }\n    return results;\n}\n\nexport async function actOnSecurity(\n    issues: Array<keyof WorkspaceSecurity>,\n    connection: IConnection,\n    security: WorkspaceSecurity\n): Promise<boolean> {\n    let securityChanged = false;\n    const resave = async () => {\n        if (securityChanged) {\n            await storeSecurity(security);\n        }\n    };\n    for (const issue of issues) {\n        const response = await Promise.resolve(\n            connection.window.showErrorMessage(\n                `[MCFUNCTION] You have the potentially insecure setting '${issue}' set, but no confirmation has been recieved.`,\n                { title: \"Yes\" },\n                { title: \"No (Stops server)\" }\n            )\n        );\n        if (!!response && response.title === \"Yes\") {\n            security[issue] = true;\n            securityChanged = true;\n        } else {\n            return false;\n        }\n    }\n    await resave();\n    return true;\n}\n","import { IConnection } from \"vscode-languageserver/lib/main\";\n\nexport function setup_logging(connection: IConnection): void {\n    const log = (message: string) => {\n        connection.console.log(message);\n    };\n    // tslint:disable-next-line:prefer-object-spread\n    global.mcLangLog = Object.assign(log, {\n        internal: (m: string) => {\n            if (mcLangSettings.trace.internalLogging) {\n                log(`[McFunctionInternal] ${m}`);\n            }\n        }\n    });\n}\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\nimport {\n    convertToNamespace,\n    namespacesEqual,\n    ReturnHelper,\n    stringifyNamespace\n} from \"..\";\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { StringReader } from \"../../brigadier/string-reader\";\nimport { NamespacedName } from \"../../data/types\";\nimport { CE, ReturnedInfo, ReturnSuccess, Suggestion } from \"../../types\";\nimport { isNamespaceDefault, namesEqual } from \"../namespace\";\n\nconst NAMESPACEEXCEPTIONS = {\n    invalid_id: new CommandErrorBuilder(\n        \"argument.id.invalid\",\n        \"Invalid character '%s' in location %s\"\n    )\n};\n\nconst disallowedPath = /[^0-9a-z_/\\.-]/g;\n\nexport function stringArrayToNamespaces(strings: string[]): NamespacedName[] {\n    // tslint:disable-next-line:no-unnecessary-callback-wrapper this is a false positive - see https://github.com/palantir/tslint/issues/2430\n    return strings.map(v => convertToNamespace(v));\n}\n\nexport function readNamespaceText(reader: StringReader): string {\n    const namespaceChars = /^[0-9a-z_:/\\.-]$/;\n    return reader.readWhileRegexp(namespaceChars);\n}\n\n/**\n * Does `base`(eg minecraft:stone) start with `test` (e.g. sto) [Y]\n */\nexport function namespaceStart(\n    base: NamespacedName,\n    test: NamespacedName\n): boolean {\n    if (test.namespace === undefined) {\n        return (\n            (isNamespaceDefault(base) && base.path.startsWith(test.path)) ||\n            (!!base.namespace && base.namespace.startsWith(test.path))\n        );\n    } else {\n        return namesEqual(base, test) && base.path.startsWith(test.path);\n    }\n}\n\nexport function namespaceSuggestions(\n    options: NamespacedName[],\n    value: NamespacedName,\n    start: number\n): Suggestion[] {\n    const result: Suggestion[] = [];\n    for (const option of options) {\n        if (namespaceStart(option, value)) {\n            result.push({ text: stringifyNamespace(option), start });\n        }\n    }\n    return result;\n}\n\nexport function namespaceSuggestionString(\n    options: string[],\n    value: NamespacedName,\n    start: number\n): Suggestion[] {\n    return namespaceSuggestions(stringArrayToNamespaces(options), value, start);\n}\n\nexport function parseNamespace(\n    reader: StringReader\n): ReturnedInfo<NamespacedName> {\n    const helper = new ReturnHelper();\n    const start = reader.cursor;\n    const text = readNamespaceText(reader);\n    const namespace = convertToNamespace(text);\n    let next: RegExpExecArray | null;\n    let failed = false;\n    // Give an error for each invalid character\n    do {\n        next = disallowedPath.exec(namespace.path);\n        if (next) {\n            // Relies on the fact that convertToNamespace splits on the first\n            const i = text.indexOf(\":\") + 1 + next.index + start;\n            failed = true;\n            helper.addErrors(\n                NAMESPACEEXCEPTIONS.invalid_id.create(i, i + 1, next[0], text)\n            );\n        }\n    } while (next);\n    if (failed) {\n        return helper.fail();\n    } else {\n        return helper.succeed(namespace);\n    }\n}\n\ninterface OptionResult<T> {\n    literal: NamespacedName;\n    values: T[];\n}\n\nexport function parseNamespaceOption<T extends NamespacedName>(\n    reader: StringReader,\n    options: T[],\n    completionKind?: CompletionItemKind\n): ReturnedInfo<OptionResult<T>, CE, NamespacedName | undefined> {\n    const helper = new ReturnHelper();\n    const start = reader.cursor;\n    const namespace = parseNamespace(reader);\n    if (helper.merge(namespace)) {\n        const results = processParsedNamespaceOption(\n            namespace.data,\n            options,\n            !reader.canRead(),\n            start,\n            completionKind\n        );\n        helper.merge(results);\n        if (results.data.length > 0) {\n            return helper.succeed<OptionResult<T>>({\n                literal: namespace.data,\n                values: results.data\n            });\n        } else {\n            return helper.failWithData(namespace.data);\n        }\n    } else {\n        return helper.failWithData(undefined);\n    }\n}\n\nexport function processParsedNamespaceOption<T extends NamespacedName>(\n    namespace: NamespacedName,\n    options: T[],\n    suggest: boolean,\n    start: number,\n    completionKind?: CompletionItemKind\n): ReturnSuccess<T[]> {\n    const results: T[] = [];\n    const helper = new ReturnHelper();\n    for (const val of options) {\n        if (namespacesEqual(val, namespace)) {\n            results.push(val);\n        }\n        if (suggest && namespaceStart(val, namespace)) {\n            helper.addSuggestion(\n                start,\n                stringifyNamespace(val),\n                completionKind\n            );\n        }\n    }\n    return helper.succeed(results);\n}\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\nimport {\n    buildPath,\n    convertToNamespace,\n    getResourcesofType,\n    namespacesEqual,\n    ReturnHelper\n} from \"..\";\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { StringReader } from \"../../brigadier/string-reader\";\nimport { TAG_START } from \"../../consts\";\nimport {\n    DataResource,\n    NamespacedName,\n    Resources,\n    Tag,\n    WorldInfo\n} from \"../../data/types\";\nimport { CE, ParserInfo, ReturnedInfo, ReturnSuccess } from \"../../types\";\nimport {\n    parseNamespace,\n    parseNamespaceOption,\n    readNamespaceText\n} from \"./namespace\";\n\nexport interface TagParseResult {\n    parsed: NamespacedName;\n    resolved?: NamespacedName[];\n    values?: Array<DataResource<Tag>>;\n}\n\n/**\n * Parse a namespace or tag.\n * Returned:\n *  - values are the resources which are the exact matches\n *  - resolved are the lowest level tag members\n *  - parsed is the literal tag. If parsed exists, but not resolved/values, then it was a non-tag\n *  - if not successful, if data undefined then parsing failed.\n *  - if data is a value, then a tag parsed but was unknown\n */\nexport function parseNamespaceOrTag(\n    reader: StringReader,\n    info: ParserInfo,\n    taghandling: keyof Resources | CommandErrorBuilder\n): ReturnedInfo<TagParseResult, CE, NamespacedName | undefined> {\n    const helper = new ReturnHelper(info);\n    const start = reader.cursor;\n    if (reader.peek() === TAG_START) {\n        reader.skip();\n        if (typeof taghandling === \"string\") {\n            const tags: Array<DataResource<Tag>> = getResourcesofType(\n                info.data,\n                taghandling\n            );\n            const parsed = parseNamespaceOption(\n                reader,\n                tags,\n                CompletionItemKind.Folder\n            );\n            if (helper.merge(parsed)) {\n                const values = parsed.data.values;\n                const resolved: NamespacedName[] = [];\n                for (const value of values) {\n                    resolved.push(...getLowestForTag(value, tags));\n                }\n                return helper.succeed<TagParseResult>({\n                    parsed: parsed.data.literal,\n                    resolved,\n                    values\n                });\n            } else {\n                return helper.failWithData(parsed.data);\n            }\n        } else {\n            readNamespaceText(reader);\n            return helper.fail(taghandling.create(start, reader.cursor));\n        }\n    } else {\n        if (!reader.canRead() && typeof taghandling === \"string\") {\n            helper.addSuggestion(\n                reader.cursor,\n                TAG_START,\n                CompletionItemKind.Operator\n            );\n        }\n        const parsed = parseNamespace(reader);\n        if (helper.merge(parsed)) {\n            return helper.succeed({ parsed: parsed.data });\n        } else {\n            return helper.fail();\n        }\n    }\n}\n\nfunction getLowestForTag(\n    tag: DataResource<Tag>,\n    options: Array<DataResource<Tag>>\n): NamespacedName[] {\n    if (!tag.data) {\n        return [];\n    }\n    const results: NamespacedName[] = [];\n    for (const tagMember of tag.data.values) {\n        if (tagMember[0] === TAG_START) {\n            const namespace = convertToNamespace(tagMember.substring(1));\n            for (const option of options) {\n                if (namespacesEqual(namespace, option)) {\n                    results.push(...getLowestForTag(option, options));\n                }\n            }\n        } else {\n            results.push(convertToNamespace(tagMember));\n        }\n    }\n    return results;\n}\n\nexport function buildTagActions(\n    tags: Array<DataResource<Tag>>,\n    low: number,\n    high: number,\n    type: keyof Resources,\n    localData?: WorldInfo\n): ReturnSuccess<void> {\n    const helper = new ReturnHelper();\n    for (const resource of tags) {\n        if (resource.data) {\n            helper.addActions({\n                data: `\\`\\`\\`json\n${JSON.stringify(resource.data, undefined, 4)}\n\\`\\`\\``,\n                high,\n                low,\n                type: \"hover\"\n            });\n        }\n        if (localData) {\n            const location = buildPath(resource, localData, type);\n            if (location) {\n                helper.addActions({\n                    data: location,\n                    high,\n                    low,\n                    type: \"source\"\n                });\n            }\n        }\n    }\n    return helper.succeed();\n}\n","export * from \"./context\";\nexport * from \"./creators\";\nexport * from \"./datapack-folder\";\nexport * from \"./file-errors\";\nexport * from \"./group-resources\";\nexport * from \"./lsp-conversions\";\nexport * from \"./namespace\";\nexport * from \"./node-tree\";\nexport * from \"./promisified-fs\";\nexport * from \"./return-helper\";\nexport * from \"./security\";\nexport * from \"./setup\";\nexport * from \"./translation\";\n\nexport * from \"./parsing/namespace\";\nexport * from \"./parsing/nmsp-tag\";\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\nimport { ReturnHelper } from \"../misc-functions\";\nimport { typed_keys } from \"../misc-functions/third_party/typed-keys\";\nimport { CE, ReturnedInfo, Suggestion } from \"../types\";\nimport { CommandErrorBuilder } from \"./errors\";\n\nconst EXCEPTIONS = {\n    EXPECTED_BOOL: new CommandErrorBuilder(\n        \"parsing.bool.expected\",\n        \"Expected bool\"\n    ),\n    EXPECTED_END_OF_QUOTE: new CommandErrorBuilder(\n        \"parsing.quote.expected.end\",\n        \"Unclosed quoted string\"\n    ),\n    EXPECTED_FLOAT: new CommandErrorBuilder(\n        \"parsing.float.expected\",\n        \"Expected float\"\n    ),\n    EXPECTED_INT: new CommandErrorBuilder(\n        \"parsing.int.expected\",\n        \"Expected integer\"\n    ),\n    EXPECTED_START_OF_QUOTE: new CommandErrorBuilder(\n        \"parsing.quote.expected.start\",\n        \"Expected quote to start a string\"\n    ),\n    EXPECTED_STRING_FROM: new CommandErrorBuilder(\n        \"parsing.expected.option\",\n        \"Expected string from %s, got '%s'\"\n    ),\n    EXPECTED_SYMBOL: new CommandErrorBuilder(\n        \"parsing.expected\",\n        \"Expected '%s'\"\n    ),\n    INVALID_BOOL: new CommandErrorBuilder(\n        \"parsing.bool.invalid\",\n        \"Invalid bool, expected true or false but found '%s'\"\n    ),\n    INVALID_ESCAPE: new CommandErrorBuilder(\n        \"parsing.quote.escape\",\n        \"Invalid escape sequence '\\\\%s' in quoted string)\"\n    ),\n    INVALID_FLOAT: new CommandErrorBuilder(\n        \"parsing.float.invalid\",\n        \"Invalid float '%s'\"\n    ),\n    INVALID_INT: new CommandErrorBuilder(\n        \"parsing.int.invalid\",\n        \"Invalid integer '%s'\"\n    )\n};\n\nconst QUOTE = '\"';\nconst ESCAPE = \"\\\\\";\n\nexport class StringReader {\n    public static charAllowedInUnquotedString = /^[0-9A-Za-z_\\-\\.+]$/;\n    public static charAllowedNumber = /^[0-9\\-\\.]$/;\n    private static readonly bools = { true: true, false: false };\n    public cursor = 0;\n    public readonly string: string;\n\n    public constructor(stringToRead: string) {\n        this.string = stringToRead;\n    }\n    public canRead(length: number = 1): boolean {\n        return this.cursor + length <= this.string.length;\n    }\n    /**\n     * Require that a specific string follows\n     * @param str The string which should come next\n     */\n    public expect(str: string): ReturnedInfo<undefined> {\n        const helper = new ReturnHelper();\n        if (str.startsWith(this.getRemaining())) {\n            helper.addSuggestions({ text: str, start: this.cursor });\n        }\n        const sub = this.string.substr(this.cursor, str.length);\n        if (sub !== str) {\n            return helper.fail(\n                EXCEPTIONS.EXPECTED_SYMBOL.create(\n                    this.cursor,\n                    Math.min(this.string.length, this.cursor + str.length),\n                    sub,\n                    str\n                )\n            );\n        }\n        this.cursor += str.length;\n        return helper.succeed();\n    }\n    public getRead(): string {\n        return this.string.substring(0, this.cursor);\n    }\n    public getRemaining(): string {\n        return this.string.substring(this.cursor);\n    }\n    public getRemainingLength(): number {\n        return this.string.length - this.cursor;\n    }\n    public getTotalLength(): number {\n        return this.string.length;\n    }\n    public peek(offset: number = 0): string {\n        return this.string.charAt(this.cursor + offset);\n    }\n    public read(): string {\n        return this.string.charAt(this.cursor++);\n    }\n    /**\n     * Read a boolean value from the string\n     */\n    public readBoolean(): ReturnedInfo<boolean> {\n        const helper = new ReturnHelper();\n        const start = this.cursor;\n        const value = this.readOption<keyof typeof StringReader[\"bools\"]>(\n            typed_keys(StringReader.bools),\n            false\n        );\n        if (!helper.merge(value)) {\n            if (value.data !== false) {\n                return helper.fail(\n                    EXCEPTIONS.INVALID_BOOL.create(\n                        start,\n                        this.cursor,\n                        value.data\n                    )\n                );\n            } else {\n                return helper.fail();\n            }\n        }\n        return helper.succeed(StringReader.bools[value.data]);\n    }\n    /**\n     * Read a float from the string\n     */\n    public readFloat(): ReturnedInfo<number> {\n        const helper = new ReturnHelper();\n        const start: number = this.cursor;\n        const readToTest: string = this.readWhileRegexp(\n            StringReader.charAllowedNumber\n        );\n        if (readToTest.length === 0) {\n            return helper.fail(\n                EXCEPTIONS.EXPECTED_FLOAT.create(start, this.string.length)\n            );\n        }\n\n        // The Java readInt throws upon multiple `.`s, but Javascript's doesn't\n\n        if ((readToTest.match(/\\./g) || []).length > 1) {\n            return helper.fail(\n                EXCEPTIONS.INVALID_FLOAT.create(\n                    start,\n                    this.cursor,\n                    this.string.substring(start, this.cursor)\n                )\n            );\n        }\n        try {\n            return helper.succeed(parseFloat(readToTest));\n        } catch (error) {\n            return helper.fail(\n                EXCEPTIONS.INVALID_FLOAT.create(start, this.cursor, readToTest)\n            );\n        }\n    }\n    /**\n     * Read an integer from the string\n     */\n    public readInt(): ReturnedInfo<number> {\n        const helper = new ReturnHelper();\n        const start: number = this.cursor;\n        const readToTest: string = this.readWhileRegexp(\n            StringReader.charAllowedNumber\n        );\n        if (readToTest.length === 0) {\n            return helper.fail(\n                EXCEPTIONS.EXPECTED_INT.create(start, this.string.length)\n            );\n        }\n        // The Java readInt throws upon a `.`, but the regex includes one in brigadier\n        // This handles this case\n        if (readToTest.indexOf(\".\") !== -1) {\n            return helper.fail(\n                EXCEPTIONS.INVALID_INT.create(\n                    start,\n                    this.cursor,\n                    this.string.substring(start, this.cursor)\n                )\n            );\n        }\n        try {\n            return helper.succeed(Number.parseInt(readToTest, 10));\n        } catch (error) {\n            return helper.fail(\n                EXCEPTIONS.INVALID_INT.create(start, this.cursor, readToTest)\n            );\n        }\n    }\n    /**\n     * Expect a string from a selection\n     */\n    public readOption<T extends string>(\n        options: T[],\n        addError: boolean = true,\n        completion?: CompletionItemKind,\n        quoted: \"both\" | RegExp | \"yes\" = \"both\"\n    ): ReturnedInfo<T, CE, string | false> {\n        const start = this.cursor;\n        const helper = new ReturnHelper();\n        const isquoted =\n            this.peek() === QUOTE && (quoted === \"yes\" || quoted === \"both\");\n        let resultaux: ReturnedInfo<string>;\n        switch (quoted) {\n            case \"both\":\n                resultaux = this.readString();\n                break;\n            case \"yes\":\n                resultaux = this.readQuotedString();\n                break;\n            default:\n                resultaux = new ReturnHelper().succeed(\n                    this.readWhileRegexp(quoted)\n                );\n        }\n        const result = resultaux;\n        if (!helper.merge(result, false)) {\n            if (isquoted && !this.canRead()) {\n                const remaining = this.string.substring(start + 1);\n                // Note that if there are quotes and backslashes, this will fail\n                helper.addSuggestions(\n                    ...options\n                        .filter(v => v.startsWith(remaining))\n                        .map<Suggestion>(v => ({\n                            kind: completion,\n                            start,\n                            text: `${QUOTE}${v}${QUOTE}`\n                        }))\n                );\n            }\n            return helper.failWithData(false as any);\n        }\n        let valid: T | undefined;\n        for (const option of options) {\n            if (option === result.data) {\n                valid = option;\n            }\n        }\n        if (!this.canRead()) {\n            helper.addSuggestions(\n                ...options\n                    .filter(v => v.startsWith(result.data))\n                    .map<Suggestion>(v => ({\n                        kind: completion,\n                        start,\n                        text:\n                            isquoted || v.includes('\"') || v.includes(\"\\\\\")\n                                ? QUOTE +\n                                  v.replace(\"\\\\\", \"\\\\\\\\\").replace('\"', '\\\\\"') +\n                                  QUOTE\n                                : v\n                    }))\n            );\n        }\n        if (valid) {\n            return helper.succeed(valid);\n        } else {\n            if (addError) {\n                helper.addErrors(\n                    EXCEPTIONS.EXPECTED_STRING_FROM.create(\n                        start,\n                        this.cursor,\n                        JSON.stringify(options),\n                        result.data\n                    )\n                );\n            }\n            return helper.failWithData(result.data);\n        }\n    }\n    /**\n     * Read from the string, returning a string, which, in the original had been surrounded by quotes\n     */\n    public readQuotedString(): ReturnedInfo<string> {\n        const helper = new ReturnHelper();\n        const start = this.cursor;\n        if (!this.canRead()) {\n            return helper.succeed(\"\");\n        }\n        if (this.peek() !== QUOTE) {\n            return helper.fail(\n                EXCEPTIONS.EXPECTED_START_OF_QUOTE.create(\n                    this.cursor,\n                    this.string.length\n                )\n            );\n        }\n        let result = \"\";\n        let escaped = false;\n        while (this.canRead()) {\n            this.skip();\n            const c: string = this.peek();\n            if (escaped) {\n                if (c === QUOTE || c === ESCAPE) {\n                    result += c;\n                    escaped = false;\n                } else {\n                    return helper.fail(\n                        EXCEPTIONS.INVALID_ESCAPE.create(\n                            this.cursor - 1,\n                            this.cursor + 1,\n                            c\n                        )\n                    ); // Includes backslash\n                }\n            } else if (c === ESCAPE) {\n                escaped = true;\n            } else if (c === QUOTE) {\n                this.skip();\n                return helper.succeed(result);\n            } else {\n                result += c;\n            }\n        }\n        helper.addSuggestion(this.cursor, QUOTE); // Always cannot read at this point\n        return helper.fail(\n            EXCEPTIONS.EXPECTED_END_OF_QUOTE.create(start, this.string.length)\n        );\n    }\n    /**\n     * Read a string from the string. If it surrounded by quotes, the quotes are ignored.\n     * The cursor ends on the last character in the string.\n     */\n    public readString(): ReturnedInfo<string> {\n        if (this.canRead() && this.peek() === QUOTE) {\n            return this.readQuotedString();\n        } else {\n            const helper = new ReturnHelper();\n            if (!this.canRead()) {\n                helper.addSuggestions({\n                    start: this.cursor,\n                    text: QUOTE\n                });\n            }\n            return helper.succeed(this.readUnquotedString());\n        }\n    }\n\n    /**\n     * Read a string which is not surrounded by quotes.\n     * Can only contain alphanumerical characters, _,+,. and -\n     */\n    public readUnquotedString(): string {\n        return this.readWhileRegexp(StringReader.charAllowedInUnquotedString);\n    }\n\n    /**\n     * Read the string until a certain regular expression matches the\n     * character under the cursor.\n     * @param exp The Regular expression to test against.\n     */\n    public readUntilRegexp(exp: RegExp): string {\n        return this.readWhileFunction(s => !exp.test(s));\n    }\n    /**\n     * Read while a certain function returns true on each consecutive character starting with the one under the cursor.\n     * In most cases, it is better to use readWhileRegexp.\n     * @param callback The function to use.\n     */\n    public readWhileFunction(callback: (char: string) => boolean): string {\n        const begin = this.cursor;\n        while (callback(this.peek())) {\n            if (this.canRead()) {\n                this.skip();\n            } else {\n                return this.string.substring(begin);\n            }\n        }\n        return this.string.substring(begin, this.cursor);\n    }\n    /**\n     * Read the string while a certain regular expression matches the character under the cursor.\n     * The cursor ends on the first character which doesn't match\n     * @param exp The Regular Expression to test against\n     */\n    public readWhileRegexp(exp: RegExp): string {\n        return this.readWhileFunction(s => exp.test(s));\n    }\n\n    public skip(): void {\n        this.cursor++;\n    }\n    public skipWhitespace(): void {\n        this.readWhileRegexp(/\\s/); // Whitespace\n    }\n}\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\nimport { prepareForParser } from \"../../misc-functions\";\nimport { Parser } from \"../../types\";\n\nexport const boolParser: Parser = {\n    kind: CompletionItemKind.Keyword,\n    parse: (reader, props) => prepareForParser(reader.readBoolean(), props)\n};\n","import { ReturnHelper } from \"../../misc-functions\";\nimport { Parser } from \"../../types\";\n\nexport const stringParser: Parser = {\n    parse: (reader, properties) => {\n        const helper = new ReturnHelper(properties);\n        switch (properties.node_properties.type) {\n            case \"greedy\":\n                reader.cursor = reader.string.length;\n                return helper.succeed();\n            case \"word\":\n                reader.readUnquotedString();\n                return helper.succeed();\n            default:\n                if (helper.merge(reader.readString())) {\n                    return helper.succeed();\n                } else {\n                    return helper.fail();\n                }\n        }\n    }\n};\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { ReturnHelper } from \"../../misc-functions\";\nimport { Parser } from \"../../types\";\n\nconst JAVAMAXINT = 2147483647;\nconst JAVAMININT = -2147483648;\n\nconst INTEGEREXCEPTIONS = {\n    TOOBIG: new CommandErrorBuilder(\n        \"argument.integer.big\",\n        \"Integer must not be more than %s, found %s\"\n    ),\n    TOOSMALL: new CommandErrorBuilder(\n        \"argument.integer.low\",\n        \"Integer must not be less than %s, found %s\"\n    )\n};\n\nexport const intParser: Parser = {\n    parse: (reader, properties) => {\n        const helper = new ReturnHelper(properties);\n        const start = reader.cursor;\n        const result = reader.readInt();\n        if (!helper.merge(result)) {\n            return helper.fail();\n        }\n        const maxVal = properties.node_properties.max;\n        const minVal = properties.node_properties.min;\n        // See https://stackoverflow.com/a/12957445\n        const max = Math.min(\n            typeof maxVal === \"number\" ? maxVal : JAVAMAXINT,\n            JAVAMAXINT\n        );\n        const min = Math.max(\n            typeof minVal === \"number\" ? minVal : JAVAMININT,\n            JAVAMININT\n        );\n        if (result.data > max) {\n            helper.addErrors(\n                INTEGEREXCEPTIONS.TOOBIG.create(\n                    start,\n                    reader.cursor,\n                    max.toString(),\n                    result.data.toString()\n                )\n            );\n        }\n        if (result.data < min) {\n            helper.addErrors(\n                INTEGEREXCEPTIONS.TOOSMALL.create(\n                    start,\n                    reader.cursor,\n                    min.toString(),\n                    result.data.toString()\n                )\n            );\n        }\n        return helper.succeed();\n    }\n};\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { ReturnHelper } from \"../../misc-functions\";\nimport { Parser } from \"../../types\";\n\nconst JAVAMINFLOAT = -2139095039;\nconst JAVAMAXFLOAT = 2139095039;\n\nconst FLOATEXCEPTIONS = {\n    TOOBIG: new CommandErrorBuilder(\n        \"argument.float.big\",\n        \"Float must not be more than %s, found %s\"\n    ),\n    TOOSMALL: new CommandErrorBuilder(\n        \"argument.float.low\",\n        \"Float must not be less than %s, found %s\"\n    )\n};\n\nexport const floatParser: Parser = {\n    parse: (reader, properties) => {\n        const helper = new ReturnHelper(properties);\n        const start = reader.cursor;\n        const result = reader.readFloat();\n        if (!helper.merge(result)) {\n            return helper.fail();\n        }\n        const maxVal = properties.node_properties.max;\n        const minVal = properties.node_properties.min;\n        // See https://stackoverflow.com/a/12957445\n        const max = Math.min(\n            typeof maxVal === \"number\" ? maxVal : JAVAMAXFLOAT,\n            JAVAMAXFLOAT\n        );\n        const min = Math.max(\n            typeof minVal === \"number\" ? minVal : JAVAMINFLOAT,\n            JAVAMINFLOAT\n        );\n        if (result.data > max) {\n            helper.addErrors(\n                FLOATEXCEPTIONS.TOOBIG.create(\n                    start,\n                    reader.cursor,\n                    max.toString(),\n                    result.data.toString()\n                )\n            );\n        }\n        if (result.data < min) {\n            helper.addErrors(\n                FLOATEXCEPTIONS.TOOSMALL.create(\n                    start,\n                    reader.cursor,\n                    min.toString(),\n                    result.data.toString()\n                )\n            );\n        }\n        return helper.succeed();\n    }\n};\n","export * from \"./bool\";\nexport * from \"./string\";\nexport * from \"./integer\";\nexport * from \"./float\";\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\nimport { ReturnHelper } from \"../misc-functions\";\nimport { Parser } from \"../types\";\n\nexport const literalParser: Parser = {\n    kind: CompletionItemKind.Method,\n    parse: (reader, properties) => {\n        const helper = new ReturnHelper(properties);\n        const begin = reader.cursor;\n        const literal = properties.path[properties.path.length - 1];\n        if (\n            properties.suggesting &&\n            literal.startsWith(reader.getRemaining())\n        ) {\n            helper.addSuggestions(literal);\n        }\n        if (reader.canRead(literal.length)) {\n            const end = begin + literal.length;\n            if (reader.string.substring(begin, end) === literal) {\n                reader.cursor = end;\n                if (reader.peek() === \" \" || !reader.canRead()) {\n                    return helper.succeed();\n                }\n            }\n        }\n        return helper.fail();\n    }\n};\n","import {\n    CompletionItemKind,\n    DiagnosticSeverity\n} from \"vscode-languageserver/lib/main\";\n\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { StringReader } from \"../../brigadier/string-reader\";\nimport {\n    BlocksPropertyInfo,\n    NamespacedName,\n    SingleBlockPropertyInfo\n} from \"../../data/types\";\nimport {\n    namespaceSuggestionString,\n    ReturnHelper,\n    stringifyNamespace\n} from \"../../misc-functions\";\nimport {\n    buildTagActions,\n    parseNamespaceOrTag\n} from \"../../misc-functions/parsing/nmsp-tag\";\nimport { Parser, ParserInfo, ReturnedInfo, Suggestion } from \"../../types\";\n\nexport const predicateParser: Parser = {\n    parse: (reader, info) => parseBlockArgument(reader, info, true)\n};\n\nexport const stateParser: Parser = {\n    parse: (reader, info) => parseBlockArgument(reader, info, false)\n};\n\ninterface PropertyExceptions {\n    duplicate: CommandErrorBuilder;\n    invalid: CommandErrorBuilder;\n    novalue: CommandErrorBuilder;\n    unknown: CommandErrorBuilder;\n}\n\nconst exceptions = {\n    block_properties: {\n        duplicate: new CommandErrorBuilder(\n            \"argument.block.property.duplicate\",\n            \"Property '%s' can only be set once for block %s\"\n        ),\n        invalid: new CommandErrorBuilder(\n            \"argument.block.property.invalid\",\n            \"Block %s does not accept '%s' for %s property\"\n        ),\n        novalue: new CommandErrorBuilder(\n            \"argument.block.property.novalue\",\n            \"Expected value for property '%s' on block %s\"\n        ),\n        unknown: new CommandErrorBuilder(\n            \"argument.block.property.unknown\",\n            \"Block %s does not have property '%s'\"\n        )\n    },\n    invalid_block: new CommandErrorBuilder(\n        \"argument.block.id.invalid\",\n        \"Unknown block type '%s'\"\n    ),\n    no_tags: new CommandErrorBuilder(\n        \"argument.block.tag.disallowed\",\n        \"Tags aren't allowed here, only actual blocks\"\n    ),\n    tag_properties: {\n        duplicate: new CommandErrorBuilder(\n            \"argument.block_tag.property.duplicate\",\n            \"Property '%s' can only be set once for block tag %s\"\n        ),\n        invalid: new CommandErrorBuilder(\n            \"argument.block_tag.property.invalid\",\n            \"Block tag %s does not accept '%s' for %s property\"\n        ),\n        novalue: new CommandErrorBuilder(\n            \"argument.block_tag.property.novalue\",\n            \"Expected value for property '%s' on block tag %s\"\n        ),\n        unknown: new CommandErrorBuilder(\n            \"argument.block_tag.property.unknown\",\n            \"Block tag %s does not have property '%s'\"\n        )\n    },\n    unknown_properties: {\n        duplicate: new CommandErrorBuilder(\n            \"argument.unknown_block_tag.property.duplicate\",\n            \"Property '%s' can only be set once for unknown block tag %s\"\n        ),\n        invalid: new CommandErrorBuilder(\n            \"argument.unknown_block_tag.property.invalid\",\n            \"Unknown block tag %s might not accept '%s' for %s property\",\n            DiagnosticSeverity.Warning\n        ),\n        novalue: new CommandErrorBuilder(\n            \"argument.unknown_block_tag.property.novalue\",\n            \"Expected value for property '%s' on unknown block tag %s\"\n        ),\n        unknown: new CommandErrorBuilder(\n            \"argument.unknown_block_tag.property.unknown\",\n            \"Unknown block tag %s might not have property '%s'\",\n            DiagnosticSeverity.Warning\n        )\n    },\n\n    unclosed_props: new CommandErrorBuilder(\n        \"argument.block.property.unclosed\",\n        \"Expected closing ] for block state properties\"\n    ),\n\n    unknown_tag: new CommandErrorBuilder(\n        \"arguments.block.tag.unknown\", // Argument_s_ [sic]\n        \"Unknown block tag '%s'\"\n    )\n};\n\nexport function parseBlockArgument(\n    reader: StringReader,\n    info: ParserInfo,\n    tags: boolean\n): ReturnedInfo<undefined> {\n    const helper = new ReturnHelper(info);\n    const start = reader.cursor;\n    const tagHandling = tags ? \"block_tags\" : exceptions.no_tags;\n    const parsed = parseNamespaceOrTag(reader, info, tagHandling);\n    let stringifiedName: string | undefined;\n    if (helper.merge(parsed)) {\n        const parsedResult = parsed.data;\n        if (parsedResult.resolved && parsedResult.values) {\n            stringifiedName = `#${stringifyNamespace(parsedResult.parsed)}`;\n            helper.merge(\n                buildTagActions(\n                    parsedResult.values,\n                    start + 1,\n                    reader.cursor,\n                    \"block_tags\",\n                    info.data.localData\n                )\n            );\n            const props = constructProperties(\n                parsedResult.resolved,\n                info.data.globalData.blocks\n            );\n            const propsResult = parseProperties(\n                reader,\n                props || {},\n                exceptions.tag_properties,\n                stringifiedName\n            );\n            if (!helper.merge(propsResult)) {\n                return helper.fail();\n            }\n        } else {\n            stringifiedName = stringifyNamespace(parsed.data.parsed);\n            if (info.suggesting && !reader.canRead()) {\n                helper.addSuggestions(\n                    ...namespaceSuggestionString(\n                        Object.keys(info.data.globalData.blocks),\n                        parsed.data.parsed,\n                        start\n                    )\n                );\n            }\n            const props = info.data.globalData.blocks[stringifiedName];\n            if (!props) {\n                helper.addErrors(\n                    exceptions.invalid_block.create(start, reader.cursor)\n                );\n            }\n            const result = parseProperties(\n                reader,\n                props || {},\n                exceptions.block_properties,\n                stringifiedName\n            );\n            if (!helper.merge(result)) {\n                return helper.fail();\n            }\n        }\n    } else {\n        if (parsed.data) {\n            helper.addErrors(\n                exceptions.unknown_tag.create(\n                    start,\n                    reader.cursor,\n                    stringifyNamespace(parsed.data)\n                )\n            );\n            stringifiedName = `#${stringifyNamespace(parsed.data)}`;\n            const propsResult = parseProperties(\n                reader,\n                {},\n                exceptions.unknown_properties,\n                stringifiedName\n            );\n            if (!helper.merge(propsResult)) {\n                return helper.fail();\n            }\n        } else {\n            // Parsing of the namespace failed\n            return helper.fail();\n        }\n    }\n    return helper.succeed();\n}\n\n// Ugly call signature. Need to see how upstream handles tag properties.\n// At the moment, it is very broken\nfunction parseProperties(\n    reader: StringReader,\n    options: SingleBlockPropertyInfo,\n    errors: PropertyExceptions,\n    name: string\n): ReturnedInfo<Map<string, string>> {\n    const helper = new ReturnHelper();\n    const result = new Map<string, string>();\n    if (reader.peek() === \"[\") {\n        const start = reader.cursor;\n        reader.skip();\n        const props = Object.keys(options);\n        reader.skipWhitespace();\n        while (reader.canRead() && reader.peek() !== \"]\") {\n            reader.skipWhitespace();\n            const propStart = reader.cursor;\n            const propParse = reader.readOption(\n                props,\n                false,\n                CompletionItemKind.Property\n            );\n            const propKey = propParse.data;\n            const propSuccessful = helper.merge(propParse);\n            if (propKey === false) {\n                // Strange order allows better type checker reasoning\n                // Parsing failed\n                return helper.fail();\n            }\n            if (!propSuccessful) {\n                helper.addErrors(\n                    errors.unknown.create(\n                        propStart,\n                        reader.cursor,\n                        name,\n                        propKey\n                    )\n                );\n            }\n            if (result.has(propKey)) {\n                helper.addErrors(\n                    errors.duplicate.create(\n                        propStart,\n                        reader.cursor,\n                        propKey,\n                        name\n                    )\n                );\n            }\n            reader.skipWhitespace();\n            if (!reader.canRead() || reader.peek() !== \"=\") {\n                return helper.fail(\n                    errors.novalue.create(\n                        propStart,\n                        reader.cursor,\n                        propKey,\n                        name\n                    )\n                );\n            }\n            reader.skip();\n            reader.skipWhitespace();\n            const valueStart = reader.cursor;\n            const valueParse = reader.readOption(\n                options[propKey] || [],\n                false,\n                CompletionItemKind.EnumMember\n            );\n            const valueSuccessful = helper.merge(valueParse);\n            const value = valueParse.data;\n            if (value === false) {\n                return helper.fail();\n            }\n            const error = errors.invalid.create(\n                valueStart,\n                reader.cursor,\n                name,\n                value,\n                propKey\n            );\n            const adderrorIf = (b: boolean) =>\n                b && propSuccessful && !valueSuccessful\n                    ? helper.addErrors(error)\n                    : undefined;\n            adderrorIf(value.length > 0);\n            result.set(propKey, value);\n            reader.skipWhitespace();\n            if (reader.canRead()) {\n                if (reader.peek() === \",\") {\n                    adderrorIf(value.length === 0);\n                    reader.skip();\n                    continue;\n                }\n                if (reader.peek() === \"]\") {\n                    adderrorIf(value.length === 0);\n                    break;\n                }\n            }\n            return helper.fail(\n                exceptions.unclosed_props.create(start, reader.cursor)\n            );\n        }\n        if (!reader.canRead()) {\n            helper.addSuggestions(\n                ...props.map<Suggestion>(prop => ({\n                    kind: CompletionItemKind.Property,\n                    start: reader.cursor,\n                    text: prop\n                }))\n            );\n            return helper.fail(\n                exceptions.unclosed_props.create(start, reader.cursor)\n            );\n        }\n        reader.expect(\"]\"); // Sanity check\n    }\n    return helper.succeed(result);\n}\n\nfunction constructProperties(\n    options: NamespacedName[],\n    blocks: BlocksPropertyInfo\n): SingleBlockPropertyInfo {\n    const result: SingleBlockPropertyInfo = {};\n    for (const blockName of options) {\n        const stringified = stringifyNamespace(blockName);\n        const block = blocks[stringified];\n        if (block) {\n            for (const prop in block) {\n                if (block.hasOwnProperty(prop)) {\n                    result[prop] = Array.from(\n                        new Set((result[prop] || []).concat(block[prop]))\n                    );\n                }\n            }\n        }\n    }\n    return result;\n}\n","import { TextDocument } from \"vscode-json-languageservice\";\nimport { DiagnosticSeverity } from \"vscode-languageserver\";\nimport { CommandError } from \"../../brigadier/errors\";\nimport { ReturnHelper } from \"../../misc-functions\";\nimport { Parser } from \"../../types\";\n\nexport const jsonParser: Parser = {\n    parse: (reader, info) => {\n        const helper = new ReturnHelper();\n        const remaining = reader.getRemaining();\n        const start = reader.cursor;\n        reader.cursor = reader.string.length;\n        const text: TextDocument = {\n            getText: () => remaining,\n            languageId: \"json\",\n            lineCount: 1,\n            offsetAt: pos => pos.character,\n            positionAt: offset => ({ line: 0, character: offset }),\n            uri: \"file://text-component.json\",\n            version: 0\n        };\n        const service = info.data.globalData.jsonService;\n        const json = service.parseJSONDocument(text);\n        service.doValidation(text, json).then(diagnostics => {\n            /* Because we use SynchronousPromise this is called before the next statement runs*/\n            helper.addErrors(\n                ...diagnostics.map<CommandError>(diag => ({\n                    code: typeof diag.code === \"string\" ? diag.code : \"json\",\n                    range: {\n                        end: start + diag.range.end.character,\n                        start: start + diag.range.start.character\n                    },\n                    severity: diag.severity || DiagnosticSeverity.Error,\n                    text: diag.message\n                }))\n            );\n        });\n        service\n            .doComplete(text, { line: 0, character: remaining.length }, json)\n            .then(completionList => {\n                if (completionList) {\n                    completionList.items.forEach(item => {\n                        if (item.textEdit) {\n                            helper.addSuggestions({\n                                description: item.documentation,\n                                insertTextFormat: item.insertTextFormat,\n                                kind: item.kind,\n                                label: item.label,\n                                start:\n                                    start + item.textEdit.range.start.character,\n                                text: item.textEdit.newText.replace(\n                                    /\\s*\\n\\s*/g,\n                                    \"\"\n                                )\n                            });\n                        } else {\n                            helper.addSuggestions({\n                                description: item.documentation,\n                                insertTextFormat: item.insertTextFormat,\n                                kind: item.kind,\n                                label: item.label,\n                                start: reader.cursor,\n                                text: item.label.replace(/\\s*\\n\\s*/g, \"\")\n                            });\n                        }\n                    });\n                }\n            });\n        helper.addActions({\n            data: {\n                json,\n                text\n            },\n            high: reader.cursor,\n            low: start,\n            type: \"json\"\n        });\n        return helper.succeed();\n    }\n};\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { StringReader } from \"../../brigadier/string-reader\";\nimport { ReturnHelper } from \"../../misc-functions\";\nimport { Parser, ParserInfo, ReturnedInfo } from \"../../types\";\n\nconst MIXED = new CommandErrorBuilder(\n    \"argument.pos.mixed\",\n    \"Cannot mix world & local coordinates (everything must either use ^ or not)\"\n);\n\nconst INCOMPLETE = new CommandErrorBuilder(\n    \"argument.pos.incomplete\",\n    \"Incomplete position argument. Only %s coords are present, when %s should be\"\n);\n\nconst NO_LOCAL = new CommandErrorBuilder(\n    \"argument.pos.nolocal\",\n    \"Local coords are not allowed\"\n);\n\nconst LOCAL = \"^\";\nconst RELATIVE = \"~\";\n\nexport interface CoordRules {\n    count: 2 | 3;\n    float: boolean;\n    local: boolean;\n}\n\nconst fail = (\n    reader: StringReader,\n    helper: ReturnHelper,\n    count: number,\n    hasWorld: boolean,\n    hasLocal: boolean,\n    start: number,\n    i: number\n) => {\n    if (!hasWorld) {\n        helper.addSuggestions({\n            start: reader.cursor,\n            text: LOCAL\n        });\n    }\n    if (!hasLocal) {\n        helper.addSuggestions({\n            start: reader.cursor,\n            text: RELATIVE\n        });\n    }\n    return helper.fail(\n        INCOMPLETE.create(\n            start,\n            reader.cursor,\n            (i + 1).toString(),\n            count.toString()\n        )\n    );\n};\n\nexport class CoordParser implements Parser {\n    private readonly rules: CoordRules;\n\n    public constructor(rules: CoordRules) {\n        this.rules = rules;\n    }\n\n    public parse(\n        reader: StringReader,\n        info: ParserInfo\n    ): ReturnedInfo<undefined> {\n        const helper = new ReturnHelper(info);\n        let hasLocal = false;\n        let hasWorld = false;\n        const start = reader.cursor;\n        for (let i = 0; i < this.rules.count; i++) {\n            if (!reader.canRead()) {\n                return fail(\n                    reader,\n                    helper,\n                    this.rules.count,\n                    hasWorld,\n                    hasLocal,\n                    start,\n                    0\n                );\n            }\n\n            const cstart = reader.cursor;\n            switch (reader.peek()) {\n                case RELATIVE:\n                    hasWorld = true;\n                    reader.skip();\n                    if (!helper.merge(this.parseNumber(reader))) {\n                        return helper.fail();\n                    }\n                    if (hasLocal) {\n                        helper.addErrors(MIXED.create(cstart, reader.cursor));\n                    }\n                    break;\n                case LOCAL:\n                    if (!this.rules.local) {\n                        helper.addErrors(\n                            NO_LOCAL.create(reader.cursor, reader.cursor + 1)\n                        );\n                    }\n                    hasLocal = true;\n                    reader.skip();\n                    if (!helper.merge(this.parseNumber(reader))) {\n                        return helper.fail();\n                    }\n                    if (hasWorld) {\n                        helper.addErrors(MIXED.create(cstart, reader.cursor));\n                    }\n                    break;\n                default:\n                    hasWorld = true;\n                    if (!helper.merge(this.parseNumber(reader, false))) {\n                        return helper.fail();\n                    }\n                    if (hasLocal) {\n                        helper.addErrors(MIXED.create(cstart, reader.cursor));\n                    }\n            }\n\n            if (\n                i < this.rules.count - 1 &&\n                (!reader.canRead() || !helper.merge(reader.expect(\" \")))\n            ) {\n                return fail(\n                    reader,\n                    helper,\n                    this.rules.count,\n                    hasWorld,\n                    hasLocal,\n                    start,\n                    i\n                );\n            }\n        }\n        return helper.succeed();\n    }\n\n    private parseNumber(\n        reader: StringReader,\n        allowBlank: boolean = true\n    ): ReturnedInfo<number> {\n        if ((!reader.canRead() || reader.peek().match(/\\s/)) && allowBlank) {\n            return new ReturnHelper().succeed(0);\n        }\n        return this.rules.float ? reader.readFloat() : reader.readInt();\n    }\n}\n\nexport const rotation = new CoordParser({\n    count: 2,\n    float: true,\n    local: false\n});\n\nexport const vec2 = new CoordParser({\n    count: 2,\n    float: true,\n    local: true\n});\n\nexport const vec3 = new CoordParser({\n    count: 3,\n    float: true,\n    local: true\n});\n\nexport const blockPos = new CoordParser({\n    count: 3,\n    float: false,\n    local: true\n});\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { StringReader } from \"../../brigadier/string-reader\";\nimport {\n    buildTagActions,\n    namespaceSuggestionString,\n    parseNamespaceOrTag,\n    ReturnHelper,\n    stringifyNamespace\n} from \"../../misc-functions\";\nimport { Parser, ParserInfo, ReturnedInfo } from \"../../types\";\n\nconst NOTAG = new CommandErrorBuilder(\n    \"argument.item.tag.disallowed\",\n    \"Tags aren't allowed here, only actual items\"\n);\n\nconst UNKNOWNTAG = new CommandErrorBuilder(\n    \"arguments.item.tag.unknown\",\n    \"Unknown item tag '%s'\"\n);\n\nconst UNKNOWNITEM = new CommandErrorBuilder(\n    \"argument.item.id.invalid\",\n    \"Unknown item '%s'\"\n);\n\nexport class ItemParser implements Parser {\n    private readonly useTags: boolean;\n\n    public constructor(useTags: boolean) {\n        this.useTags = useTags;\n    }\n\n    public parse(\n        reader: StringReader,\n        properties: ParserInfo\n    ): ReturnedInfo<undefined> {\n        const helper = new ReturnHelper(properties);\n        const start = reader.cursor;\n        const parsed = parseNamespaceOrTag(\n            reader,\n            properties,\n            this.useTags ? \"item_tags\" : NOTAG\n        );\n        if (helper.merge(parsed)) {\n            const items: string[] = [];\n            if (parsed.data.resolved && parsed.data.values) {\n                helper.merge(\n                    buildTagActions(\n                        parsed.data.values,\n                        start + 1,\n                        reader.cursor,\n                        \"item_tags\",\n                        properties.data.localData\n                    )\n                );\n                parsed.data.values.forEach(v => {\n                    items.push(...(v.data || { values: [] }).values);\n                });\n            } else {\n                if (properties.suggesting && !reader.canRead()) {\n                    helper.addSuggestions(\n                        ...namespaceSuggestionString(\n                            properties.data.globalData.items,\n                            parsed.data.parsed,\n                            start\n                        )\n                    );\n                }\n                const name = stringifyNamespace(parsed.data.parsed);\n                if (properties.data.globalData.items.indexOf(name) < 0) {\n                    helper.addErrors(\n                        UNKNOWNITEM.create(start, reader.cursor, name)\n                    );\n                }\n                items.push(name);\n            }\n        } else {\n            if (parsed.data) {\n                helper.addErrors(\n                    UNKNOWNTAG.create(\n                        start,\n                        reader.cursor,\n                        stringifyNamespace(parsed.data)\n                    )\n                );\n            } else {\n                return helper.fail();\n            }\n        }\n        return helper.succeed();\n    }\n}\n\nexport const stack = new ItemParser(false);\nexport const predicate = new ItemParser(true);\n","export const COLORS = [\n    \"black\",\n    \"dark_blue\",\n    \"dark_green\",\n    \"dark_aqua\",\n    \"dark_red\",\n    \"dark_purple\",\n    \"gold\",\n    \"gray\",\n    \"dark_gray\",\n    \"blue\",\n    \"green\",\n    \"aqua\",\n    \"red\",\n    \"light_purple\",\n    \"yellow\",\n    \"white\",\n    \"reset\"\n];\n","export const itemSlots = slotsBuilder();\n\nfunction slotsBuilder(): string[] {\n    const slots = [];\n\n    slots.push(\"armor.chest\", \"armor.feet\", \"armor.head\", \"armor.legs\");\n\n    for (let i = 0; i < 54; i++) {\n        slots.push(`container.${i}`);\n    }\n\n    for (let i = 0; i < 27; i++) {\n        slots.push(`enderchest.${i}`);\n    }\n\n    for (let i = 0; i < 25; i++) {\n        slots.push(`horse.${i}`);\n    }\n    slots.push(\"horse.armor\", \"horse.chest\", \"horse.saddle\");\n\n    for (let i = 0; i < 9; i++) {\n        slots.push(`hotbar.${i}`);\n    }\n\n    for (let i = 0; i < 27; i++) {\n        slots.push(`inventory.${i}`);\n    }\n\n    for (let i = 0; i < 8; i++) {\n        slots.push(`villager.${i}`);\n    }\n\n    slots.push(\"weapon\", \"weapon.mainhand\", \"weapon.offhand\");\n    return slots;\n}\n","import { COLORS } from \"../../colors\";\n\nexport const scoreboardSlots = createSlots();\n\nfunction createSlots(): string[] {\n    const slots = [];\n\n    slots.push(\"list\", \"sidebar\", \"belowName\");\n\n    for (const s of COLORS) {\n        slots.push(`sidebar.team.${s}`);\n    }\n    return slots;\n}\n","import { COLORS } from \"../../colors\";\n\nexport const anchors = [\"feet\", \"eyes\"];\nexport const operations = [\"+=\", \"-=\", \"*=\", \"/=\", \"%=\", \"=\", \">\", \"<\", \"><\"];\nexport const colors = COLORS;\n\nexport const effects = [\n    \"minecraft:speed\",\n    \"minecraft:slowness\",\n    \"minecraft:haste\",\n    \"minecraft:mining_fatigue\",\n    \"minecraft:strength\",\n    \"minecraft:instant_health\",\n    \"minecraft:instant_damage\",\n    \"minecraft:jump_boost\",\n    \"minecraft:nausea\",\n    \"minecraft:regeneration\",\n    \"minecraft:resistance\",\n    \"minecraft:fire_resistance\",\n    \"minecraft:water_breathing\",\n    \"minecraft:invisibility\",\n    \"minecraft:blindness\",\n    \"minecraft:night_vision\",\n    \"minecraft:hunger\",\n    \"minecraft:weakness\",\n    \"minecraft:poison\",\n    \"minecraft:wither\",\n    \"minecraft:health_boost\",\n    \"minecraft:absorption\",\n    \"minecraft:saturation\",\n    \"minecraft:glowing\",\n    \"minecraft:levitation\",\n    \"minecraft:luck\",\n    \"minecraft:unluck\",\n    \"minecraft:slow_falling\",\n    \"minecraft:conduit_power\",\n    \"minecraft:dolphins_grace\"\n];\n\nexport const enchantments = [\n    \"minecraft:protection\",\n    \"minecraft:fire_protection\",\n    \"minecraft:feather_falling\",\n    \"minecraft:blast_protection\",\n    \"minecraft:projectile_protection\",\n    \"minecraft:respiration\",\n    \"minecraft:aqua_affinity\",\n    \"minecraft:thorns\",\n    \"minecraft:depth_strider\",\n    \"minecraft:frost_walker\",\n    \"minecraft:binding_curse\",\n    \"minecraft:sharpness\",\n    \"minecraft:smite\",\n    \"minecraft:bane_of_arthropods\",\n    \"minecraft:knockback\",\n    \"minecraft:fire_aspect\",\n    \"minecraft:looting\",\n    \"minecraft:sweeping\",\n    \"minecraft:efficiency\",\n    \"minecraft:silk_touch\",\n    \"minecraft:unbreaking\",\n    \"minecraft:fortune\",\n    \"minecraft:power\",\n    \"minecraft:punch\",\n    \"minecraft:flame\",\n    \"minecraft:infinity\",\n    \"minecraft:luck_of_the_sea\",\n    \"minecraft:lure\",\n    \"minecraft:loyalty\",\n    \"minecraft:impaling\",\n    \"minecraft:riptide\",\n    \"minecraft:channeling\",\n    \"minecraft:mending\",\n    \"minecraft:vanishing_curse\"\n];\n\nexport const particles = [\n    \"minecraft:ambient_entity_effect\",\n    \"minecraft:angry_villager\",\n    \"minecraft:barrier\",\n    \"minecraft:block\",\n    \"minecraft:bubble\",\n    \"minecraft:cloud\",\n    \"minecraft:crit\",\n    \"minecraft:damage_indicator\",\n    \"minecraft:dragon_breath\",\n    \"minecraft:dripping_lava\",\n    \"minecraft:dripping_water\",\n    \"minecraft:dust\",\n    \"minecraft:effect\",\n    \"minecraft:elder_guardian\",\n    \"minecraft:enchanted_hit\",\n    \"minecraft:enchant\",\n    \"minecraft:end_rod\",\n    \"minecraft:entity_effect\",\n    \"minecraft:explosion_emitter\",\n    \"minecraft:explosion\",\n    \"minecraft:falling_dust\",\n    \"minecraft:firework\",\n    \"minecraft:fishing\",\n    \"minecraft:flame\",\n    \"minecraft:happy_villager\",\n    \"minecraft:heart\",\n    \"minecraft:instant_effect\",\n    \"minecraft:item\",\n    \"minecraft:item_slime\",\n    \"minecraft:item_snowball\",\n    \"minecraft:large_smoke\",\n    \"minecraft:lava\",\n    \"minecraft:mycelium\",\n    \"minecraft:note\",\n    \"minecraft:poof\",\n    \"minecraft:portal\",\n    \"minecraft:rain\",\n    \"minecraft:smoke\",\n    \"minecraft:spit\",\n    \"minecraft:squid_ink\",\n    \"minecraft:sweep_attack\",\n    \"minecraft:totem_of_undying\",\n    \"minecraft:underwater\",\n    \"minecraft:splash\",\n    \"minecraft:witch\",\n    \"minecraft:bubble_pop\",\n    \"minecraft:current_down\",\n    \"minecraft:bubble_column_up\",\n    \"minecraft:nautilus\"\n];\n\nexport const entities = [\n    \"area_effect_cloud\",\n    \"armor_stand\",\n    \"arrow\",\n    \"bat\",\n    \"blaze\",\n    \"boat\",\n    \"cave_spider\",\n    \"chicken\",\n    \"cod\",\n    \"cow\",\n    \"creeper\",\n    \"donkey\",\n    \"dolphin\",\n    \"dragon_fireball\",\n    \"drowned\",\n    \"elder_guardian\",\n    \"end_crystal\",\n    \"ender_dragon\",\n    \"enderman\",\n    \"endermite\",\n    \"evoker_fangs\",\n    \"evoker\",\n    \"experience_orb\",\n    \"eye_of_ender\",\n    \"falling_block\",\n    \"firework_rocket\",\n    \"ghast\",\n    \"giant\",\n    \"guardian\",\n    \"horse\",\n    \"husk\",\n    \"illusioner\",\n    \"item\",\n    \"item_frame\",\n    \"fireball\",\n    \"leash_knot\",\n    \"llama\",\n    \"llama_spit\",\n    \"magma_cube\",\n    \"minecart\",\n    \"chest_minecart\",\n    \"command_block_minecart\",\n    \"furnace_minecart\",\n    \"hopper_minecart\",\n    \"spawner_minecart\",\n    \"tnt_minecart\",\n    \"mule\",\n    \"mooshroom\",\n    \"ocelot\",\n    \"painting\",\n    \"parrot\",\n    \"pig\",\n    \"pufferfish\",\n    \"zombie_pigman\",\n    \"polar_bear\",\n    \"tnt\",\n    \"rabbit\",\n    \"salmon\",\n    \"sheep\",\n    \"shulker\",\n    \"shulker_bullet\",\n    \"silverfish\",\n    \"skeleton\",\n    \"skeleton_horse\",\n    \"slime\",\n    \"small_fireball\",\n    \"snow_golem\",\n    \"snowball\",\n    \"spectral_arrow\",\n    \"spider\",\n    \"squid\",\n    \"stray\",\n    \"tropical_fish\",\n    \"turtle\",\n    \"egg\",\n    \"ender_pearl\",\n    \"experience_bottle\",\n    \"potion\",\n    \"vex\",\n    \"villager\",\n    \"iron_golem\",\n    \"vindicator\",\n    \"witch\",\n    \"wither\",\n    \"wither_skeleton\",\n    \"wither_skull\",\n    \"wolf\",\n    \"zombie\",\n    \"zombie_horse\",\n    \"zombie_villager\",\n    \"phantom\",\n    \"lightning_bolt\",\n    \"trident\"\n];\n\nexport const dimensions = [\"overworld\", \"the_nether\", \"the_end\"];\n","import { CompletionItemKind } from \"vscode-languageserver\";\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { StringReader } from \"../../brigadier/string-reader\";\nimport { COLORS } from \"../../colors\";\nimport { itemSlots } from \"../../data/lists/item-slot\";\nimport { scoreboardSlots } from \"../../data/lists/scoreboard-slot\";\nimport { anchors, operations } from \"../../data/lists/statics\";\nimport { ReturnHelper } from \"../../misc-functions\";\nimport { Parser, ParserInfo, ReturnedInfo } from \"../../types\";\n\nexport class ListParser implements Parser {\n    private readonly error: CommandErrorBuilder;\n    private readonly options: string[];\n\n    public constructor(options: string[], err: CommandErrorBuilder) {\n        this.options = options;\n        this.error = err;\n    }\n\n    public parse(\n        reader: StringReader,\n        info: ParserInfo\n    ): ReturnedInfo<undefined> {\n        const start = reader.cursor;\n        const helper = new ReturnHelper(info);\n        const optResult = reader.readOption(\n            this.options,\n            false,\n            CompletionItemKind.EnumMember,\n            StringReader.charAllowedInUnquotedString\n        );\n        if (helper.merge(optResult)) {\n            return helper.succeed();\n        } else {\n            return helper.fail(\n                this.error.create(\n                    start,\n                    reader.cursor,\n                    optResult.data.toString()\n                )\n            );\n        }\n    }\n}\n\nconst colorError = new CommandErrorBuilder(\n    \"argument.color.invalid\",\n    \"Unknown color '%s'\"\n);\nexport const colorParser = new ListParser(COLORS, colorError);\n\nconst entityAnchorError = new CommandErrorBuilder(\n    \"argument.anchor.invalid\",\n    \"Invalid entity anchor position %s\"\n);\nexport const entityAnchorParser = new ListParser(anchors, entityAnchorError);\n\nconst slotError = new CommandErrorBuilder(\"slot.unknown\", \"Unknown slot '%s'\");\nexport const itemSlotParser = new ListParser(itemSlots, slotError);\n\nconst operationError = new CommandErrorBuilder(\n    \"arguments.operation.invalid\",\n    \"Invalid operation\"\n);\nexport const operationParser = new ListParser(operations, operationError);\n\nconst scoreboardSlotError = new CommandErrorBuilder(\n    \"argument.scoreboardDisplaySlot.invalid\",\n    \"Unknown display slot '%s'\"\n);\nexport const scoreBoardSlotParser = new ListParser(\n    scoreboardSlots,\n    scoreboardSlotError\n);\n","import { StringReader } from \"../../brigadier/string-reader\";\nimport { ReturnHelper } from \"../../misc-functions\";\nimport { Parser } from \"../../types\";\n\nexport const messageParser: Parser = {\n    parse: (reader: StringReader) => {\n        reader.cursor = reader.getTotalLength();\n        return new ReturnHelper().succeed();\n    }\n};\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { StringReader } from \"../../brigadier/string-reader\";\nimport {\n    dimensions,\n    effects,\n    enchantments,\n    entities,\n    particles\n} from \"../../data/lists/statics\";\nimport {\n    parseNamespaceOption,\n    ReturnHelper,\n    stringArrayToNamespaces,\n    stringifyNamespace\n} from \"../../misc-functions\";\nimport { ContextChange, Parser, ParserInfo, ReturnedInfo } from \"../../types\";\n\nexport class NamespaceListParser implements Parser {\n    private readonly error: CommandErrorBuilder;\n    private readonly options: string[];\n    public constructor(options: string[], errorBuilder: CommandErrorBuilder) {\n        this.options = options;\n        this.error = errorBuilder;\n    }\n    public parse(\n        reader: StringReader,\n        info: ParserInfo\n    ): ReturnedInfo<ContextChange> {\n        const helper = new ReturnHelper(info);\n        const start = reader.cursor;\n        const result = parseNamespaceOption(\n            reader,\n            stringArrayToNamespaces(this.options)\n        );\n        if (helper.merge(result)) {\n            return helper.succeed();\n        } else {\n            if (result.data) {\n                return helper\n                    .addErrors(\n                        this.error.create(\n                            start,\n                            reader.cursor,\n                            stringifyNamespace(result.data)\n                        )\n                    )\n                    .succeed();\n            } else {\n                return helper.fail();\n            }\n        }\n    }\n}\n\nconst summonError = new CommandErrorBuilder(\n    \"entity.notFound\",\n    \"Unknown entity: %s\"\n);\nexport const summonParser = new NamespaceListParser(entities, summonError);\n\nconst enchantmentError = new CommandErrorBuilder(\n    \"enchantment.unknown\",\n    \"Unknown enchantment: %s\"\n);\nexport const enchantmentParser = new NamespaceListParser(\n    enchantments,\n    enchantmentError\n);\n\nconst mobEffectError = new CommandErrorBuilder(\n    \"effect.effectNotFound\",\n    \"Unknown effect: %s\"\n);\nexport const mobEffectParser = new NamespaceListParser(effects, mobEffectError);\n\nconst particleError = new CommandErrorBuilder(\n    \"particle.notFound\",\n    \"Unknown particle: %s\"\n);\nexport const particleParser = new NamespaceListParser(particles, particleError);\n\nconst dimensionError = new CommandErrorBuilder(\n    \"argument.dimension.invalid\",\n    \"Unknown dimension: '%s'\"\n);\n\nexport const dimensionParser = new NamespaceListParser(\n    dimensions,\n    dimensionError\n);\n","import { CompletionItemKind } from \"vscode-languageserver\";\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { Resources } from \"../../data/types\";\nimport {\n    buildPath,\n    buildTagActions,\n    ContextPath,\n    getResourcesofType,\n    parseNamespace,\n    parseNamespaceOption,\n    parseNamespaceOrTag,\n    processParsedNamespaceOption,\n    ReturnHelper,\n    startPaths,\n    stringArrayToNamespaces,\n    stringifyNamespace\n} from \"../../misc-functions\";\nimport { Parser } from \"../../types\";\n\nconst exceptions = {\n    advancement_notfound: new CommandErrorBuilder(\n        \"advancement.advancementNotFound\",\n        \"Unknown advancement: %s\"\n    ),\n    nobossbar: new CommandErrorBuilder(\n        \"commands.bossbar.unknown\",\n        \"No bossbar exists with the ID '%s'\"\n    ),\n    recipe_notfound: new CommandErrorBuilder(\n        \"recipe.notFound\",\n        \"Unkown recipe: %s\"\n    ),\n    unknown_function: new CommandErrorBuilder(\n        \"arguments.function.unknown\",\n        \"Unknown function '%s'\"\n    ),\n    unknown_resource: new CommandErrorBuilder(\n        \"argument.id.unknown\",\n        \"Unknown resource '%s'\"\n    ),\n    unknown_tag: new CommandErrorBuilder(\n        \"arguments.function.tag.unknown\",\n        \"Unknown function tag '#%s'\"\n    )\n};\n\nexport const functionParser: Parser = {\n    parse: (reader, info) => {\n        const helper = new ReturnHelper(info);\n        const start = reader.cursor;\n        const parsed = parseNamespaceOrTag(reader, info, \"function_tags\");\n        const localData = info.data.localData;\n        if (helper.merge(parsed)) {\n            const data = parsed.data;\n            if (data.resolved && data.values) {\n                helper.merge(\n                    buildTagActions(\n                        data.values,\n                        start,\n                        reader.cursor,\n                        \"function_tags\",\n                        localData\n                    )\n                );\n                return helper.succeed();\n            } else {\n                const options = getResourcesofType(info.data, \"functions\");\n                const postProcess = processParsedNamespaceOption(\n                    data.parsed,\n                    options,\n                    info.suggesting && !reader.canRead(),\n                    start,\n                    CompletionItemKind.Method\n                );\n                if (postProcess.data.length === 0) {\n                    helper.addErrors(\n                        exceptions.unknown_function.create(\n                            start,\n                            reader.cursor,\n                            stringifyNamespace(data.parsed)\n                        )\n                    );\n                }\n                if (localData) {\n                    for (const func of postProcess.data) {\n                        const location = buildPath(\n                            func,\n                            localData,\n                            \"functions\"\n                        );\n                        if (location) {\n                            helper.addActions({\n                                data: location,\n                                high: reader.cursor,\n                                low: start,\n                                type: \"source\"\n                            });\n                        }\n                    }\n                }\n                return helper.mergeChain(postProcess).succeed();\n            }\n        } else {\n            if (!parsed.data) {\n                return helper.fail();\n            } else {\n                return helper\n                    .addErrors(\n                        exceptions.unknown_tag.create(\n                            start,\n                            reader.cursor,\n                            stringifyNamespace(parsed.data)\n                        )\n                    )\n                    .succeed();\n            }\n        }\n    }\n};\n\nconst idParser: Parser = {\n    parse: parseNamespace\n};\n\nconst bossbarParser: Parser = {\n    parse: (reader, info) => {\n        const helper = new ReturnHelper(info);\n        if (info.data.localData && info.data.localData.nbt.level) {\n            const start = reader.cursor;\n            const bars = info.data.localData.nbt.level.Data.CustomBossEvents;\n            const options = stringArrayToNamespaces(Object.keys(bars));\n            const result = parseNamespaceOption(reader, options);\n            if (helper.merge(result)) {\n                return helper.succeed();\n            } else {\n                if (result.data) {\n                    return helper\n                        .addErrors(\n                            exceptions.nobossbar.create(\n                                start,\n                                reader.cursor,\n                                stringifyNamespace(result.data)\n                            )\n                        )\n                        .succeed();\n                } else {\n                    return helper.fail();\n                }\n            }\n        } else {\n            return helper.return(parseNamespace(reader));\n        }\n    }\n};\n\nconst resourceKinds: Array<\n    ContextPath<\n        | {\n              issue: CommandErrorBuilder;\n              resource: keyof Resources;\n          }\n        | { resource: Parser }\n    >\n> = [\n    {\n        data: {\n            issue: exceptions.advancement_notfound,\n            resource: \"advancements\"\n        },\n        path: [\"advancement\"]\n    },\n    { data: { resource: idParser }, path: [\"bossbar\", \"add\"] },\n    { data: { resource: bossbarParser }, path: [\"bossbar\"] },\n    {\n        data: { resource: bossbarParser },\n        path: [\"execute\", \"store\", \"result\"]\n    },\n    // Worrying about sounds is not in scope for initial release\n    { data: { resource: idParser }, path: [\"playsound\"] },\n    { data: { resource: idParser }, path: [\"stopsound\"] },\n    {\n        data: { resource: \"recipes\", issue: exceptions.advancement_notfound },\n        path: [\"recipe\"]\n    }\n];\n\nexport const resourceParser: Parser = {\n    parse: (reader, info) => {\n        const start = reader.cursor;\n        const helper = new ReturnHelper(info);\n        const kind = startPaths(resourceKinds, info.path);\n        if (kind) {\n            if (typeof kind.resource === \"object\") {\n                return helper.return(kind.resource.parse(reader, info));\n            } else {\n                const result = parseNamespaceOption(\n                    reader,\n                    getResourcesofType(info.data, kind.resource)\n                );\n                if (helper.merge(result)) {\n                    return helper.succeed();\n                } else {\n                    if (result.data) {\n                        return helper\n                            .addErrors(\n                                // @ts-ignore type inference failure\n                                (kind.issue as CommandErrorBuilder).create(\n                                    start,\n                                    reader.cursor,\n                                    stringifyNamespace(result.data)\n                                )\n                            )\n                            .succeed();\n                    } else {\n                        return helper.fail();\n                    }\n                }\n            }\n        } else {\n            throw new Error(\n                `Resource at path ${\n                    info.path\n                } does not have a supported resource`\n            );\n        }\n    }\n};\n","export const verbatimCriteria = [\n    \"air\",\n    \"armor\",\n    \"deathCount\",\n    \"dummy\",\n    \"food\",\n    \"health\",\n    \"level\",\n    \"playerKillCount\",\n    \"totalKillCount\",\n    \"trigger\",\n    \"xp\",\n    \"minecraft.custom:minecraft.animals_bred\",\n    \"minecraft.custom:minecraft.aviate_one_cm\",\n    \"minecraft.custom:minecraft.boat_one_cm\",\n    \"minecraft.custom:minecraft.clean_armor\",\n    \"minecraft.custom:minecraft.clean_banner\",\n    \"minecraft.custom:minecraft.clean_shulker_box\",\n    \"minecraft.custom:minecraft.climb_one_cm\",\n    \"minecraft.custom:minecraft.crouch_one_cm\",\n    \"minecraft.custom:minecraft.damage_absorbed\",\n    \"minecraft.custom:minecraft.damage_blocked_by_shield\",\n    \"minecraft.custom:minecraft.damage_dealt\",\n    \"minecraft.custom:minecraft.damage_dealt_absorbed\",\n    \"minecraft.custom:minecraft.damage_dealt_resisted\",\n    \"minecraft.custom:minecraft.damage_resisted\",\n    \"minecraft.custom:minecraft.damage_taken\",\n    \"minecraft.custom:minecraft.deaths\",\n    \"minecraft.custom:minecraft.drop\",\n    \"minecraft.custom:minecraft.eat_cake_slice\",\n    \"minecraft.custom:minecraft.enchant_item\",\n    \"minecraft.custom:minecraft.fall_one_cm\",\n    \"minecraft.custom:minecraft.fill_cauldron\",\n    \"minecraft.custom:minecraft.fish_caught\",\n    \"minecraft.custom:minecraft.fly_one_cm\",\n    \"minecraft.custom:minecraft.horse_one_cm\",\n    \"minecraft.custom:minecraft.inspect_dispenser\",\n    \"minecraft.custom:minecraft.inspect_dropper\",\n    \"minecraft.custom:minecraft.inspect_hopper\",\n    \"minecraft.custom:minecraft.interact_with_beacon\",\n    \"minecraft.custom:minecraft.interact_with_brewingstand\",\n    \"minecraft.custom:minecraft.interact_with_crafting_table\",\n    \"minecraft.custom:minecraft.interact_with_furnace\",\n    \"minecraft.custom:minecraft.jump\",\n    \"minecraft.custom:minecraft.leave_game\",\n    \"minecraft.custom:minecraft.minecart_one_cm\",\n    \"minecraft.custom:minecraft.mob_kills\",\n    \"minecraft.custom:minecraft.open_chest\",\n    \"minecraft.custom:minecraft.open_enderchest\",\n    \"minecraft.custom:minecraft.open_shulker_box\",\n    \"minecraft.custom:minecraft.pig_one_cm\",\n    \"minecraft.custom:minecraft.play_noteblock\",\n    \"minecraft.custom:minecraft.play_one_minute\",\n    \"minecraft.custom:minecraft.play_record\",\n    \"minecraft.custom:minecraft.player_kills\",\n    \"minecraft.custom:minecraft.pot_flower\",\n    \"minecraft.custom:minecraft.sleep_in_bed\",\n    \"minecraft.custom:minecraft.sneak_time\",\n    \"minecraft.custom:minecraft.sprint_one_cm\",\n    \"minecraft.custom:minecraft.swim_one_cm\",\n    \"minecraft.custom:minecraft.talked_to_villager\",\n    \"minecraft.custom:minecraft.time_since_death\",\n    \"minecraft.custom:minecraft.time_since_rest\",\n    \"minecraft.custom:minecraft.traded_with_villager\",\n    \"minecraft.custom:minecraft.trigger_trapped_chest\",\n    \"minecraft.custom:minecraft.tune_noteblock\",\n    \"minecraft.custom:minecraft.use_cauldron\",\n    \"minecraft.custom:minecraft.walk_on_water_one_cm\",\n    \"minecraft.custom:minecraft.walk_one_cm\",\n    \"minecraft.custom:minecraft.walk_under_water_one_cm\"\n];\n\nexport const colorCriteria = [\"teamkill.\", \"killedByTeam.\"];\n\nexport const itemCriteria = [\n    \"minecraft.broken:\",\n    \"minecraft.crafted:\",\n    \"minecraft.dropped:\",\n    \"minecraft.picked_up:\",\n    \"minecraft.used:\"\n];\n\nexport const blockCriteria = [\"minecraft.mined:\"];\n\nexport const entityCriteria = [\"minecraft.killed_by:\", \"minecraft.killed:\"];\n","import { CompletionItemKind } from \"vscode-languageserver\";\n\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\nimport { StringReader } from \"../../brigadier/string-reader\";\nimport { COLORS } from \"../../colors\";\nimport {\n    blockCriteria,\n    colorCriteria,\n    entityCriteria,\n    itemCriteria,\n    verbatimCriteria\n} from \"../../data/lists/criteria\";\nimport { entities } from \"../../data/lists/statics\";\nimport { DisplaySlots } from \"../../data/nbt/nbt-types\";\nimport {\n    convertToNamespace,\n    ReturnHelper,\n    stringifyNamespace\n} from \"../../misc-functions\";\nimport { typed_keys } from \"../../misc-functions/third_party/typed-keys\";\nimport { Parser } from \"../../types\";\n\nconst exceptions = {\n    unknown_objective: new CommandErrorBuilder(\n        \"arguments.objective.notFound\",\n        \"Unknown scoreboard objective '%s'\"\n    ),\n    unknown_team: new CommandErrorBuilder(\"team.notFound\", \"Unknown team '%s'\")\n};\n\nconst slotPurposes: { [_ in keyof DisplaySlots]: string } = {\n    slot_0: \"list\",\n    slot_1: \"sidebar\",\n    slot_10: \"sidebar.team.gray\",\n    slot_11: \"sidebar.team.dark_gray\",\n    slot_12: \"sidebar.team.blue\",\n    slot_13: \"sidebar.team.green\",\n    slot_14: \"sidebar.team.aqua\",\n    slot_15: \"sidebar.team.red\",\n    slot_16: \"sidebar.team.light_purple\",\n    slot_17: \"sidebar.team.yellow\",\n    slot_18: \"sidebar.team.white\",\n    slot_2: \"belowName\",\n    slot_3: \"sidebar.team.black\",\n    slot_4: \"sidebar.team.dark_blue\",\n    slot_5: \"sidebar.team.dark_green\",\n    slot_6: \"sidebar.team.dark_aqua\",\n    slot_7: \"sidebar.team.dark_red\",\n    slot_8: \"sidebar.team.dark_purple\",\n    slot_9: \"sidebar.team.gold\"\n};\n\nexport const objectiveParser: Parser = {\n    parse: (reader, info) => {\n        const helper = new ReturnHelper(info);\n        const start = reader.cursor;\n        if (info.data.localData) {\n            const scoreboardData = info.data.localData.nbt.scoreboard;\n            if (scoreboardData) {\n                const options = scoreboardData.data.Objectives.map(v => v.Name);\n                const result = reader.readOption(\n                    options,\n                    false,\n                    undefined,\n                    StringReader.charAllowedInUnquotedString\n                );\n                if (helper.merge(result)) {\n                    if (!info.suggesting) {\n                        for (const objective of scoreboardData.data\n                            .Objectives) {\n                            if (objective.Name === result.data) {\n                                helper.addActions({\n                                    data: `Displayed as: ${\n                                        objective.DisplayName\n                                    }\n\nCriteria: ${objective.CriteriaName}`,\n                                    high: reader.cursor,\n                                    low: start,\n                                    type: \"hover\"\n                                });\n                                break;\n                            }\n                        }\n                        if (scoreboardData.data.DisplaySlots) {\n                            for (const slot of typed_keys(\n                                scoreboardData.data.DisplaySlots\n                            )) {\n                                if (\n                                    scoreboardData.data.DisplaySlots[slot] ===\n                                    result.data\n                                ) {\n                                    helper.addActions({\n                                        data: `Displayed in ${\n                                            slotPurposes[slot]\n                                        }`,\n                                        high: reader.cursor,\n                                        low: start,\n                                        type: \"hover\"\n                                    });\n                                }\n                            }\n                        }\n                    }\n                } else {\n                    if (result.data) {\n                        helper.addErrors(\n                            exceptions.unknown_objective.create(\n                                start,\n                                reader.cursor,\n                                result.data\n                            )\n                        );\n                    } else {\n                        return helper.fail();\n                    }\n                }\n                return helper.succeed();\n            }\n        }\n        reader.readUnquotedString();\n        return helper.succeed();\n    }\n};\n\nexport const teamParser: Parser = {\n    parse: (reader, info) => {\n        const helper = new ReturnHelper();\n        const start = reader.cursor;\n        if (info.data.localData) {\n            const scoreboardData = info.data.localData.nbt.scoreboard;\n            if (scoreboardData) {\n                const options = scoreboardData.data.Teams;\n                const result = reader.readOption(\n                    options.map(v => v.Name),\n                    false,\n                    undefined,\n                    StringReader.charAllowedInUnquotedString\n                );\n                if (helper.merge(result)) {\n                    for (const team of options) {\n                        if (team.Name === result.data) {\n                            helper.addActions({\n                                data: `\\`\\`\\`json\n${JSON.stringify(team, undefined, 4)}\n\\`\\`\\``,\n                                high: reader.cursor,\n                                low: start,\n                                type: \"hover\"\n                            });\n                            break;\n                        }\n                    }\n                } else {\n                    if (result.data) {\n                        helper.addErrors(\n                            exceptions.unknown_objective.create(\n                                start,\n                                reader.cursor,\n                                result.data\n                            )\n                        );\n                    } else {\n                        return helper.fail();\n                    }\n                }\n            }\n        } else {\n            reader.readUnquotedString();\n        }\n        return helper.succeed();\n    }\n};\nconst UNKNOWN_CRITERIA = new CommandErrorBuilder(\n    \"argument.criteria.invalid\",\n    \"Unknown criteria '%s'\"\n);\n\nconst NONWHITESPACE = /\\S/;\n\nexport const criteriaParser: Parser = {\n    parse: (reader, info) => {\n        const start = reader.cursor;\n        const helper = new ReturnHelper(info);\n        const optionResult = reader.readOption(\n            [\n                ...verbatimCriteria,\n                ...blockCriteria,\n                ...colorCriteria,\n                ...entityCriteria,\n                ...itemCriteria\n            ],\n            false,\n            CompletionItemKind.EnumMember,\n            NONWHITESPACE\n        );\n        const text = optionResult.data;\n        if (helper.merge(optionResult)) {\n            if (verbatimCriteria.indexOf(optionResult.data) !== -1) {\n                return helper.succeed();\n            }\n        }\n        if (!text) {\n            return helper.fail(); // `unreachable!()`\n        }\n        const end = reader.cursor;\n        for (const choice of colorCriteria) {\n            if (text.startsWith(choice)) {\n                reader.cursor = start + choice.length;\n                const result = reader.readOption(\n                    COLORS,\n                    false,\n                    CompletionItemKind.Color,\n                    NONWHITESPACE\n                );\n                if (helper.merge(result)) {\n                    return helper.succeed();\n                }\n            }\n        }\n        for (const choice of entityCriteria) {\n            if (text.startsWith(choice)) {\n                reader.cursor = start + choice.length;\n                const result = reader.readOption(\n                    entities.map(mapFunction),\n                    false,\n                    CompletionItemKind.Reference,\n                    NONWHITESPACE\n                );\n                if (helper.merge(result)) {\n                    return helper.succeed();\n                }\n            }\n        }\n        for (const choice of blockCriteria) {\n            if (text.startsWith(choice)) {\n                reader.cursor = start + choice.length;\n                const result = reader.readOption(\n                    Object.keys(info.data.globalData.blocks).map(mapFunction),\n                    false,\n                    CompletionItemKind.Constant,\n                    NONWHITESPACE\n                );\n                if (helper.merge(result)) {\n                    return helper.succeed();\n                }\n            }\n        }\n        for (const choice of itemCriteria) {\n            if (text.startsWith(choice)) {\n                reader.cursor = start + choice.length;\n                const result = reader.readOption(\n                    info.data.globalData.items.map(mapFunction),\n                    false,\n                    CompletionItemKind.Keyword,\n                    NONWHITESPACE\n                );\n                if (helper.merge(result)) {\n                    return helper.succeed();\n                }\n            }\n        }\n        helper.addErrors(UNKNOWN_CRITERIA.create(start, end, text));\n        return helper.succeed();\n    }\n};\n\nfunction mapFunction(value: string): string {\n    return stringifyNamespace(convertToNamespace(value)).replace(\":\", \".\");\n}\n","import { CommandNode } from \"../data/types\";\nimport { Parser } from \"../types\";\n\nimport * as brigadierParsers from \"./brigadier\";\nimport { literalParser } from \"./literal\";\nimport * as blockParsers from \"./minecraft/block\";\nimport { jsonParser } from \"./minecraft/component\";\nimport * as coordParsers from \"./minecraft/coordinates\";\nimport * as itemParsers from \"./minecraft/item\";\nimport * as listParsers from \"./minecraft/lists\";\nimport { messageParser } from \"./minecraft/message\";\nimport * as namespaceParsers from \"./minecraft/namespace-list\";\nimport { functionParser, resourceParser } from \"./minecraft/resources\";\nimport {\n    criteriaParser,\n    objectiveParser,\n    teamParser\n} from \"./minecraft/scoreboard\";\n\n/**\n * Incomplete:\n * https://github.com/Levertion/mcfunction-langserver/projects/1\n */\nconst implementedParsers: { [id: string]: Parser } = {\n    \"brigadier:bool\": brigadierParsers.boolParser,\n    \"brigadier:float\": brigadierParsers.floatParser,\n    \"brigadier:integer\": brigadierParsers.intParser,\n    \"brigadier:string\": brigadierParsers.stringParser,\n    \"minecraft:block_pos\": coordParsers.blockPos,\n    \"minecraft:block_predicate\": blockParsers.predicateParser,\n    \"minecraft:block_state\": blockParsers.stateParser,\n    \"minecraft:color\": listParsers.colorParser,\n    \"minecraft:component\": jsonParser,\n    \"minecraft:dimension\": namespaceParsers.dimensionParser,\n    \"minecraft:entity_anchor\": listParsers.entityAnchorParser,\n    \"minecraft:entity_summon\": namespaceParsers.summonParser,\n    \"minecraft:function\": functionParser,\n    \"minecraft:item_enchantment\": namespaceParsers.enchantmentParser,\n    \"minecraft:item_predicate\": itemParsers.predicate,\n    \"minecraft:item_slot\": listParsers.itemSlotParser,\n    \"minecraft:item_stack\": itemParsers.stack,\n    \"minecraft:message\": messageParser,\n    \"minecraft:mob_effect\": namespaceParsers.mobEffectParser,\n    \"minecraft:objective\": objectiveParser,\n    \"minecraft:objective_criteria\": criteriaParser,\n    \"minecraft:operation\": listParsers.operationParser,\n    \"minecraft:particle\": namespaceParsers.particleParser,\n    \"minecraft:resource_location\": resourceParser,\n    \"minecraft:rotation\": coordParsers.rotation,\n    \"minecraft:scoreboard_slot\": listParsers.scoreBoardSlotParser,\n    \"minecraft:team\": teamParser,\n    \"minecraft:vec2\": coordParsers.vec2,\n    \"minecraft:vec3\": coordParsers.vec3\n};\n\nexport function getParser(node: CommandNode): Parser | undefined {\n    switch (node.type) {\n        case \"literal\":\n            return literalParser;\n        case \"argument\":\n            if (!!node.parser) {\n                return getArgParser(node.parser);\n            }\n            break;\n        default:\n    }\n    return undefined;\n}\n\nfunction getArgParser(id: string): Parser | undefined {\n    if (\n        !!global.mcLangSettings &&\n        !!global.mcLangSettings.parsers &&\n        global.mcLangSettings.parsers.hasOwnProperty(id)\n    ) {\n        try {\n            return global.mcLangSettings.parsers[id];\n        } catch (_) {\n            mcLangLog(\n                `${global.mcLangSettings.parsers[id]} could not be loaded`\n            );\n        }\n    }\n    if (implementedParsers.hasOwnProperty(id)) {\n        return implementedParsers[id];\n    }\n    mcLangLog(`Argument with parser id ${id} has no associated parser.\nPlease consider reporting this at https://github.com/Levertion/mcfunction-language-server/issues`);\n    return undefined;\n}\n","import {\n    CompletionItem,\n    CompletionItemKind,\n    CompletionList,\n    InsertTextFormat\n} from \"vscode-languageserver/lib/main\";\n\nimport { StringReader } from \"./brigadier/string-reader\";\nimport { COMMENT_START } from \"./consts\";\nimport { DataManager } from \"./data/manager\";\nimport { CommandNodePath, CommandTree } from \"./data/types\";\nimport { createParserInfo } from \"./misc-functions/creators\";\nimport { followPath, getNextNode } from \"./misc-functions/node-tree\";\nimport { getParser } from \"./parsers/get-parser\";\nimport {\n    CommandContext,\n    CommmandData,\n    FunctionInfo,\n    ParseNode,\n    SuggestResult\n} from \"./types\";\n\nexport function computeCompletions(\n    linenum: number,\n    character: number,\n    document: FunctionInfo,\n    data: DataManager\n): CompletionList {\n    const line = document.lines[linenum];\n    if (line.parseInfo === undefined || line.text.startsWith(COMMENT_START)) {\n        return CompletionList.create([], true);\n    }\n    const commandData: CommmandData = {\n        globalData: data.globalData,\n        localData: data.getPackFolderData(document.pack_segments)\n    };\n    const nodes = line.parseInfo ? line.parseInfo.nodes : [];\n    if (nodes.length === 0) {\n        return CompletionList.create(\n            getCompletionsFromNode(\n                linenum,\n                0,\n                character,\n                line.text,\n                [],\n                commandData,\n                {}\n            ),\n            true\n        );\n    }\n    const { finals, internals } = getAllNodes(nodes, character);\n    const completions: CompletionItem[] = [];\n    for (const finalNode of finals) {\n        completions.push(\n            ...getCompletionsFromNode(\n                linenum,\n                finalNode.high + 1,\n                character,\n                line.text,\n                finalNode.path,\n                commandData,\n                finalNode.context\n            )\n        );\n    }\n    for (const insideNode of internals) {\n        const newPath = insideNode.path.slice();\n        const parentPath = newPath.slice(0, -1);\n        completions.push(\n            ...getCompletionsFromNode(\n                linenum,\n                insideNode.low,\n                character,\n                line.text,\n                parentPath,\n                commandData,\n                insideNode.context\n            )\n        );\n    }\n    return CompletionList.create(completions, true);\n}\n\nexport function getAllNodes(\n    nodes: ParseNode[],\n    character: number\n): { finals: ParseNode[]; internals: ParseNode[] } {\n    const finals: ParseNode[] = [];\n    const internals: ParseNode[] = [];\n    for (const node of nodes) {\n        if (node.high < character) {\n            if (node.final) {\n                finals.push(node);\n            }\n        } else {\n            if (node.low <= character) {\n                internals.push(node);\n            }\n        }\n    }\n    return { finals, internals };\n}\n\nfunction getCompletionsFromNode(\n    line: number,\n    start: number,\n    end: number,\n    text: string,\n    nodepath: CommandNodePath,\n    data: CommmandData,\n    context: CommandContext\n): CompletionItem[] {\n    const parent = getNextNode(\n        followPath(data.globalData.commands, nodepath),\n        nodepath,\n        (data.globalData.commands as any) as CommandTree\n    ).node;\n    const result: CompletionItem[] = [];\n    if (!!parent.children) {\n        for (const childKey in parent.children) {\n            if (parent.children.hasOwnProperty(childKey)) {\n                const child = parent.children[childKey];\n                const childPath = [...nodepath, childKey];\n                const info = createParserInfo(\n                    child,\n                    data,\n                    childPath,\n                    context,\n                    true\n                );\n                const parser = getParser(child);\n                if (!!parser) {\n                    const reader = new StringReader(text.substring(start, end));\n                    const parseResult = parser.parse(reader, info);\n                    if (!!parseResult) {\n                        result.push(\n                            ...suggestionsToCompletions(\n                                parseResult.suggestions,\n                                line,\n                                start,\n                                end,\n                                parser.kind\n                            )\n                        );\n                    }\n                }\n            }\n        }\n    }\n    return result;\n}\n\nfunction suggestionsToCompletions(\n    suggestions: SuggestResult[],\n    line: number,\n    start: number,\n    end: number,\n    defaultKind: CompletionItemKind = CompletionItemKind.Keyword\n): CompletionItem[] {\n    const result: CompletionItem[] = [];\n    for (const suggestion of suggestions) {\n        if (typeof suggestion === \"string\") {\n            result.push({\n                kind: defaultKind,\n                label: suggestion,\n                textEdit: {\n                    newText: suggestion,\n                    range: {\n                        end: { character: end, line },\n                        start: { character: start, line }\n                    }\n                }\n            });\n        } else {\n            const completion: CompletionItem = {\n                insertTextFormat:\n                    suggestion.insertTextFormat || InsertTextFormat.PlainText,\n                kind: suggestion.kind || defaultKind,\n                label: suggestion.label || suggestion.text,\n                textEdit: {\n                    newText: suggestion.text,\n                    range: {\n                        end: { character: end, line },\n                        start: { character: start + suggestion.start, line }\n                    }\n                }\n            };\n            if (!!suggestion.description) {\n                completion.documentation = suggestion.description;\n            }\n            result.push(completion);\n        }\n    }\n    return result;\n}\n","import { Range } from \"vscode-languageserver\";\n\nimport { GlobalData } from \"../data/types\";\nimport { PackLocationSegments } from \"../misc-functions\";\nimport { CommmandData } from \"../types\";\nimport { ReturnAssertionInfo, TestParserInfo } from \"./assertions\";\n\n/**\n * Blank items for testing\n */\n\n// tslint:disable-next-line:variable-name This allows for the property declaration shorthand\nexport const pack_segments: PackLocationSegments = {\n    pack: \"\",\n    packsFolder: \"\",\n    rest: \"\"\n};\n\nexport const succeeds: ReturnAssertionInfo = { succeeds: true };\n\nexport const blankproperties: TestParserInfo = {\n    context: {},\n    data: {} as CommmandData,\n    node_properties: {},\n    path: [\"test\"]\n};\n\nexport const emptyGlobal: GlobalData = {\n    blocks: {},\n    commands: { type: \"root\" },\n    items: [],\n    jsonService: undefined as any,\n    meta_info: { version: \"\" },\n    resources: {}\n};\n\nexport const blankRange: Range = {\n    end: { line: 0, character: 0 },\n    start: { line: 0, character: 0 }\n};\n","import { Interval, IntervalTree } from \"node-interval-tree\";\nimport {\n    Hover,\n    Location,\n    Position,\n    SignatureHelp,\n    SignatureInformation,\n    SymbolInformation,\n    SymbolKind\n} from \"vscode-languageserver\";\n\nimport Uri from \"vscode-uri\";\nimport { getAllNodes } from \"./completions\";\nimport { COMMENT_START } from \"./consts\";\nimport { DataManager } from \"./data/manager\";\nimport { CommandNode, CommandTree, MCNode, Resources } from \"./data/types\";\nimport {\n    buildPath,\n    convertToNamespace,\n    followPath,\n    getNextNode,\n    namespaceStart,\n    stringifyNamespace\n} from \"./misc-functions\";\nimport { typed_keys } from \"./misc-functions/third_party/typed-keys\";\nimport { blankRange } from \"./test/blanks\";\nimport {\n    CommandLine,\n    FunctionInfo,\n    JSONDocInfo,\n    ParseNode,\n    SubAction\n} from \"./types\";\n\nexport function hoverProvider(\n    docLine: CommandLine,\n    pos: Position,\n    _: FunctionInfo,\n    manager: DataManager\n): Hover | undefined {\n    function computeIntervalHovers<T extends Interval>(\n        intervals: T[],\n        commandLine: CommandLine,\n        line: number,\n        map: (intervals: T[]) => Hover[\"contents\"]\n    ): Hover {\n        const end: Position = {\n            character: intervals.reduce((acc, v) => Math.max(acc, v.high), 0),\n            line\n        };\n        const start: Position = {\n            character: intervals.reduce(\n                (acc, v) => Math.min(acc, v.low),\n                commandLine.text.length\n            ),\n            line\n        };\n        return { contents: map(intervals), range: { start, end } };\n    }\n    const json = getActionsOfKind(docLine, pos, \"json\");\n    if (json.length > 0) {\n        const doc = json[0].data as JSONDocInfo;\n        let result: Hover | null | undefined;\n        const position: Position = {\n            character: pos.character - json[0].low,\n            line: 0\n        };\n        manager.globalData.jsonService\n            .doHover(doc.text, position, doc.json)\n            .then(v => (result = v));\n        if (result) {\n            if (result.range) {\n                result.range.start.line = pos.line;\n                result.range.end.line = pos.line;\n                result.range.start.character += json[0].low;\n                result.range.end.character += json[0].low;\n            }\n            return result;\n        }\n    }\n    const hovers = getActionsOfKind(docLine, pos, \"hover\");\n    if (hovers.length > 0) {\n        return computeIntervalHovers(hovers, docLine, pos.line, i =>\n            i.map(v => v.data as string)\n        );\n    } else {\n        const tree = getNodeTree(docLine);\n        if (tree) {\n            const matching = tree.search(pos.character, pos.character);\n            if (matching.length > 0) {\n                return computeIntervalHovers(matching, docLine, pos.line, i =>\n                    i.map<string>(node => {\n                        const data = followPath(\n                            manager.globalData.commands,\n                            node.path\n                        ) as CommandNode;\n                        return `${\n                            data.type === \"literal\"\n                                ? \"literal\"\n                                : `\\`${data.parser}\\` parser`\n                        } on path '${node.path.join(\", \")}'`;\n                    })\n                );\n            }\n        }\n    }\n    return undefined;\n}\n\nexport function definitionProvider(\n    docLine: CommandLine,\n    pos: Position\n): Location[] {\n    if (docLine) {\n        const actions = getActionsOfKind(docLine, pos, \"source\");\n        const start: Position = { line: 0, character: 0 };\n        return actions.map<Location>(a => ({\n            range: { start, end: start },\n            uri: Uri.file(a.data as any).toString()\n        }));\n    }\n    return [];\n}\n\nexport function signatureHelpProvider(\n    line: CommandLine,\n    pos: Position,\n    _: FunctionInfo,\n    manager: DataManager\n): SignatureHelp | undefined {\n    if (line.parseInfo === undefined || line.text.startsWith(COMMENT_START)) {\n        return undefined;\n    }\n    const nodes = line.parseInfo ? line.parseInfo.nodes : [];\n    if (nodes.length === 0) {\n        const sigs = getSignatureHelp([], manager);\n        if (sigs) {\n            const activeSignature =\n                line.text.length > 0\n                    ? Math.max(\n                          sigs.findIndex(v => v.label.startsWith(line.text)),\n                          0\n                      )\n                    : 0;\n            return {\n                activeParameter: 0,\n                activeSignature,\n                signatures: sigs\n            };\n        } else {\n            return undefined;\n        }\n    }\n\n    let text = \"\";\n    const { finals, internals } = getAllNodes(nodes, pos.character);\n    const signatures: SignatureInformation[] = [];\n    for (const finalNode of finals) {\n        const result = getSignatureHelp(finalNode.path, manager);\n        if (result) {\n            signatures.push(...result);\n        }\n        const currentText = line.text.slice(finalNode.high + 1);\n        if (currentText.length > text.length) {\n            text = currentText;\n        }\n    }\n    for (const internalNode of internals) {\n        const pth = internalNode.path.slice();\n        if (pth.length > 0) {\n            pth.splice(pth.length - 1);\n            const result = getSignatureHelp(pth, manager);\n            if (result) {\n                signatures.push(...result);\n            }\n            const currentText = line.text.slice(\n                internalNode.low,\n                internalNode.high\n            );\n            if (currentText.length > text.length) {\n                text = currentText;\n            }\n        }\n    }\n    if (signatures.length > 0) {\n        const activeSignature =\n            text.length > 0\n                ? Math.max(\n                      signatures.findIndex(v => v.label.startsWith(text)),\n                      0\n                  )\n                : 0;\n        return { signatures, activeParameter: 0, activeSignature };\n    }\n    return undefined;\n}\n\nfunction buildSignatureHelpForChildren(\n    node: MCNode<CommandNode> & Partial<CommandNode>,\n    path: string[],\n    commands: CommandTree,\n    depth: number\n): string[] {\n    if (node.children) {\n        const result: string[] = [];\n        for (const childName of Object.keys(node.children)) {\n            const child = node.children[childName];\n            const childPath = [...path, childName];\n            const childNode = getNextNode(child, childPath, commands);\n            const parameterInfo = buildParameterInfoForNode(\n                (childNode.node as CommandTree).type === \"root\" // Handle automatic root redirect\n                    ? child\n                    : (childNode.node as CommandNode),\n                childName\n            );\n            if (depth > 0) {\n                const next = buildSignatureHelpForChildren(\n                    childNode.node,\n                    childNode.path,\n                    commands,\n                    node.executable ? depth - 1 : 0\n                );\n                if (next.length > 0) {\n                    if (parameterInfo) {\n                        result.push(\n                            [\n                                parameterInfo,\n                                ...next.map(\n                                    v => (node.executable ? `[${v}]` : v)\n                                )\n                            ].join(\" \")\n                        );\n                    } else {\n                        result.push(\n                            next\n                                .map(v => (node.executable ? `[${v}]` : v))\n                                .join(\" \")\n                        );\n                    }\n                    continue;\n                }\n            }\n            if (parameterInfo) {\n                result.push(parameterInfo);\n            }\n        }\n        if (depth === 0) {\n            return [result.join(\"|\")];\n        }\n        return result;\n    }\n    return [];\n}\n\nfunction buildParameterInfoForNode(\n    node: CommandNode,\n    name: string\n): string | undefined {\n    return node.type === \"literal\"\n        ? name\n        : node.type === \"argument\"\n            ? `<${name}: ${node.parser}>`\n            : undefined;\n}\n\n// Arbritrary number used to calculate the max length of the line\nconst SIZE = 50;\nfunction getSignatureHelp(\n    path: string[],\n    manager: DataManager\n): SignatureInformation[] {\n    const commands = manager.globalData.commands;\n    const next = getNextNode(followPath(commands, path), path, commands);\n    const options = buildSignatureHelpForChildren(\n        next.node,\n        next.path,\n        commands,\n        2\n    );\n    const result: SignatureInformation[] = [];\n    for (const option of options) {\n        result.push(buildSignature(option, path));\n    }\n    return result;\n}\n\nfunction buildSignature(option: string, path: string[]): SignatureInformation {\n    if (option.length > SIZE) {\n        let index = option.lastIndexOf(\"|\", SIZE);\n        if (index === -1) {\n            index = SIZE;\n        }\n        return {\n            documentation: `${option\n                .slice(index)\n                .replace(\"|\", \"\\t(pipe) \")\n                .replace(/\\|/g, \"\\n\\t| \")\n                .replace(\"(pipe)\", \"|\")}\\n\\nCommand at path ${path.join()}`,\n            label: `${option.slice(0, SIZE)}...`\n        };\n    } else {\n        return {\n            documentation: `Command at path '${path.join()}'`,\n            label: option\n        };\n    }\n}\n\nfunction getActionsOfKind(\n    line: CommandLine,\n    position: Position,\n    kind: SubAction[\"type\"]\n): SubAction[] {\n    if (line.parseInfo) {\n        if (!line.actions) {\n            line.actions = new IntervalTree();\n            for (const action of line.parseInfo.actions) {\n                line.actions.insert(action);\n            }\n        }\n        const tree = line.actions;\n        return tree\n            .search(position.character, position.character)\n            .filter(v => v.type === kind);\n    }\n    return [];\n}\n\nfunction getNodeTree(line: CommandLine): IntervalTree<ParseNode> | undefined {\n    if (line.nodes) {\n        return line.nodes;\n    }\n    if (line.parseInfo) {\n        const tree = new IntervalTree<ParseNode>();\n        for (const node of line.parseInfo.nodes) {\n            tree.insert(node);\n        }\n        return tree;\n    }\n    return undefined;\n}\n\nexport function getWorkspaceSymbols(\n    manager: DataManager,\n    query: string\n): SymbolInformation[] {\n    const result: SymbolInformation[] = [];\n    const worlds = manager.packData;\n    const namespace = convertToNamespace(query);\n    for (const worldPath of Object.keys(worlds)) {\n        const world = worlds[worldPath];\n        for (const packID in world.packs) {\n            if (world.packs.hasOwnProperty(packID)) {\n                const pack = world.packs[packID];\n                for (const type of typed_keys(pack.data)) {\n                    const val = pack.data[type];\n                    if (val) {\n                        for (const item of val) {\n                            if (namespaceStart(item, namespace)) {\n                                result.push({\n                                    kind: symbolKindForResource(type),\n                                    location: {\n                                        range: blankRange,\n                                        uri: Uri.file(buildPath(\n                                            item,\n                                            world,\n                                            type\n                                        ) as any).toString()\n                                    },\n                                    name: stringifyNamespace(item)\n                                });\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    return result;\n}\n\nexport function symbolKindForResource(resource: keyof Resources): SymbolKind {\n    switch (resource) {\n        case \"block_tags\":\n        case \"function_tags\":\n        case \"item_tags\":\n            return SymbolKind.Namespace;\n        case \"advancements\":\n        case \"functions\":\n        case \"loot_tables\":\n        case \"recipes\":\n        case \"structures\":\n            break;\n\n        default:\n    }\n    return SymbolKind.Variable;\n}\n","import { resourceTypes, ReturnHelper } from \"../../misc-functions\";\nimport { typed_keys } from \"../../misc-functions/third_party/typed-keys\";\n\nimport { join } from \"path\";\nimport { ReturnSuccess } from \"../../types\";\nimport { GlobalData, Resources, WorldInfo } from \"../types\";\n\nexport async function runMapFunctions(\n    resources: Resources,\n    globalData: GlobalData,\n    packRoot: string,\n    localData?: WorldInfo\n): Promise<ReturnSuccess<Resources>> {\n    const result: Resources = {};\n    const helper = new ReturnHelper();\n    const promises: Array<Promise<void>> = [];\n    for (const type of typed_keys(resources)) {\n        type resourcesType = NonNullable<Resources[typeof type]>;\n        const val = (result[type] = [] as resourcesType);\n        const data = resources[type] as resourcesType;\n        // tslint:disable-next-line:no-unbound-method We control this function, so we know it won't use the this keyword.\n        const mapFunction = resourceTypes[type].mapFunction;\n        if (mapFunction) {\n            promises.push(\n                ...data.map(async v => {\n                    const res = await mapFunction(\n                        v,\n                        packRoot,\n                        globalData,\n                        localData\n                    );\n                    helper.merge(res);\n                    val.push(res.data);\n                })\n            );\n        } else {\n            val.push(...data);\n        }\n    }\n    await Promise.all(promises);\n    return helper.succeed(result);\n}\n\nexport async function mapPacksInfo(\n    packsInfo: WorldInfo,\n    global: GlobalData\n): Promise<ReturnSuccess<WorldInfo>> {\n    const helper = new ReturnHelper();\n    const result: WorldInfo = { ...packsInfo, packs: {} };\n    const promises = typed_keys(packsInfo.packs).map(async packID => {\n        const element = packsInfo.packs[packID];\n        const subresult = await runMapFunctions(\n            element.data,\n            global,\n            join(packsInfo.location, element.name),\n            packsInfo\n        );\n        helper.merge(subresult);\n        result.packs[packID] = { ...element, data: subresult.data };\n    });\n    await Promise.all(promises);\n    return helper.succeed(result);\n}\n","import * as Long from \"long\";\n\nexport class BufferStream {\n    private readonly buf: Buffer;\n    private index: number;\n\n    public constructor(buffer: Buffer) {\n        this.index = 0;\n        this.buf = buffer;\n    }\n\n    public getByte(): number {\n        const out = this.buf.readInt8(this.index);\n        this.index++;\n        return out;\n    }\n\n    public getDouble(): number {\n        const out = this.buf.readDoubleBE(this.index);\n        this.index += 8;\n        return out;\n    }\n\n    public getFloat(): number {\n        const out = this.buf.readFloatBE(this.index);\n        this.index += 4;\n        return out;\n    }\n\n    public getInt(): number {\n        const out = this.buf.readInt32BE(this.index);\n        this.index += 4;\n        return out;\n    }\n\n    public getLong(): Long {\n        const arr = this.buf.subarray(this.index, this.index + 8);\n        this.index += 8;\n        return Long.fromBytesBE([...arr]);\n    }\n\n    public getShort(): number {\n        const out = this.buf.readInt16BE(this.index);\n        this.index += 2;\n        return out;\n    }\n\n    public getUTF8(): string {\n        const len = this.getShort();\n        const out = this.buf.toString(\"utf8\", this.index, this.index + len);\n        this.index += len;\n        return out;\n    }\n}\n","import { promisify } from \"util\";\nimport * as zlib from \"zlib\";\nimport { BufferStream } from \"./buffer-stream\";\n\nconst unzipAsync = promisify<zlib.InputType, Buffer>(zlib.unzip);\n\nlet tags: Tag;\n\ntype tagparser<T> = (buffer: BufferStream) => T;\n\nconst nbtbyte = (buffer: BufferStream) => buffer.getByte();\nconst nbtshort = (buffer: BufferStream) => buffer.getShort();\nconst nbtint = (buffer: BufferStream) => buffer.getInt();\nconst nbtlong = (buffer: BufferStream) => buffer.getLong();\nconst nbtfloat = (buffer: BufferStream) => buffer.getFloat();\nconst nbtdouble = (buffer: BufferStream) => buffer.getDouble();\n\nconst nbtbytearray = (buffer: BufferStream) => {\n    const len = buffer.getInt();\n    const out: number[] = [];\n    for (let i = 0; i < len; i++) {\n        out.push(buffer.getByte());\n    }\n    return out;\n};\n\nconst nbtstring = (buffer: BufferStream) => buffer.getUTF8();\n\nconst nbtlist = (buffer: BufferStream) => {\n    const id = buffer.getByte();\n    const len = buffer.getInt();\n    const parser = tags[id];\n    const out: any[] = [];\n    for (let i = 0; i < len; i++) {\n        out.push(parser(buffer));\n    }\n    return out;\n};\n\nconst nbtcompound = (buffer: BufferStream) => {\n    let tag: number = buffer.getByte();\n    const out: { [key: string]: any } = {};\n    while (tag !== 0) {\n        const name = buffer.getUTF8();\n        const parser = tags[tag];\n        out[name] = parser(buffer);\n        tag = buffer.getByte();\n    }\n    return out;\n};\n\nconst nbtintarray = (buffer: BufferStream) => {\n    const len = buffer.getInt();\n    const out: number[] = [];\n    for (let i = 0; i < len; i++) {\n        out.push(buffer.getInt());\n    }\n    return out;\n};\n\nconst nbtlongarray = (buffer: BufferStream) => {\n    const len = buffer.getInt();\n    const out: Long[] = [];\n    for (let i = 0; i < len; i++) {\n        out.push(buffer.getLong());\n    }\n    return out;\n};\n\ninterface Tag {\n    [id: number]: tagparser<any>;\n}\n\ntags = {\n    // Need to redeclare because of TSLint\n    1: nbtbyte,\n    2: nbtshort,\n    3: nbtint,\n    4: nbtlong,\n    5: nbtfloat,\n    6: nbtdouble,\n    7: nbtbytearray,\n    8: nbtstring,\n    9: nbtlist,\n    10: nbtcompound,\n    11: nbtintarray,\n    12: nbtlongarray\n};\n\nexport async function parse<T>(\n    buffer: Buffer,\n    named: boolean = true\n): Promise<T> {\n    let unzipbuf;\n    try {\n        unzipbuf = await unzipAsync(buffer);\n    } catch (e) {\n        unzipbuf = buffer;\n    }\n    const stream = new BufferStream(unzipbuf);\n    const id = stream.getByte();\n    if (named) {\n        stream.getUTF8(); // Name\n    }\n    const parser = tags[id];\n    return parser(stream) as T;\n}\n","import * as path from \"path\";\nimport { readFileAsync } from \"../../misc-functions\";\nimport { WorldNBT } from \"../types\";\nimport { Level, Scoreboard } from \"./nbt-types\";\nimport { parse } from \"./parser\";\n\nexport async function loadNBT(worldLoc: string): Promise<WorldNBT> {\n    const nbt: WorldNBT = {} as WorldNBT;\n\n    const levelpath = path.resolve(worldLoc, \"./level.dat\");\n    try {\n        const levelbuf: Buffer = await readFileAsync(levelpath);\n        nbt.level = await parse<Level>(levelbuf);\n    } catch (e) {\n        // Level doesn't exist\n    }\n\n    const scpath = path.resolve(worldLoc, \"./data/scoreboard.dat\");\n    try {\n        const scoreboardbuf: Buffer = await readFileAsync(scpath);\n        nbt.scoreboard = await parse<Scoreboard>(scoreboardbuf);\n    } catch (e) {\n        // Scoreboard file doesn't exist\n    }\n\n    return nbt;\n}\n","import * as path from \"path\";\n\nimport { DATAFOLDER, MCMETAFILE, SLASH, SLASHREPLACEREGEX } from \"../consts\";\nimport { resourceTypes, ReturnHelper } from \"../misc-functions\";\nimport { createExtensionFileError } from \"../misc-functions/file-errors\";\nimport {\n    readDirAsync,\n    readJSON,\n    statAsync,\n    walkDir\n} from \"../misc-functions/promisified-fs\";\nimport { typed_keys } from \"../misc-functions/third_party/typed-keys\";\nimport { ReturnSuccess } from \"../types\";\nimport { mapPacksInfo } from \"./extractor/mapfunctions\";\nimport { loadNBT } from \"./nbt/nbt-cache\";\nimport {\n    Datapack,\n    DataPackID,\n    GlobalData,\n    McmetaFile,\n    MinecraftResource,\n    Resources,\n    WorldInfo\n} from \"./types\";\n\nexport async function getNamespaceResources(\n    namespace: string,\n    dataFolder: string,\n    id: DataPackID | undefined,\n    result: Resources = {}\n): Promise<ReturnSuccess<Resources>> {\n    const helper = new ReturnHelper();\n    const namespaceFolder = path.join(dataFolder, namespace);\n    const subDirs = await subDirectories(namespaceFolder);\n    await Promise.all(\n        typed_keys(resourceTypes).map(async type => {\n            const resourceInfo = resourceTypes[type];\n            if (subDirs.indexOf(resourceInfo.path[0]) === -1) {\n                return;\n            }\n            const dataContents = path.join(\n                namespaceFolder,\n                ...resourceInfo.path\n            );\n            const files = await walkDir(dataContents);\n            if (files.length === 0) {\n                return;\n            }\n            const nameSpaceContents = result[type] || [];\n            await Promise.all(\n                files.map(async file => {\n                    const realExtension = path.extname(file);\n                    if (realExtension !== resourceInfo.extension) {\n                        helper.addMisc(\n                            createExtensionFileError(\n                                file,\n                                resourceInfo.extension,\n                                realExtension\n                            )\n                        );\n                    }\n                    const internalUri = path.relative(dataContents, file);\n                    const newResource: MinecraftResource = {\n                        namespace,\n                        pack: id,\n                        path: internalUri\n                            .slice(0, -realExtension.length)\n                            .replace(SLASHREPLACEREGEX, SLASH)\n                    };\n                    nameSpaceContents.push(newResource);\n                })\n            );\n            result[type] = nameSpaceContents;\n        })\n    );\n\n    return helper.succeed(result);\n}\n\nasync function buildDataPack(\n    packFolder: string,\n    id: DataPackID,\n    packName: string\n): Promise<ReturnSuccess<Datapack>> {\n    const helper = new ReturnHelper();\n    const dataFolder = path.join(packFolder, DATAFOLDER);\n    const [mcmeta, packResources] = await Promise.all([\n        readJSON<McmetaFile>(path.join(packFolder, MCMETAFILE)),\n        getPackResources(dataFolder, id)\n    ]);\n    const result: Datapack = { id, data: packResources.data, name: packName };\n    helper.merge(packResources);\n    if (helper.merge(mcmeta)) {\n        result.mcmeta = mcmeta.data;\n    }\n    return helper.succeed(result);\n}\n\nasync function getPackResources(\n    dataFolder: string,\n    id: DataPackID\n): Promise<ReturnSuccess<Resources>> {\n    const helper = new ReturnHelper();\n    const namespaces = await subDirectories(dataFolder);\n    const result: Resources = {};\n    await Promise.all(\n        namespaces.map(async namespace => {\n            const resources = await getNamespaceResources(\n                namespace,\n                dataFolder,\n                id,\n                result\n            );\n            helper.merge(resources);\n            return resources.data;\n        })\n    );\n    return helper.succeed(result);\n}\n\nexport async function getPacksInfo(\n    location: string,\n    globalData: GlobalData\n): Promise<ReturnSuccess<WorldInfo>> {\n    const packNames = await subDirectories(location);\n    const helper = new ReturnHelper();\n    const packs = [...packNames.entries()];\n    const nbt = await loadNBT(path.resolve(location, \"../\"));\n    const result: WorldInfo = { location, packnamesmap: {}, packs: {}, nbt };\n    const promises: Array<Promise<void>> = packs.map(\n        async ([packID, packName]) => {\n            const loc = path.join(location, packName);\n            const packData = await buildDataPack(loc, packID, packName);\n            helper.merge(packData);\n            result.packs[packID] = packData.data;\n            result.packnamesmap[packName] = packID;\n        }\n    );\n    await Promise.all(promises);\n    const otherResult = await mapPacksInfo(result, globalData);\n    return helper.mergeChain(otherResult).succeed(otherResult.data);\n}\n\nasync function subDirectories(baseFolder: string): Promise<string[]> {\n    let files: string[] = [];\n    try {\n        files = await readDirAsync(baseFolder);\n    } catch {\n        return [];\n    }\n    const promises = files.map<Promise<boolean>>(async name => {\n        try {\n            return (await statAsync(path.join(baseFolder, name))).isDirectory();\n        } catch {\n            return false;\n        }\n    });\n    const results = await Promise.all(promises);\n    return files.filter((_, i) => results[i]);\n}\n","import * as fs from \"fs\";\nimport * as path from \"path\";\nimport { shim } from \"util.promisify\";\nshim();\nimport { promisify } from \"util\";\n\nimport { DATAFOLDER } from \"../../consts\";\nimport { ReturnHelper } from \"../../misc-functions\";\nimport { ReturnSuccess } from \"../../types\";\nimport { getNamespaceResources } from \"../datapack-resources\";\nimport { BlocksPropertyInfo, CommandTree, GlobalData } from \"../types\";\nimport { runMapFunctions } from \"./mapfunctions\";\nconst readFileAsync = promisify(fs.readFile);\n\ntype DataSaveResult<T extends keyof GlobalData> = [T, GlobalData[T]];\n\nexport async function collectData(\n    version: string,\n    dataDir: string\n): Promise<ReturnSuccess<GlobalData>> {\n    const helper = new ReturnHelper();\n    const result: GlobalData = { meta_info: { version } } as GlobalData;\n    const cleanups = await Promise.all([\n        getBlocks(dataDir),\n        getItems(dataDir),\n        getCommands(dataDir),\n        getResources(dataDir)\n    ]);\n    for (const dataType of cleanups) {\n        result[dataType[0]] = dataType[1];\n    }\n    const resources = await runMapFunctions(result.resources, result, dataDir);\n    return helper\n        .mergeChain(resources)\n        .succeed({ ...result, resources: resources.data });\n}\n\n//#region Resources\nasync function getResources(\n    dataDir: string\n): Promise<DataSaveResult<\"resources\">> {\n    const namespacePath = path.join(dataDir, DATAFOLDER);\n    const resources = await getNamespaceResources(\n        \"minecraft\",\n        namespacePath,\n        undefined\n    );\n    return [\"resources\", resources.data];\n}\n//#endregion\n//#region Items\nasync function getItems(dataDir: string): Promise<DataSaveResult<\"items\">> {\n    const itemsData: Dictionary<{ protocol_id: number }> = JSON.parse(\n        (await readFileAsync(\n            path.join(dataDir, \"reports\", \"items.json\")\n        )).toString()\n    );\n    return [\"items\", Object.keys(itemsData)];\n}\nasync function getCommands(\n    dataDir: string\n): Promise<DataSaveResult<\"commands\">> {\n    const tree: CommandTree = JSON.parse(\n        (await readFileAsync(\n            path.join(dataDir, \"reports\", \"commands.json\")\n        )).toString()\n    );\n    return [\"commands\", tree];\n}\n//#endregion\n\n//#region Blocks\nasync function getBlocks(dataDir: string): Promise<DataSaveResult<\"blocks\">> {\n    const blocksData: BlocksJson = JSON.parse(\n        (await readFileAsync(\n            path.join(dataDir, \"reports\", \"blocks.json\")\n        )).toString()\n    );\n    return [\"blocks\", cleanBlocks(blocksData)];\n}\n\nfunction cleanBlocks(blocks: BlocksJson): BlocksPropertyInfo {\n    const result: BlocksPropertyInfo = {};\n    for (const blockName in blocks) {\n        if (blocks.hasOwnProperty(blockName)) {\n            const blockInfo = blocks[blockName];\n            result[blockName] = {};\n            if (!!blockInfo.properties) {\n                Object.assign(result[blockName], blockInfo.properties);\n            }\n        }\n    }\n    return result;\n}\n\ninterface BlocksJson {\n    [id: string]: {\n        properties?: {\n            [id: string]: string[];\n        };\n    };\n}\n//#endregion\n","// tslint:disable:no-require-imports\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n// @ts-ignore `import *` syntax is broken in this case as requestPromise would be a function\nimport requestPromise from \"request-promise-native\";\n\nexport async function getPathToJar(\n    tempdir: string,\n    currentversion: string\n): Promise<JarInfo> {\n    if (!!mcLangSettings.data.customJar) {\n        return { jarPath: mcLangSettings.data.customJar, version: \"\" };\n    } else {\n        return downloadJar(currentversion, tempdir);\n    }\n}\n\nexport async function downloadJar(\n    currentversion: string,\n    tmpDirName: string\n): Promise<JarInfo> {\n    const versionInfo = await getLatestVersionInfo();\n    if (versionInfo.id !== currentversion) {\n        const singleVersion: SingleVersionInformation = await requestPromise(\n            versionInfo.url,\n            {\n                json: true\n            }\n        ).promise();\n        const jarPath = path.join(\n            tmpDirName,\n            `minecraft-function-${versionInfo.id}.jar`\n        );\n        const requestPromised = requestPromise(\n            singleVersion.downloads.server.url\n        );\n        requestPromised.pipe(fs.createWriteStream(jarPath));\n        await Promise.resolve(requestPromised);\n        return { jarPath, version: versionInfo.id };\n    } else {\n        throw new Error(\n            \"Downloading new global data not needed as current version is the same as the latest version.\"\n        );\n    }\n}\n\nexport interface JarInfo {\n    jarPath: string;\n    version: string;\n}\n\n//#region Version Manifest Usage\ninterface SingleVersionInformation {\n    downloads: {\n        server: {\n            sha1: string;\n            size: number;\n            url: string;\n        };\n    };\n}\n\nasync function getLatestVersionInfo(): Promise<VersionInfo> {\n    const manifest: VersionsManifest = await requestPromise(\n        \"https://launchermeta.mojang.com/mc/game/version_manifest.json\",\n        {\n            json: true\n        }\n    ).promise();\n    const version = findVersion(getVersionId(manifest), manifest);\n    return version;\n}\n\nfunction getVersionId(manifest: VersionsManifest): string {\n    if (mcLangSettings.data.snapshots) {\n        return manifest.latest.snapshot;\n    } else {\n        return manifest.latest.release;\n    }\n}\n\nfunction findVersion(version: string, manifest: VersionsManifest): VersionInfo {\n    return manifest.versions.find(\n        verInfo => verInfo.id === version\n    ) as VersionInfo;\n}\n\ninterface VersionInfo {\n    id: string;\n    releaseTime: string;\n    time: string;\n    type: \"snapshot\" | \"release\";\n    url: string;\n}\n\ninterface VersionsManifest {\n    latest: {\n        release: string;\n        snapshot: string;\n    };\n    versions: VersionInfo[];\n}\n//#endregion\n","import { execFile } from \"child_process\";\nimport * as path from \"path\";\nimport { shim } from \"util.promisify\";\nshim();\nimport { promisify } from \"util\";\nconst execFileAsync = promisify(execFile);\n\n/**\n * Get the command used to execute a java version\n */\nexport async function checkJavaPath(): Promise<string> {\n    const javaPath = mcLangSettings.data.javaPath || \"java\";\n    try {\n        await execFileAsync(javaPath, [\"-version\"], { env: process.env });\n        return javaPath;\n    } catch (error) {\n        throw new Error(\n            `Could not find Java executable. Got message: '${error}'`\n        );\n    }\n}\n\nexport async function runGenerator(\n    javapath: string,\n    tempdir: string,\n    jarpath: string\n): Promise<string> {\n    const resultFolder = path.join(tempdir, \"generated\");\n    await execFileAsync(javapath, [\n        \"-cp\",\n        jarpath,\n        \"net.minecraft.data.Main\",\n        \"--output\",\n        resultFolder,\n        \"--all\"\n    ]);\n    return resultFolder;\n}\n","import * as fs from \"fs\";\nimport { tmpdir } from \"os\";\nimport * as path from \"path\";\nimport { shim } from \"util.promisify\";\nshim();\nimport { promisify } from \"util\";\n\nimport { ReturnHelper } from \"../../misc-functions\";\nimport { ReturnSuccess } from \"../../types\";\nimport { cacheData } from \"../cache\";\nimport { GlobalData } from \"../types\";\nimport { collectData } from \"./collect-data\";\nimport { getPathToJar } from \"./download\";\nimport { checkJavaPath, runGenerator } from \"./extract-data\";\n\nconst mkdtmpAsync = promisify(fs.mkdtemp);\n\n/**\n * Will throw an error if something goes wrong.\n * Steps:\n * - Check if enabled in settings. ✓\n * - Check versions manifest. Compare with cached if available ✓\n *  - At the same time, check if java is installed ✓\n * - Get single version information ✓\n * - Download the jar into a temporary folder ✓\n * - Run the exposed data generator. ✓\n * - Collect the data exposed\n *  - Blocks and states\n *  - Items\n *  - (Entities)?\n *  - Commands\n *  - Advancements, recipes, structures, tags, etc\n * - Cache that data\n * - Return the data\n */\nexport async function collectGlobalData(\n    currentversion: string = \"\"\n): Promise<ReturnSuccess<GlobalData>> {\n    if (mcLangSettings.data.enabled) {\n        const javaPath = await checkJavaPath();\n        const dir = await mkdtmpAsync(path.join(tmpdir(), \"mcfunction\"));\n        const jarInfo = await getPathToJar(dir, currentversion);\n        const datadir = await runGenerator(javaPath, dir, jarInfo.jarPath);\n        mcLangLog(\"Generator Finished\");\n        const helper = new ReturnHelper();\n        const data = await collectData(jarInfo.version, datadir);\n        await cacheData(data.data);\n        return helper.mergeChain(data).succeed(data.data);\n    } else {\n        throw new Error(\n            \"Data Obtainer disabled in settings. To obtain data automatically, please enable it.\"\n        );\n    }\n}\n","import { SynchronousPromise } from \"synchronous-promise\";\nimport {\n    getLanguageService,\n    SchemaRequestService\n} from \"vscode-json-languageservice\";\nimport { NonCacheable } from \"./types\";\n\nconst textComponentSchema =\n    \"https://raw.githubusercontent.com/Levertion/minecraft-json-schema/master/java/shared/text_component.json\";\n\nexport async function loadNonCached(): Promise<NonCacheable> {\n    const schemas: { [key: string]: string } = {\n        [textComponentSchema]: JSON.stringify(\n            // FIXME: prettier breaks require.resolve so we need to use plain require to get the correct path\n            // tslint:disable-next-line:no-require-imports\n            require(\"minecraft-json-schemas/java/shared/text_component\")\n        )\n    };\n    const schemaRequestService: SchemaRequestService = url =>\n        schemas.hasOwnProperty(url)\n            ? SynchronousPromise.resolve(schemas[url])\n            : SynchronousPromise.reject<string>(\n                  `Schema at url ${url} not supported`\n              );\n\n    const jsonService = getLanguageService({\n        promiseConstructor: SynchronousPromise,\n        schemaRequestService\n    });\n    jsonService.configure({\n        allowComments: false,\n        schemas: [\n            {\n                fileMatch: [\"text-component.json\"],\n                uri: textComponentSchema\n            }\n        ],\n        validate: true\n    });\n\n    return {\n        jsonService\n    };\n}\n","import {\n    DidChangeWatchedFilesParams,\n    FileChangeType\n} from \"vscode-languageserver\";\n\nimport { extname, join } from \"path\";\nimport { MCMETAFILE } from \"../consts\";\nimport {\n    getKindAndNamespace,\n    namespacesEqual,\n    PackLocationSegments,\n    parseDataPath,\n    resourceTypes,\n    ReturnHelper\n} from \"../misc-functions\";\nimport { createExtensionFileError } from \"../misc-functions/file-errors\";\nimport { readJSON } from \"../misc-functions/promisified-fs\";\nimport { ReturnedInfo, ReturnSuccess } from \"../types\";\nimport { readCache } from \"./cache\";\nimport { getPacksInfo } from \"./datapack-resources\";\nimport { collectGlobalData } from \"./extractor\";\nimport { loadNonCached } from \"./noncached\";\nimport {\n    Datapack,\n    DataPackID,\n    GlobalData,\n    LocalData,\n    McmetaFile,\n    MinecraftResource,\n    WorldInfo\n} from \"./types\";\n\nexport class DataManager {\n    /**\n     * Create a datamanager using Dummy Data for running tests.\n     */\n    public static newWithData(\n        dummyGlobal?: DataManager[\"globalDataInternal\"],\n        dummyPacks?: DataManager[\"packDataComplete\"]\n    ): DataManager {\n        const manager = new DataManager();\n\n        manager.globalDataInternal = dummyGlobal || manager.globalDataInternal;\n        Object.assign(manager.packDataComplete, dummyPacks);\n        return manager;\n    }\n    //#region Data Management\n    private globalDataInternal: GlobalData = {} as GlobalData;\n\n    private readonly packDataComplete: { [root: string]: WorldInfo } = {};\n\n    private readonly packDataPromises: {\n        [root: string]: Promise<ReturnSuccess<WorldInfo>>;\n    } = {};\n\n    public get globalData(): GlobalData {\n        return this.globalDataInternal;\n    }\n    public get packData(): DataManager[\"packDataComplete\"] {\n        return this.packDataComplete;\n    }\n    //#endregion\n    //#region Constructor\n    //#endregion\n    public getPackFolderData(\n        folder: PackLocationSegments | undefined\n    ): LocalData | undefined {\n        if (\n            !!folder &&\n            this.packDataComplete.hasOwnProperty(folder.packsFolder)\n        ) {\n            const info = this.packDataComplete[folder.packsFolder];\n\n            return { ...info, current: info.packnamesmap[folder.pack] };\n        }\n        return undefined;\n    }\n\n    public async handleChanges(\n        event: DidChangeWatchedFilesParams\n    ): Promise<ReturnedInfo<undefined>> {\n        const helper = new ReturnHelper(false);\n        const firsts = new Set<string>();\n        const promises = event.changes.map(async change => {\n            try {\n                const parsedPath = parseDataPath(change.uri);\n                if (parsedPath) {\n                    interface InlineData {\n                        data: WorldInfo;\n                        pack: Datapack;\n                        packID: DataPackID;\n                    }\n                    const getData = async (): Promise<InlineData> => {\n                        const first = await this.readPackFolderData(\n                            parsedPath.packsFolder\n                        );\n                        if (first) {\n                            firsts.add(parsedPath.packsFolder);\n                        }\n                        const data = this.getPackFolderData(parsedPath);\n                        if (!data) {\n                            throw new Error(\n                                \"Could not load data from datapacks folder\"\n                            );\n                        }\n                        const packID = data.packnamesmap[parsedPath.pack];\n                        const pack = data.packs[packID];\n                        return { data, pack, packID };\n                    };\n\n                    if (parsedPath.rest === MCMETAFILE) {\n                        const { pack } = await getData();\n                        if (!firsts.has(parsedPath.packsFolder)) {\n                            const res = await readJSON<McmetaFile>(change.uri);\n                            pack.mcmeta = helper.merge(res)\n                                ? res.data\n                                : undefined;\n                        }\n                    } else {\n                        const namespace = getKindAndNamespace(parsedPath.rest);\n                        if (namespace) {\n                            const { pack, packID, data } = await getData();\n                            if (!firsts.has(parsedPath.packsFolder)) {\n                                const shouldUpdateContents =\n                                    change.type === FileChangeType.Changed &&\n                                    resourceTypes[namespace.kind].mapFunction;\n                                let contents = pack.data[namespace.kind];\n                                if (\n                                    (change.type === FileChangeType.Deleted ||\n                                        shouldUpdateContents) &&\n                                    !!contents\n                                ) {\n                                    for (let i = 0; i < contents.length; i++) {\n                                        const element = contents[i];\n                                        if (\n                                            namespacesEqual(\n                                                element,\n                                                namespace.location\n                                            )\n                                        ) {\n                                            contents.splice(i, 1);\n                                            break;\n                                        }\n                                    }\n                                }\n                                if (\n                                    change.type === FileChangeType.Created ||\n                                    shouldUpdateContents\n                                ) {\n                                    if (!contents) {\n                                        contents = pack.data[\n                                            namespace.kind\n                                        ] = [];\n                                    }\n                                    const newResource: MinecraftResource = {\n                                        ...namespace.location,\n                                        pack: packID\n                                    };\n                                    const actual = extname(change.uri);\n                                    const expected =\n                                        resourceTypes[namespace.kind].extension;\n                                    if (actual === expected) {\n                                        const mapFunction =\n                                            // tslint:disable-next-line:no-unbound-method We control this function, so we know it won't use the this keyword.\n                                            resourceTypes[namespace.kind]\n                                                .mapFunction;\n                                        if (mapFunction) {\n                                            const result = await mapFunction(\n                                                newResource,\n                                                join(\n                                                    parsedPath.packsFolder,\n                                                    parsedPath.pack\n                                                ),\n                                                this.globalData,\n                                                data\n                                            );\n                                            if (helper.merge(result)) {\n                                                contents.push(result.data);\n                                            }\n                                        } else {\n                                            contents.push(newResource);\n                                        }\n                                    } else {\n                                        helper.addMisc(\n                                            createExtensionFileError(\n                                                change.uri,\n                                                expected,\n                                                actual\n                                            )\n                                        );\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            } catch (error) {\n                mcLangLog(\n                    `Change ${JSON.stringify(\n                        change\n                    )} could not be completed, due to '${JSON.stringify(\n                        error\n                    )}'`\n                );\n            }\n        });\n        await Promise.all(promises);\n        return helper.succeed();\n    }\n\n    public async loadGlobalData(): Promise<true | string> {\n        let version: string | undefined;\n        if (!!this.globalData.meta_info) {\n            version = this.globalData.meta_info.version;\n        }\n        try {\n            const helper = new ReturnHelper();\n            const data = await collectGlobalData(version);\n            helper.merge(data);\n            if (this.globalDataInternal) {\n                this.globalDataInternal = {\n                    ...this.globalDataInternal,\n                    ...data.data\n                };\n            } else {\n                this.globalDataInternal = {\n                    ...(await loadNonCached()),\n                    ...data.data\n                };\n            }\n            return true;\n        } catch (error) {\n            return `Error loading global data: ${error.stack ||\n                error.toString()}`;\n        }\n    }\n\n    public async readCache(): Promise<boolean> {\n        try {\n            const cache = await readCache();\n            const noncache = await loadNonCached();\n            this.globalDataInternal = { ...cache, ...noncache };\n            mcLangLog(\"Cache Successfully read\");\n            return true;\n        } catch (error) {\n            mcLangLog(\n                `Reading cache failed with error ${JSON.stringify(error)}`\n            );\n            return false;\n        }\n    }\n\n    /**\n     * @returns Whether this is the first request for this folder\n     */\n    public async readPackFolderData(\n        folder: string\n    ): Promise<ReturnedInfo<void>> {\n        const helper = new ReturnHelper();\n        if (!this.packDataPromises.hasOwnProperty(folder)) {\n            this.packDataPromises[folder] = getPacksInfo(\n                folder,\n                this.globalData\n            );\n            const result = await this.packDataPromises[folder];\n            this.packDataComplete[folder] = result.data;\n            helper.merge(result);\n            return helper.succeed();\n        } else {\n            await this.packDataPromises[folder];\n            return helper.fail();\n        }\n    }\n}\n","/**\n * merge_deep function adapted from:\n *\n * https://stackoverflow.com/a/34749873/8728461\n *\n * Originally, non-typescript code by: https://github.com/salakar\n */\n\ntype AnyDict = Dictionary<any>;\n\n/**\n * Simple object check.\n */\nexport function isObject(item: any): item is AnyDict {\n    return item && typeof item === \"object\" && !Array.isArray(item);\n}\n\n/**\n * Deep merge two objects.\n */\nexport function mergeDeep(target: AnyDict, ...sources: AnyDict[]): AnyDict {\n    if (!sources.length) {\n        return target;\n    }\n    const source = sources.shift();\n    if (isObject(target) && isObject(source)) {\n        for (const key in source) {\n            if (isObject(source[key])) {\n                if (!target[key]) {\n                    Object.assign(target, { [key]: {} });\n                }\n                mergeDeep(target[key], source[key]);\n            } else {\n                Object.assign(target, { [key]: source[key] });\n            }\n        }\n    }\n    return mergeDeep(target, ...sources);\n}\n","import { EventEmitter } from \"events\";\nimport { DiagnosticSeverity } from \"vscode-languageserver/lib/main\";\n\nimport { CommandErrorBuilder } from \"./brigadier/errors\";\nimport { StringReader } from \"./brigadier/string-reader\";\nimport { COMMENT_START, SPACE } from \"./consts\";\nimport { DataManager } from \"./data/manager\";\nimport {\n    CommandNode,\n    CommandNodePath,\n    GlobalData,\n    LocalData\n} from \"./data/types\";\nimport {\n    createParserInfo,\n    getNextNode,\n    isSuccessful,\n    ReturnHelper\n} from \"./misc-functions\";\nimport { getParser } from \"./parsers/get-parser\";\nimport {\n    CommandContext,\n    CommmandData,\n    FunctionInfo,\n    ParseNode,\n    ReturnedInfo,\n    StoredParseResult\n} from \"./types\";\n\nconst parseExceptions = {\n    Ambiguity: new CommandErrorBuilder(\n        \"parsing.command.ambiguous\",\n        \"Command text is possibly ambiguous\",\n        DiagnosticSeverity.Information\n    ),\n    NoSuccesses: new CommandErrorBuilder(\n        \"command.parsing.matchless\",\n        \"No nodes which matched '%s' found\"\n    ),\n    NotRunnable: new CommandErrorBuilder(\n        \"parsing.command.executable\",\n        \"The command '%s' cannot be run.\",\n        DiagnosticSeverity.Warning\n    )\n};\n\nexport function parseCommand(\n    text: string,\n    globalData: GlobalData,\n    localData: LocalData | undefined\n): StoredParseResult | void {\n    if (text.length === 0 || text.startsWith(COMMENT_START)) {\n        return undefined;\n    }\n    const reader = new StringReader(text);\n    const data: CommmandData = { globalData, localData };\n    const startingcontext: CommandContext = {};\n    const recurse = parsechildren(\n        reader,\n        globalData.commands as any,\n        [],\n        data,\n        startingcontext\n    );\n    const nodes: ParseNode[] = [];\n    if (isSuccessful(recurse)) {\n        nodes.push(...recurse.data);\n    }\n    return { actions: recurse.actions, nodes, errors: recurse.errors };\n}\n\nfunction parsechildren(\n    reader: StringReader,\n    node: CommandNode,\n    path: CommandNodePath,\n    data: CommmandData,\n    context: CommandContext\n): ReturnedInfo<ParseNode[]> {\n    const parent = getNextNode(node, path, data.globalData.commands);\n    const helper = new ReturnHelper();\n    const children = parent.node.children;\n    if (children) {\n        const nodes: ParseNode[] = [];\n        const start = reader.cursor;\n        let successCount = 0;\n        let min: number = reader.getTotalLength();\n        for (const childKey of Object.keys(children)) {\n            const child = children[childKey];\n            const childpath = [...parent.path, childKey];\n            const result = parseAgainstNode(\n                reader,\n                child,\n                childpath,\n                data,\n                context\n            );\n            if (helper.merge(result)) {\n                const newNode: ParseNode = {\n                    context,\n                    final: true,\n                    high: reader.cursor,\n                    low: start,\n                    path: childpath\n                };\n                const childdata = result.data;\n                function checkRead(): boolean {\n                    if (reader.canRead()) {\n                        return true;\n                    } else {\n                        if (!childdata.node.executable) {\n                            helper.addErrors(\n                                parseExceptions.NotRunnable.create(\n                                    0,\n                                    reader.cursor,\n                                    reader.string\n                                )\n                            );\n                        }\n                        return false;\n                    }\n                }\n                if (checkRead()) {\n                    if (reader.peek() === SPACE) {\n                        successCount++;\n                        reader.skip();\n                        if (checkRead()) {\n                            const newContext = childdata.newContext\n                                ? childdata.newContext\n                                : context;\n                            const recurse = parsechildren(\n                                reader,\n                                childdata.node,\n                                childpath,\n                                data,\n                                newContext\n                            );\n                            if (helper.merge(recurse)) {\n                                min = Math.min(min, reader.cursor);\n                                nodes.push(...recurse.data);\n                                newNode.final = false;\n                            }\n                        }\n                        nodes.push(newNode);\n                    }\n                } else {\n                    successCount++;\n                    nodes.push(newNode);\n                }\n            }\n            reader.cursor = start;\n        }\n        if (successCount === 0) {\n            return helper.fail(\n                parseExceptions.NoSuccesses.create(\n                    reader.cursor,\n                    reader.getTotalLength(),\n                    reader.getRemaining()\n                )\n            );\n        }\n        if (successCount > 1) {\n            helper.addErrors(parseExceptions.Ambiguity.create(start, min));\n        }\n        return helper.succeed(nodes);\n    } else {\n        if (!(parent.node as CommandNode).executable) {\n            mcLangLog(\n                `Malformed tree at path ${JSON.stringify(\n                    path\n                )}. No children and not executable`\n            );\n        }\n        return helper.fail();\n    }\n}\n\ninterface NodeParseSuccess {\n    max: number;\n    newContext?: CommandContext;\n    node: CommandNode;\n}\n\nfunction parseAgainstNode(\n    reader: StringReader,\n    node: CommandNode,\n    path: CommandNodePath,\n    data: CommmandData,\n    context: CommandContext\n): ReturnedInfo<NodeParseSuccess> {\n    const parser = getParser(node);\n    const helper = new ReturnHelper(false);\n    if (!!parser) {\n        const result = parser.parse(\n            reader,\n            createParserInfo(node, data, path, context, false)\n        );\n        if (!!result) {\n            if (helper.merge(result)) {\n                const newContext = { ...context, ...result.data };\n                return helper.succeed<NodeParseSuccess>({\n                    max: reader.cursor,\n                    newContext,\n                    node\n                });\n            } else {\n                return helper.fail();\n            }\n        } else {\n            return helper.succeed<NodeParseSuccess>({\n                max: reader.cursor,\n                node\n            });\n        }\n    } else {\n        return helper.fail();\n    }\n}\n\nexport function parseLines(\n    document: FunctionInfo,\n    data: DataManager,\n    emitter: EventEmitter,\n    documentUri: string,\n    lines: number[]\n): void {\n    for (const lineNo of lines) {\n        const line = document.lines[lineNo];\n        const packsInfo = data.getPackFolderData(document.pack_segments);\n        let localData: LocalData | undefined;\n        if (packsInfo && document.pack_segments) {\n            localData = {\n                ...packsInfo,\n                current: packsInfo.packnamesmap[document.pack_segments.pack]\n            };\n        }\n        const result = parseCommand(line.text, data.globalData, localData);\n        line.parseInfo = result ? result : false;\n        line.actions = undefined;\n        line.nodes = undefined;\n        emitter.emit(`${documentUri}:${lineNo}`);\n    }\n}\n\nexport function parseDocument(\n    document: FunctionInfo,\n    data: DataManager,\n    emitter: EventEmitter,\n    documentUri: string\n): void {\n    const lines = document.lines.map((_, i) => i);\n    parseLines(document, data, emitter, documentUri, lines);\n}\n","import { EventEmitter } from \"events\";\nimport { promisify } from \"util\";\nimport { shim } from \"util.promisify\";\nshim();\nimport {\n    CompletionList,\n    createConnection,\n    Diagnostic,\n    DidChangeWatchedFilesNotification,\n    IPCMessageReader,\n    IPCMessageWriter,\n    Location,\n    Position,\n    TextDocumentPositionParams,\n    TextDocumentSyncKind\n} from \"vscode-languageserver/lib/main\";\nimport Uri from \"vscode-uri\";\n\nimport {\n    definitionProvider,\n    getWorkspaceSymbols,\n    hoverProvider,\n    signatureHelpProvider\n} from \"./actions\";\nimport { computeCompletions } from \"./completions\";\nimport { readSecurity } from \"./data/cache\";\nimport { DataManager } from \"./data/manager\";\nimport {\n    actOnSecurity,\n    commandErrorToDiagnostic,\n    isSuccessful,\n    parseDataPath,\n    runChanges,\n    securityIssues,\n    setup_logging,\n    splitLines\n} from \"./misc-functions\";\nimport { mergeDeep } from \"./misc-functions/third_party/merge-deep\";\nimport { parseDocument, parseLines } from \"./parse\";\nimport { blankRange } from \"./test/blanks\";\nimport {\n    CommandLine,\n    FunctionInfo,\n    MiscInfo,\n    WorkspaceSecurity\n} from \"./types\";\n\nconst connection = createConnection(\n    new IPCMessageReader(process),\n    new IPCMessageWriter(process)\n);\nconnection.listen();\n\n//#region Data Storage\nlet manager: DataManager;\nconst documents: Map<string, FunctionInfo> = new Map();\nconst fileErrors = new Map<string, { [group: string]: string }>();\n// Avoids race condition between parsing after change and getting completions\nconst parseCompletionEvents = new EventEmitter();\nlet security: Promise<WorkspaceSecurity>;\n\nlet started = false;\nlet starting = false;\n//#endregion\n\n// For Server Startup logic, see: https://github.com/Microsoft/language-server-protocol/issues/246\nconnection.onInitialize(() => {\n    setup_logging(connection);\n\n    manager = new DataManager();\n    return {\n        capabilities: {\n            completionProvider: {\n                resolveProvider: false\n            },\n            definitionProvider: true,\n            hoverProvider: true,\n            signatureHelpProvider: { triggerCharacters: [\" \"] },\n            textDocumentSync: {\n                change: TextDocumentSyncKind.Incremental,\n                openClose: true\n            },\n            workspaceSymbolProvider: true\n        }\n    };\n});\n\n// Handles the starting of the server\nconnection.onDidChangeConfiguration(async params => {\n    let startinglocal = false;\n    if (!starting) {\n        starting = true;\n        startinglocal = true;\n        global.mcLangSettings = {} as McFunctionSettings;\n        security = readSecurity();\n    }\n    await ensureSecure(params.settings);\n    const reparseall = () => {\n        for (const [uri, doc] of documents.entries()) {\n            loadData(uri);\n            parseDocument(doc, manager, parseCompletionEvents, uri);\n            sendDiagnostics(uri);\n        }\n    };\n    if (startinglocal) {\n        const cacheread = await manager.readCache();\n        if (cacheread) {\n            started = true;\n            reparseall();\n        }\n        const getDataResult = await manager.loadGlobalData();\n        if (getDataResult === true) {\n            started = true;\n            reparseall();\n        } else if (!cacheread) {\n            connection.sendNotification(\"mcfunction/shutdown\", getDataResult);\n            return;\n        }\n    }\n});\n\nasync function ensureSecure(settings: {\n    mcfunction: Partial<McFunctionSettings>;\n}): Promise<void> {\n    const secure = await security;\n    const newsettings = mergeDeep(\n        {},\n        global.mcLangSettings,\n        settings.mcfunction\n    ) as McFunctionSettings;\n\n    try {\n        const issues = securityIssues(newsettings, secure);\n        if (issues.length > 0) {\n            // Failed security checkup challenge\n            const safeToContinue = await actOnSecurity(\n                issues,\n                connection,\n                secure\n            );\n            if (!safeToContinue) {\n                connection.sendNotification(\n                    \"mcfunction/shutdown\",\n                    `Shutting down because of insecure settings: '${issues.join(\n                        \"', '\"\n                    )}'`\n                );\n                return;\n            }\n        }\n    } catch (error) {\n        connection.sendNotification(\n            \"mcfunction/shutdown\",\n            `Shutting down because of insecure settings: '${error}'`\n        );\n        return;\n    }\n    global.mcLangSettings = newsettings;\n}\n\nfunction loadData(uri: string): void {\n    const doc = documents.get(uri);\n    if (doc && doc.pack_segments) {\n        const segments = doc.pack_segments;\n        manager\n            .readPackFolderData(segments.packsFolder)\n            .then(first => {\n                if (isSuccessful(first)) {\n                    connection.client.register(\n                        DidChangeWatchedFilesNotification.type,\n                        {\n                            watchers: [\n                                {\n                                    globPattern: `${segments.packsFolder}/**/*`\n                                }\n                            ]\n                        }\n                    );\n                }\n                parseDocument(doc, manager, parseCompletionEvents, uri);\n                sendDiagnostics(uri);\n                handleMiscInfo(first.misc);\n            })\n            .catch(e => {\n                mcLangLog(`Getting pack folder data failed for reason: '${e}'`);\n            });\n    }\n}\n\nconnection.onDidOpenTextDocument(params => {\n    const uri = params.textDocument.uri;\n    const uriClass = Uri.parse(uri);\n    const parsethis = () => {\n        // Sanity check\n        if (started && documents.has(uri)) {\n            parseDocument(\n                documents.get(uri) as FunctionInfo,\n                manager,\n                parseCompletionEvents,\n                uri\n            );\n            sendDiagnostics(uri);\n        }\n    };\n    if (uriClass.scheme === \"file\") {\n        const fsPath = uriClass.fsPath;\n        const dataPackSegments = parseDataPath(fsPath);\n        documents.set(uri, {\n            lines: splitLines(params.textDocument.text),\n            pack_segments: dataPackSegments\n        });\n        if (started) {\n            loadData(uri);\n        }\n        parsethis();\n    } else {\n        documents.set(uri, {\n            lines: splitLines(params.textDocument.text),\n            pack_segments: undefined\n        });\n    }\n    parsethis();\n});\n\nconnection.onDidChangeTextDocument(params => {\n    const uri = params.textDocument.uri;\n    const document = documents.get(uri) as FunctionInfo;\n    const changedlines = runChanges(params, document);\n    if (started) {\n        parseLines(document, manager, parseCompletionEvents, uri, changedlines);\n        sendDiagnostics(uri);\n    }\n});\n\nfunction sendDiagnostics(uri: string): void {\n    const doc = documents.get(uri) as FunctionInfo;\n    const diagnostics: Diagnostic[] = [];\n    for (let line = 0; line < doc.lines.length; line++) {\n        const lineContent = doc.lines[line];\n        if (!!lineContent.parseInfo && !!lineContent.parseInfo.errors) {\n            diagnostics.push(\n                ...lineContent.parseInfo.errors.map(error =>\n                    commandErrorToDiagnostic(error, line)\n                )\n            );\n        }\n    }\n    connection.sendDiagnostics({ uri, diagnostics });\n}\n\nconnection.onDidCloseTextDocument(params => {\n    // Clear diagnostics - might not be needed\n    connection.sendDiagnostics({\n        diagnostics: [],\n        uri: params.textDocument.uri\n    });\n    documents.delete(params.textDocument.uri);\n});\n\nconnection.onDidChangeWatchedFiles(async e => {\n    const result = await manager.handleChanges(e);\n    handleMiscInfo(result.misc);\n});\n\nfunction handleMiscInfo(miscInfos: MiscInfo[]): void {\n    const changedFileErrors = new Set<string>();\n    for (const misc of miscInfos) {\n        if (misc.kind === \"FileError\") {\n            changedFileErrors.add(misc.filePath);\n            const value = fileErrors.get(misc.filePath);\n            if (value) {\n                fileErrors.set(misc.filePath, {\n                    ...value,\n                    [misc.group]: misc.message\n                });\n            } else {\n                fileErrors.set(misc.filePath, {\n                    group: misc.message\n                });\n            }\n        }\n        if (misc.kind === \"ClearError\") {\n            changedFileErrors.add(misc.filePath);\n            const group = misc.group;\n            if (group) {\n                const value = fileErrors.get(misc.filePath);\n                if (value) {\n                    const { [group]: _, ...rest } = value;\n                    fileErrors.set(misc.filePath, { ...rest });\n                }\n            } else {\n                fileErrors.delete(misc.filePath);\n            }\n        }\n    }\n    for (const uri of changedFileErrors) {\n        const value = fileErrors.get(uri);\n        if (value) {\n            const diagnostics: Diagnostic[] = [];\n            for (const group of Object.keys(value)) {\n                diagnostics.push({\n                    message: value[group],\n                    range: blankRange\n                });\n            }\n            connection.sendDiagnostics({ uri, diagnostics });\n        }\n    }\n}\n\nconnection.onCompletion(params => {\n    const doc = documents.get(params.textDocument.uri) as FunctionInfo;\n    const line = doc.lines[params.position.line];\n    const computeCompletionsLocal = () =>\n        computeCompletions(\n            params.position.line,\n            params.position.character,\n            doc,\n            manager\n        );\n    if (!started) {\n        return [];\n    }\n    if (line.hasOwnProperty(\"parseInfo\")) {\n        return computeCompletionsLocal();\n    } else {\n        return promisify(cb =>\n            parseCompletionEvents.once(\n                `${params.textDocument.uri}:${params.position.line}`,\n                cb\n            )\n        )().then<CompletionList>(computeCompletionsLocal);\n    }\n});\n\n// #connection.onCodeAction(); // Research what this means\nconnection.onDefinition(prepare<Location[]>(definitionProvider, []));\n// #connection.onDocumentHighlight();\n// #connection.onDocumentSymbol(); // This is for sections - there are none in mcfunctions\nconnection.onWorkspaceSymbol(query =>\n    getWorkspaceSymbols(manager, query.query)\n);\nconnection.onHover(prepare(hoverProvider, undefined));\nconnection.onSignatureHelp(prepare(signatureHelpProvider));\n\nfunction prepare<T>(\n    func: (\n        line: CommandLine,\n        loc: Position,\n        document: FunctionInfo,\n        manager: DataManager\n    ) => T,\n    fallback?: T\n): (params: TextDocumentPositionParams) => T | undefined {\n    return params => {\n        if (started) {\n            const doc = documents.get(params.textDocument.uri);\n            if (doc) {\n                const docLine = doc.lines[params.position.line];\n                return func(docLine, params.position, doc, manager);\n            }\n        }\n        return fallback;\n    };\n}\n"]}