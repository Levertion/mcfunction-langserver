{"version":3,"sources":["misc-functions\\context.ts","misc-functions\\creators.ts","consts.ts","misc-functions\\namespace.ts","misc-functions\\group-resources.ts","misc-functions\\file-errors.ts","brigadier\\errors.ts","types.ts","misc-functions\\return-helper.ts","misc-functions\\promisified-fs.ts","misc-functions\\third_party\\typed-keys.ts","misc-functions\\datapack-folder.ts","misc-functions\\translation.ts","misc-functions\\lsp-conversions.ts","misc-functions\\node-tree.ts","data\\cache.ts","misc-functions\\security.ts","misc-functions\\setup.ts","misc-functions\\parsing\\namespace.ts","misc-functions\\parsing\\nmsp-tag.ts","misc-functions\\index.ts","brigadier\\string-reader.ts","parsers\\brigadier\\bool.ts","parsers\\brigadier\\string.ts","parsers\\brigadier\\integer.ts","parsers\\brigadier\\float.ts","parsers\\brigadier\\index.ts","parsers\\literal.ts","parsers\\minecraft\\nbt\\util\\doc-walker-util.ts","parsers\\minecraft\\nbt\\tag\\nbt-tag.ts","parsers\\minecraft\\nbt\\tag\\string-tag.ts","parsers\\minecraft\\nbt\\doc-walker-func.ts","parsers\\minecraft\\nbt\\util\\nbt-util.ts","parsers\\minecraft\\nbt\\tag\\byte-tag.ts","parsers\\minecraft\\nbt\\tag\\byte-array-tag.ts","parsers\\minecraft\\nbt\\tag\\double-tag.ts","parsers\\minecraft\\nbt\\tag\\float-tag.ts","parsers\\minecraft\\nbt\\tag\\int-tag.ts","parsers\\minecraft\\nbt\\tag\\int-array-tag.ts","parsers\\minecraft\\nbt\\tag\\list-tag.ts","parsers\\minecraft\\nbt\\tag\\long-tag.ts","parsers\\minecraft\\nbt\\tag\\long-array-tag.ts","parsers\\minecraft\\nbt\\tag\\short-tag.ts","parsers\\minecraft\\nbt\\tag-parser.ts","parsers\\minecraft\\nbt\\tag\\compound-tag.ts","parsers\\minecraft\\nbt\\util\\array-reader.ts","parsers\\minecraft\\nbt\\doc-walker.ts","parsers\\minecraft\\nbt\\nbt.ts","parsers\\minecraft\\block.ts","parsers\\minecraft\\coordinates.ts","parsers\\minecraft\\item.ts","colors.ts","data\\lists\\item-slot.ts","data\\lists\\scoreboard-slot.ts","data\\lists\\statics.ts","parsers\\minecraft\\lists.ts","parsers\\minecraft\\message.ts","parsers\\minecraft\\namespace-list.ts","parsers\\minecraft\\resources.ts","parsers\\minecraft\\scoreboard.ts","parsers\\minecraft\\nbt-path.ts","parsers\\get-parser.ts","completions.ts","data\\extractor\\mapfunctions.ts","data\\nbt\\buffer-stream.ts","data\\nbt\\parser.ts","data\\nbt\\nbt-cache.ts","data\\datapack-resources.ts","data\\extractor\\collect-data.ts","data\\extractor\\download.ts","data\\extractor\\extract-data.ts","data\\extractor\\index.ts","parsers\\minecraft\\nbt\\doc-fs.ts","data\\noncached.ts","data\\manager.ts","misc-functions\\third_party\\merge-deep.ts","parse.ts","index.ts"],"names":[],"mappings":"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","file":"index.map","sourceRoot":"..\\src","sourcesContent":["import { CommandNodePath } from \"../data/types\";\r\n\r\nexport interface ContextPath<T> {\r\n    data: T;\r\n    path: CommandNodePath;\r\n}\r\n\r\nexport function resolvePaths<T>(\r\n    paths: Array<ContextPath<T>>,\r\n    argPath: CommandNodePath\r\n): T | undefined {\r\n    for (const path of paths) {\r\n        if (stringArrayEqual(argPath, path.path)) {\r\n            return path.data;\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\n\r\nfunction stringArrayEqual(arr1: string[], arr2: string[]): boolean {\r\n    return arr1.length === arr2.length && arr1.every((v, i) => v === arr2[i]);\r\n}\r\n\r\nexport function startPaths<T>(\r\n    paths: Array<ContextPath<T>>,\r\n    argpath: CommandNodePath\r\n): T | undefined {\r\n    let best: [number, T?] = [0, undefined];\r\n    for (const option of paths) {\r\n        if (\r\n            option.path.length > best[0] &&\r\n            option.path.length <= argpath.length &&\r\n            option.path.every((v, i) => v === argpath[i])\r\n        ) {\r\n            best = [option.path.length, option.data];\r\n        }\r\n    }\r\n    return best[1];\r\n}\r\n","import { CommandNode, CommandNodePath } from \"../data/types\";\r\nimport {\r\n    CommandContext,\r\n    CommandLine,\r\n    CommmandData,\r\n    ParserInfo\r\n} from \"../types\";\r\n\r\n/**\r\n * Build parser info from the data required\r\n */\r\nexport function createParserInfo(\r\n    node: CommandNode,\r\n    data: CommmandData,\r\n    path: CommandNodePath,\r\n    context: CommandContext,\r\n    suggesting: boolean\r\n): ParserInfo {\r\n    const result: ParserInfo = {\r\n        context,\r\n        data,\r\n        node_properties: node.properties || {},\r\n        path,\r\n        suggesting\r\n    };\r\n    return result;\r\n}\r\n\r\n/**\r\n * Convert a string into CommandLines based on newline characters\r\n */\r\nexport function splitLines(text: string): CommandLine[] {\r\n    return createCommandLines(text.split(/\\r?\\n/));\r\n}\r\n\r\n/**\r\n * Convert the given string array into a blank CommandLine Array\r\n */\r\nexport function createCommandLines(lines: string[]): CommandLine[] {\r\n    const result: CommandLine[] = [];\r\n    for (const line of lines) {\r\n        result.push({ text: line });\r\n    }\r\n    return result;\r\n}\r\n","export const COMMENT_START = \"#\";\r\nexport const SPACE = \" \";\r\n\r\n// Namespaces\r\nexport const DEFAULT_NAMESPACE = \"minecraft\";\r\nexport const NAMESPACE = \":\";\r\nexport const DATAFOLDER = \"data\";\r\nexport const SLASH = \"/\";\r\nexport const SLASHREGEX = /\\//g;\r\nexport const SLASHREPLACEREGEX = /\\\\/g;\r\nexport const MCMETAFILE = \"pack.mcmeta\";\r\n\r\n// Blocks\r\nexport const TAG_START = \"#\";\r\n","import { DEFAULT_NAMESPACE, NAMESPACE } from \"../consts\";\r\nimport { NamespacedName } from \"../data/types\";\r\n\r\nexport function namespacesEqual(\r\n    first: NamespacedName,\r\n    second: NamespacedName\r\n): boolean {\r\n    return namesEqual(first, second) && first.path === second.path;\r\n}\r\n\r\nexport function namesEqual(\r\n    first: NamespacedName,\r\n    second: NamespacedName\r\n): boolean {\r\n    return (\r\n        first.namespace === second.namespace ||\r\n        (isNamespaceDefault(first) && isNamespaceDefault(second))\r\n    );\r\n}\r\n\r\nexport function isNamespaceDefault(name: NamespacedName): boolean {\r\n    return name.namespace === undefined || name.namespace === DEFAULT_NAMESPACE;\r\n}\r\n\r\nexport function stringifyNamespace(namespace: NamespacedName): string {\r\n    return (\r\n        (namespace.namespace ? namespace.namespace : DEFAULT_NAMESPACE) +\r\n        NAMESPACE +\r\n        namespace.path\r\n    );\r\n}\r\n\r\nexport function convertToNamespace(\r\n    input: string,\r\n    splitChar: string = NAMESPACE\r\n): NamespacedName {\r\n    const index = input.indexOf(splitChar);\r\n    if (index >= 0) {\r\n        const pathContents = input.substring(\r\n            index + splitChar.length,\r\n            input.length\r\n        );\r\n        // Path contents should not have a : in the contents, however this is to be checked higher up.\r\n        // This simplifies using the parsed result when parsing options\r\n\r\n        // Related: https://bugs.mojang.com/browse/MC-91245 (Fixed)\r\n        if (index >= 1) {\r\n            return { namespace: input.substring(0, index), path: pathContents };\r\n        } else {\r\n            return { path: pathContents };\r\n        }\r\n    } else {\r\n        return { path: input };\r\n    }\r\n}\r\n","import {\r\n    GlobalData,\r\n    MinecraftResource,\r\n    NamespacedName,\r\n    Resources,\r\n    WorldInfo\r\n} from \"../data/types\";\r\nimport { CommmandData } from \"../types\";\r\nimport { namespacesEqual } from \"./namespace\";\r\n\r\nexport function getResourcesofType<\r\n    T extends MinecraftResource = MinecraftResource\r\n>(resources: CommmandData, type: keyof Resources): T[] {\r\n    return getResourcesSplit<T>(\r\n        type,\r\n        resources.globalData,\r\n        resources.localData\r\n    );\r\n}\r\n\r\nexport function getResourcesSplit<\r\n    T extends MinecraftResource = MinecraftResource\r\n>(type: keyof Resources, globalData: GlobalData, packsInfo?: WorldInfo): T[] {\r\n    const results: MinecraftResource[] = [];\r\n    const globalResources = globalData.resources[type];\r\n    if (!!globalResources) {\r\n        results.push(...globalResources);\r\n    }\r\n    if (packsInfo) {\r\n        for (const packId in packsInfo.packs) {\r\n            if (packsInfo.packs.hasOwnProperty(packId)) {\r\n                const pack = packsInfo.packs[packId];\r\n                if (pack.data.hasOwnProperty(type)) {\r\n                    const data = pack.data[type];\r\n                    if (!!data) {\r\n                        results.push(...data);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return results as T[];\r\n}\r\n\r\nexport function getMatching<T extends NamespacedName>(\r\n    resources: T[],\r\n    value: T\r\n): T[] {\r\n    const results: T[] = [];\r\n    for (const resource of resources) {\r\n        if (namespacesEqual(resource, value)) {\r\n            results.push(resource);\r\n        }\r\n    }\r\n    return results;\r\n}\r\n","import { MiscInfo } from \"../types\";\r\n\r\nexport function createExtensionFileError(\r\n    filePath: string,\r\n    expected: string,\r\n    actual: string\r\n): MiscInfo {\r\n    return {\r\n        filePath,\r\n        group: \"extension\",\r\n        kind: \"FileError\",\r\n        message: `File has incorrect extension: Expected ${expected}, got ${actual}.`\r\n    };\r\n}\r\n\r\nexport function createJSONFileError(filePath: string, error: any): MiscInfo {\r\n    return {\r\n        filePath,\r\n        group: \"json\",\r\n        kind: \"FileError\",\r\n        message: `JSON parsing failed: '${error}'`\r\n    };\r\n}\r\n\r\nexport function createFileClear(filePath: string, group?: string): MiscInfo {\r\n    return { kind: \"ClearError\", filePath, group };\r\n}\r\n","import { DiagnosticSeverity } from \"vscode-languageserver/lib/main\";\r\nimport { MCFormat } from \"../misc-functions\";\r\nimport { LineRange } from \"../types\";\r\n\r\n/**\r\n * A blank command error\r\n */\r\nexport interface BlankCommandError {\r\n    /**\r\n     * The code of this error, usable for translation?\r\n     */\r\n    code: string;\r\n    /**\r\n     * The severity of this error.\r\n     */\r\n    severity: DiagnosticSeverity;\r\n    /**\r\n     * The substitutions to insert into the error text.\r\n     */\r\n    substitutions?: string[];\r\n    /**\r\n     * The cached text of this error.\r\n     */\r\n    text: string;\r\n}\r\n\r\n/**\r\n * An error inside a command.\r\n */\r\nexport interface CommandError extends BlankCommandError {\r\n    /**\r\n     * The range of this error.\r\n     */\r\n    range: LineRange;\r\n}\r\n\r\n/**\r\n * Helper class to create command errors\r\n */\r\nexport class CommandErrorBuilder {\r\n    private readonly code: string;\r\n    private readonly default: string;\r\n    private readonly severity: DiagnosticSeverity;\r\n\r\n    public constructor(\r\n        code: string,\r\n        explanation: string,\r\n        severity: DiagnosticSeverity = DiagnosticSeverity.Error\r\n    ) {\r\n        this.code = code;\r\n        this.default = explanation;\r\n        this.severity = severity;\r\n    }\r\n\r\n    public create(\r\n        start: number,\r\n        end: number,\r\n        ...substitutions: string[]\r\n    ): CommandError {\r\n        const diagnosis: CommandError = Object.assign(\r\n            this.createBlank(...substitutions),\r\n            { range: { start, end } }\r\n        );\r\n        return diagnosis;\r\n    }\r\n\r\n    public createBlank(...substitutions: string[]): BlankCommandError {\r\n        return {\r\n            code: this.code,\r\n            severity: this.severity,\r\n            substitutions,\r\n            text: MCFormat(this.default, ...substitutions)\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * Transform `err` into a real command error.\r\n * MODIFIES `err`\r\n * @param err The error to transform\r\n * @param start The starting location in the line of the error\r\n * @param end The end position\r\n */\r\nexport function fillBlankError(\r\n    err: BlankCommandError,\r\n    start: number,\r\n    end: number\r\n): CommandError {\r\n    return { ...err, range: { start, end } };\r\n}\r\n","import { DataInterval, Interval, IntervalTree } from \"node-interval-tree\";\r\nimport {\r\n    CompletionItemKind,\r\n    MarkedString\r\n} from \"vscode-languageserver/lib/main\";\r\nimport { BlankCommandError, CommandError } from \"./brigadier/errors\";\r\nimport { StringReader } from \"./brigadier/string-reader\";\r\nimport { CommandNodePath, GlobalData, LocalData } from \"./data/types\";\r\nimport { PackLocationSegments } from \"./misc-functions\";\r\n\r\n//#region Document\r\nexport interface FunctionInfo {\r\n    lines: CommandLine[];\r\n    /**\r\n     * The filesystem path to the `datapacks` folder this is part of - NOT the folder of the single datapack\r\n     */\r\n    pack_segments: PackLocationSegments | undefined;\r\n}\r\n\r\nexport interface WorkspaceSecurity {\r\n    // CustomParsers?: boolean;\r\n    JarPath?: boolean;\r\n    JavaPath?: boolean;\r\n}\r\n\r\nexport interface CommandLine {\r\n    /**\r\n     * A cache of the tree of actions\r\n     */\r\n    actions?: IntervalTree<SubAction>;\r\n    nodes?: IntervalTree<ParseNode>;\r\n    parseInfo?: StoredParseResult | false;\r\n    text: string;\r\n}\r\n//#endregion\r\n\r\n//#region Interaction with parsers\r\nexport interface ParserInfo {\r\n    /**\r\n     * The immutable context\r\n     */\r\n    context: CommandContext;\r\n    data: CommmandData;\r\n    node_properties: Dictionary<any>;\r\n    path: CommandNodePath; // Will be > 0\r\n    /**\r\n     * When suggesting, the end of the reader's string will be the cursor position\r\n     */\r\n    suggesting: boolean;\r\n}\r\n\r\nexport interface CommmandData {\r\n    globalData: GlobalData;\r\n    /**\r\n     * Data from datapacks\r\n     */\r\n    localData?: LocalData;\r\n}\r\n\r\nexport interface Suggestion {\r\n    description?: string;\r\n    kind?: CompletionItemKind;\r\n    /**\r\n     * The start from where value should be replaced. 0 indexed character gaps.\r\n     * E.g. `@e[na` with the suggestion `{value:\"name=\",start:3}`\r\n     * would make `@e[name=` when accepted.\r\n     */\r\n    start: number;\r\n    text: string;\r\n}\r\n\r\nexport type SuggestResult = Suggestion | string;\r\n\r\n/**\r\n * A change to the shared context\r\n */\r\nexport type ContextChange = Partial<CommandContext> | undefined;\r\n\r\nexport interface CommandContext {\r\n    /**\r\n     * Whether the executor is definitely a player.\r\n     * (Currently unused)\r\n     */\r\n    isPlayer?: boolean;\r\n    [key: string]: any;\r\n}\r\n\r\nexport interface Parser {\r\n    /**\r\n     * The default suggestion kind for suggestions from this parser\r\n     */\r\n    kind?: CompletionItemKind;\r\n    /**\r\n     * Parse the argument as described in NodeProperties against this parser in the reader.\r\n     * Gets both suggestions and success\r\n     */\r\n    parse(\r\n        reader: StringReader,\r\n        properties: ParserInfo\r\n    ): ReturnedInfo<ContextChange | undefined>;\r\n}\r\n\r\n//#endregion\r\n//#region ParsingData\r\nexport interface ParseNode extends Interval {\r\n    context: CommandContext;\r\n    final: boolean;\r\n    path: CommandNodePath;\r\n}\r\n\r\nexport interface StoredParseResult {\r\n    actions: SubAction[];\r\n    errors: CommandError[];\r\n    nodes: ParseNode[];\r\n}\r\n\r\ninterface SubActionBase<U extends string, T> extends DataInterval<T> {\r\n    type: U;\r\n}\r\nexport type SubAction =\r\n    // See https://github.com/Microsoft/language-server-protocol/issues/518.\r\n    | SubActionBase<\"hover\", MarkedString>\r\n    | SubActionBase<\"format\", string>\r\n    | SubActionBase<\"source\", string>;\r\n//  | SubActionBase<\"highlight\", HighlightScope>;\r\n//  | SubActionBase<\"rename\", RenameRequest>;\r\n//#endregion\r\nexport type Success = true;\r\nexport const success: Success = true;\r\n\r\nexport const failure: Failure = false;\r\nexport type Failure = false;\r\n\r\n//#region ReturnData\r\nexport interface ReturnData<ErrorKind extends BCE = CE> {\r\n    actions: SubAction[];\r\n    errors: ErrorKind[];\r\n    /**\r\n     * Points not related to a specific line being parsed.\r\n     * This includes errors inside a file for example.\r\n     */\r\n    misc: MiscInfo[];\r\n    suggestions: SuggestResult[];\r\n}\r\n\r\ntype MiscInfoBase<kind extends string, value> = value & {\r\n    kind: kind;\r\n};\r\n\r\nexport type MiscInfo =\r\n    | MiscInfoBase<\"FileError\", FileError>\r\n    | MiscInfoBase<\"ClearError\", ClearFileError>;\r\n\r\ninterface FileError {\r\n    filePath: string;\r\n    group: string;\r\n    message: string;\r\n}\r\n\r\ninterface ClearFileError {\r\n    filePath: string;\r\n    group?: string;\r\n}\r\n\r\n/**\r\n * A general return type which can either succeed or fail, bringing other data\r\n */\r\nexport type ReturnedInfo<T, ErrorKind extends BCE = CE, E = undefined> =\r\n    | ReturnSuccess<T, ErrorKind>\r\n    | ReturnFailure<E, ErrorKind>;\r\n\r\nexport interface ReturnFailure<K = undefined, ErrorKind extends BCE = CE>\r\n    extends ReturnData<ErrorKind> {\r\n    data: K;\r\n    kind: Failure;\r\n}\r\n\r\nexport interface ReturnSuccess<T, ErrorKind extends BCE = CE>\r\n    extends ReturnData<ErrorKind> {\r\n    data: T;\r\n    kind: Success;\r\n}\r\n//#endregion\r\n// Helper types to lower the amount of repetition of the names\r\nexport type BCE = BlankCommandError;\r\nexport type CE = CommandError;\r\n\r\n//#region Misc types\r\n\r\nexport interface LineRange {\r\n    end: number;\r\n    start: number;\r\n}\r\n\r\n//#endregion\r\n","import {\r\n    BlankCommandError,\r\n    CommandError,\r\n    fillBlankError\r\n} from \"../brigadier/errors\";\r\nimport {\r\n    BCE,\r\n    CE,\r\n    Failure,\r\n    failure,\r\n    MiscInfo,\r\n    ParserInfo,\r\n    ReturnData,\r\n    ReturnedInfo,\r\n    ReturnFailure,\r\n    ReturnSuccess,\r\n    SubAction,\r\n    success,\r\n    Success,\r\n    Suggestion,\r\n    SuggestResult\r\n} from \"../types\";\r\n\r\n/**\r\n * Create an instance of the common return type\r\n */\r\nfunction createReturn<ErrorKind extends BCE = CE>(): ReturnData<ErrorKind> {\r\n    return { actions: [], errors: [], suggestions: [], misc: [] };\r\n}\r\n\r\n/**\r\n * Test if `input` is successful\r\n * @param input The info to test\r\n */\r\nexport function isSuccessful<T, E extends BCE = CE>(\r\n    input: ReturnedInfo<T, E, any>\r\n): input is ReturnSuccess<T, E> {\r\n    return input.kind === success;\r\n}\r\n\r\n/**\r\n * Fill the blank errors in data with 'real' errors\r\n * MODIFIES `data`\r\n * @param data The data to modify\r\n * @param start The starting position of the area the errors should cover\r\n * @param end The end position\r\n */\r\nexport function fillBlanks<T>(\r\n    data: ReturnedInfo<T, BCE>,\r\n    start: number,\r\n    end: number\r\n): ReturnedInfo<T>;\r\nexport function fillBlanks(\r\n    data: ReturnData<BCE>,\r\n    start: number,\r\n    end: number\r\n): ReturnData {\r\n    const errors = [];\r\n    for (const err of data.errors) {\r\n        errors.push(fillBlankError(err, start, end));\r\n    }\r\n    return { ...data, errors };\r\n}\r\n\r\nexport class ReturnHelper<Errorkind extends BlankCommandError = CommandError> {\r\n    private readonly data: ReturnData<Errorkind> = createReturn<Errorkind>();\r\n    private readonly suggesting?: boolean;\r\n\r\n    public constructor(suggesting?: ParserInfo | boolean) {\r\n        if (typeof suggesting !== \"undefined\") {\r\n            if (typeof suggesting === \"boolean\") {\r\n                this.suggesting = suggesting;\r\n                return;\r\n            }\r\n            this.suggesting = suggesting.suggesting;\r\n        }\r\n    }\r\n\r\n    public addActions(...actions: SubAction[]): this {\r\n        if (this.suggesting === undefined || !this.suggesting) {\r\n            this.data.actions.push(...actions);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public addErrors(...errs: Errorkind[]): this {\r\n        if (this.suggesting === undefined || !this.suggesting) {\r\n            this.data.errors.push(...errs);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public addFileErrorIfFalse(\r\n        option: boolean,\r\n        filePath: string,\r\n        group: string,\r\n        message: string\r\n    ): option is true {\r\n        if (!option) {\r\n            this.addMisc({ group, message, filePath, kind: \"FileError\" });\r\n        } else {\r\n            this.addMisc({ group, filePath, kind: \"ClearError\" });\r\n        }\r\n        return option;\r\n    }\r\n    public addMisc(...others: MiscInfo[]): this {\r\n        if (this.suggesting === undefined || !this.suggesting) {\r\n            this.data.misc.push(...others);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public addSuggestion(\r\n        start: number,\r\n        text: string,\r\n        kind?: Suggestion[\"kind\"],\r\n        description?: string\r\n    ): this {\r\n        if (this.suggesting === undefined || this.suggesting) {\r\n            this.addSuggestions({\r\n                description,\r\n                kind,\r\n                start,\r\n                text\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n    public addSuggestions(...suggestions: SuggestResult[]): this {\r\n        if (this.suggesting === undefined || this.suggesting) {\r\n            this.data.suggestions.push(...suggestions);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public fail(err?: Errorkind): ReturnFailure<undefined, Errorkind> {\r\n        if (!!err && !this.suggesting) {\r\n            this.addErrors(err);\r\n        }\r\n        return {\r\n            ...this.getShared(),\r\n            kind: failure as Failure\r\n        } as ReturnFailure<undefined, Errorkind>;\r\n    }\r\n\r\n    public failWithData<T>(data: T): ReturnFailure<T, Errorkind> {\r\n        return { ...this.getShared(), data, kind: failure as Failure };\r\n    }\r\n    public getShared(): ReturnData<Errorkind> {\r\n        return this.data;\r\n    }\r\n    public hasErrors(): boolean {\r\n        return this.data.errors.length > 0;\r\n    }\r\n    public merge<T>(\r\n        merge: ReturnedInfo<T, Errorkind, any>,\r\n        suggestOverride?: boolean\r\n    ): merge is ReturnSuccess<T, Errorkind> {\r\n        this.mergeChain(merge, suggestOverride);\r\n        return isSuccessful(merge);\r\n    }\r\n\r\n    public mergeChain(\r\n        merge: ReturnedInfo<any, Errorkind>,\r\n        suggestOverride?: boolean\r\n    ): this {\r\n        let suggest: boolean | undefined;\r\n        if (suggestOverride !== undefined) {\r\n            suggest = suggestOverride;\r\n        } else {\r\n            if (this.suggesting !== undefined) {\r\n                suggest = this.suggesting;\r\n            }\r\n        }\r\n        switch (suggest) {\r\n            case true:\r\n                this.mergeSuggestions(merge);\r\n                break;\r\n            case false:\r\n                this.mergeSafe(merge);\r\n                break;\r\n            default:\r\n                this.mergeSuggestions(merge);\r\n                this.mergeSafe(merge);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    public return<T, E>(\r\n        other: ReturnedInfo<T, Errorkind, E>\r\n    ): ReturnedInfo<T, Errorkind, E> {\r\n        if (this.merge(other)) {\r\n            return this.succeed(other.data);\r\n        } else {\r\n            return this.failWithData(other.data);\r\n        }\r\n    }\r\n\r\n    public succeed<T extends undefined>(\r\n        data?: T\r\n    ): ReturnSuccess<undefined, Errorkind>;\r\n    public succeed<T>(data: T): ReturnSuccess<T, Errorkind>;\r\n    public succeed<T>(data: T): ReturnSuccess<T, Errorkind> {\r\n        return { ...this.getShared(), data, kind: success as Success };\r\n    }\r\n\r\n    private mergeSafe(merge: ReturnData<Errorkind>): void {\r\n        this.addActions(...merge.actions);\r\n        this.addErrors(...merge.errors);\r\n        this.addMisc(...merge.misc);\r\n    }\r\n\r\n    private mergeSuggestions(merge: ReturnData<Errorkind>): void {\r\n        this.addSuggestions(...merge.suggestions);\r\n    }\r\n}\r\n\r\nexport function prepareForParser(\r\n    info: ReturnedInfo<any>,\r\n    suggesting: boolean | ParserInfo\r\n): ReturnedInfo<undefined> {\r\n    const helper = new ReturnHelper(suggesting);\r\n    if (helper.merge(info)) {\r\n        return helper.succeed();\r\n    } else {\r\n        return helper.fail();\r\n    }\r\n}\r\n","import * as fs from \"fs\";\r\nimport * as path from \"path\";\r\nimport { promisify } from \"util\";\r\nimport { ReturnedInfo } from \"../types\";\r\nimport { createJSONFileError } from \"./file-errors\";\r\nimport { ReturnHelper } from \"./return-helper\";\r\n\r\nexport const readFileAsync = promisify(fs.readFile);\r\nexport const saveFileAsync = promisify(fs.writeFile);\r\nexport const mkdirAsync = promisify(fs.mkdir);\r\nexport const readDirAsync = promisify(fs.readdir);\r\nexport const statAsync = promisify(fs.stat);\r\n\r\nexport async function readJSONRaw<T>(filePath: string): Promise<T> {\r\n    const buffer = await readFileAsync(filePath);\r\n    return JSON.parse(buffer.toString());\r\n}\r\n\r\nexport async function writeJSON(filepath: string, o: object): Promise<void> {\r\n    await saveFileAsync(filepath, JSON.stringify(o, undefined, 4));\r\n}\r\n\r\nexport async function readJSON<T>(filePath: string): Promise<ReturnedInfo<T>> {\r\n    const helper = new ReturnHelper();\r\n    let buffer: Buffer;\r\n    try {\r\n        buffer = await readFileAsync(filePath);\r\n    } catch (error) {\r\n        mcLangLog(`File at '${filePath}' not available: ${error}`);\r\n        return helper.fail();\r\n    }\r\n    try {\r\n        const result = JSON.parse(buffer.toString());\r\n        return helper.succeed<T>(result);\r\n    } catch (e) {\r\n        return helper.addMisc(createJSONFileError(filePath, e)).fail();\r\n    }\r\n}\r\n\r\nexport async function walkDir(currentPath: string): Promise<string[]> {\r\n    const subFolders: string[] = [];\r\n    try {\r\n        subFolders.push(...(await readDirAsync(currentPath)));\r\n    } catch (error) {\r\n        return [];\r\n    }\r\n    const promises = subFolders.map(async sub => {\r\n        try {\r\n            const files: string[] = [];\r\n            const subFile = path.join(currentPath, sub);\r\n            if ((await statAsync(subFile)).isDirectory()) {\r\n                files.push(...(await walkDir(subFile)));\r\n            } else {\r\n                files.push(subFile);\r\n            }\r\n            return files;\r\n        } catch (error) {\r\n            return [];\r\n        }\r\n    });\r\n    const results = await Promise.all(promises);\r\n    return ([] as string[]).concat(...results);\r\n}\r\n","/**\r\n * Get the keys of the object in a way friendly to\r\n * the typescript compiler.\r\n * Taken from https://github.com/Microsoft/TypeScript/pull/12253#issuecomment-353494273\r\n * @param o The object to get the keys of.\r\n */\r\nexport function typed_keys<O>(o: O): Array<keyof O> {\r\n    return Object.keys(o) as Array<keyof O>;\r\n}\r\n","import * as defaultPath from \"path\";\r\nimport {\r\n    DATAFOLDER,\r\n    SLASH,\r\n    SLASHREGEX,\r\n    SLASHREPLACEREGEX,\r\n    TAG_START\r\n} from \"../consts\";\r\nimport {\r\n    DataResource,\r\n    GlobalData,\r\n    MinecraftResource,\r\n    NamespacedName,\r\n    Resources,\r\n    Tag,\r\n    WorldInfo\r\n} from \"../data/types\";\r\nimport { ReturnSuccess } from \"../types\";\r\nimport { getMatching, getResourcesSplit } from \"./group-resources\";\r\nimport { convertToNamespace } from \"./namespace\";\r\nimport { readJSON } from \"./promisified-fs\";\r\nimport { ReturnHelper } from \"./return-helper\";\r\nimport { typed_keys } from \"./third_party/typed-keys\";\r\n\r\n/** A minimal path module for use in this file */\r\ntype PathModule = Pick<\r\n    typeof import(\"path\").posix, // N.B. `.posix` is required.\r\n    \"extname\" | \"sep\" | \"format\" | \"isAbsolute\" | \"join\" | \"normalize\" | \"parse\"\r\n>;\r\n\r\nexport interface PackLocationSegments {\r\n    pack: string;\r\n    packsFolder: string;\r\n    rest: string;\r\n}\r\n\r\n/**\r\n * Find the datapacks folder a file is in.\r\n * @param fileLocation The URI of the file\r\n * @param path The path module to use (allows for testing).\r\n */\r\nexport function parseDataPath(\r\n    fileLocation: string,\r\n    path: PathModule = defaultPath\r\n): PackLocationSegments | undefined {\r\n    const parsed = path.parse(path.normalize(fileLocation));\r\n    const dirs = parsed.dir.split(path.sep);\r\n    const packsFolderIndex = dirs.indexOf(\"datapacks\");\r\n    if (packsFolderIndex !== -1) {\r\n        const remainder = dirs.slice(packsFolderIndex + 1);\r\n        if (remainder.length >= 1) {\r\n            let packsFolder = path.join(...dirs.slice(0, packsFolderIndex + 1));\r\n            // Ugly hack because path.join ignores a leading empty dir, leading to the result of\r\n            // `/home/datapacks` going to `home/datapacks`\r\n            if (path.sep === \"/\" && !path.isAbsolute(packsFolder)) {\r\n                packsFolder = path.sep + packsFolder;\r\n            }\r\n            packsFolder = path.format({ dir: packsFolder });\r\n            const rest = path.join(...remainder.slice(1), parsed.base);\r\n            return { packsFolder, pack: remainder[0], rest };\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\n\r\ninterface ResourceInfo<U extends keyof Resources> {\r\n    extension: string;\r\n    path: [U] | string[]; // Custom tuple improves autocomplete mostly.\r\n    mapFunction?(\r\n        value: NonNullable<Resources[U]> extends Array<infer T> ? T : never,\r\n        packroot: string,\r\n        globalData: GlobalData,\r\n        packsInfo?: WorldInfo\r\n    ): Promise<ReturnSuccess<typeof value>>;\r\n}\r\n\r\nexport const resourceTypes: { [T in keyof Resources]-?: ResourceInfo<T> } = {\r\n    advancements: { extension: \".json\", path: [\"advancements\"] },\r\n    block_tags: {\r\n        extension: \".json\",\r\n        mapFunction: async (v, packroot, globalData, packsInfo) =>\r\n            readTag(\r\n                v,\r\n                packroot,\r\n                \"block_tags\",\r\n                getResourcesSplit(\"block_tags\", globalData, packsInfo),\r\n                s => globalData.blocks.hasOwnProperty(s)\r\n            ),\r\n        path: [\"tags\", \"blocks\"]\r\n    },\r\n    function_tags: {\r\n        extension: \".json\",\r\n        mapFunction: async (v, packroot, globalData, packsInfo) => {\r\n            const functions = getResourcesSplit(\r\n                \"functions\",\r\n                globalData,\r\n                packsInfo\r\n            );\r\n            return readTag(\r\n                v,\r\n                packroot,\r\n                \"function_tags\",\r\n                getResourcesSplit(\"function_tags\", globalData, packsInfo),\r\n                s => getMatching(functions, convertToNamespace(s)).length > 0\r\n            );\r\n        },\r\n        path: [\"tags\", \"functions\"]\r\n    },\r\n    functions: { extension: \".mcfunction\", path: [\"functions\"] },\r\n    item_tags: {\r\n        extension: \".json\",\r\n        mapFunction: async (v, packroot, globalData, packsInfo) =>\r\n            readTag(\r\n                v,\r\n                packroot,\r\n                \"item_tags\",\r\n                getResourcesSplit(\"item_tags\", globalData, packsInfo),\r\n                s => globalData.items.indexOf(s) !== -1\r\n            ),\r\n        path: [\"tags\", \"items\"]\r\n    },\r\n    loot_tables: { extension: \".json\", path: [\"loot_tables\"] },\r\n    recipes: { extension: \".json\", path: [\"recipes\"] },\r\n    structures: { extension: \".nbt\", path: [\"structures\"] }\r\n};\r\n\r\ninterface KindNamespace {\r\n    kind: keyof Resources;\r\n    location: NamespacedName & { namespace: string };\r\n}\r\n\r\nexport function getKindAndNamespace(\r\n    rest: string,\r\n    path: PathModule = defaultPath\r\n): KindNamespace | undefined {\r\n    const sections = path.normalize(rest).split(path.sep);\r\n    if (sections[0] === DATAFOLDER && sections.length > 2) {\r\n        // Namespace,data,\r\n        const remainder = sections.splice(2);\r\n        for (const kind of typed_keys(resourceTypes)) {\r\n            const typeInfo = resourceTypes[kind];\r\n            if (\r\n                (typeInfo.path as string[]).every((v, i) => remainder[i] === v)\r\n            ) {\r\n                const namespace = sections[1];\r\n                const further = remainder.slice(typeInfo.path.length);\r\n                if (further.length > 0) {\r\n                    const last = further[further.length - 1];\r\n                    if (path.extname(last) === typeInfo.extension) {\r\n                        const pth = path\r\n                            .join(\r\n                                ...further.slice(0, -1),\r\n                                last.slice(0, -typeInfo.extension.length)\r\n                            )\r\n                            .replace(SLASHREPLACEREGEX, SLASH);\r\n                        return {\r\n                            kind,\r\n                            location: {\r\n                                namespace,\r\n                                path: pth\r\n                            }\r\n                        };\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\n\r\nexport function getPath(\r\n    resource: MinecraftResource,\r\n    packroot: string,\r\n    kind: keyof Resources,\r\n    path: PathModule = defaultPath\r\n): string {\r\n    return path.join(\r\n        packroot,\r\n        DATAFOLDER,\r\n        resource.namespace,\r\n        ...resourceTypes[kind].path,\r\n        resource.path\r\n            .replace(SLASHREGEX, path.sep)\r\n            .concat(resourceTypes[kind].extension)\r\n    );\r\n}\r\n\r\nexport function buildPath(\r\n    resource: MinecraftResource,\r\n    packs: WorldInfo,\r\n    kind: keyof Resources,\r\n    path: PathModule = defaultPath\r\n): string | undefined {\r\n    if (resource.pack) {\r\n        const pack = packs.packs[resource.pack];\r\n        return getPath(\r\n            resource,\r\n            path.join(packs.location, pack.name),\r\n            kind,\r\n            path\r\n        );\r\n    } else {\r\n        return undefined;\r\n    }\r\n}\r\n\r\nasync function readTag(\r\n    resource: MinecraftResource,\r\n    packRoot: string,\r\n    type: keyof Resources,\r\n    options: MinecraftResource[],\r\n    isKnown: (value: string) => boolean\r\n): Promise<ReturnSuccess<DataResource<Tag> | MinecraftResource>> {\r\n    const helper = new ReturnHelper();\r\n    const filePath = getPath(resource, packRoot, type);\r\n    const tag = await readJSON<Tag>(filePath);\r\n    if (helper.merge(tag)) {\r\n        if (\r\n            helper.addFileErrorIfFalse(\r\n                !!tag.data.values,\r\n                filePath,\r\n                \"InvalidTagNoValues\",\r\n                `tag does not have a values key: ${JSON.stringify(tag.data)}`\r\n            )\r\n        ) {\r\n            if (\r\n                helper.addFileErrorIfFalse(\r\n                    Array.isArray(tag.data.values),\r\n                    filePath,\r\n                    \"InvalidTagValuesNotArray\",\r\n                    `tag values is not an array: ${JSON.stringify(\r\n                        tag.data.values\r\n                    )}`\r\n                )\r\n            ) {\r\n                if (\r\n                    helper.addFileErrorIfFalse(\r\n                        // tslint:disable-next-line:strict-type-predicates\r\n                        tag.data.values.every(v => typeof v === \"string\"),\r\n                        filePath,\r\n                        \"InvalidTagValuesNotString\",\r\n                        `tag values contains a non string value: ${JSON.stringify(\r\n                            tag.data.values\r\n                        )}`\r\n                    )\r\n                ) {\r\n                    const seen = new Set<string>();\r\n                    const duplicates = new Set<string>();\r\n                    const unknowns = new Set<string>();\r\n                    for (const value of tag.data.values) {\r\n                        if (seen.has(value)) {\r\n                            duplicates.add(value);\r\n                        }\r\n                        seen.add(value);\r\n                        if (value.startsWith(TAG_START)) {\r\n                            const result = getMatching(\r\n                                options,\r\n                                convertToNamespace(value)\r\n                            );\r\n                            if (result.length === 0) {\r\n                                unknowns.add(value);\r\n                            }\r\n                        } else if (!isKnown(value)) {\r\n                            unknowns.add(value);\r\n                        }\r\n                    }\r\n                    helper.addFileErrorIfFalse(\r\n                        duplicates.size === 0,\r\n                        filePath,\r\n                        \"InvalidTagValuesDuplicates\",\r\n                        `Tag contains duplicate values: \"${[...duplicates].join(\r\n                            '\", \"'\r\n                        )}\"`\r\n                    );\r\n                    helper.addFileErrorIfFalse(\r\n                        unknowns.size === 0,\r\n                        filePath,\r\n                        \"InvalidTagValuesUnknown\",\r\n                        `Tag contains unknown values: \"${[...unknowns].join(\r\n                            '\", \"'\r\n                        )}\"`\r\n                    );\r\n                    return helper.succeed({\r\n                        ...resource,\r\n                        data: tag.data\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return helper.succeed(resource);\r\n}\r\n","import { vsprintf } from \"sprintf-js\";\r\n\r\nexport function shouldTranslate(): boolean {\r\n    return mcLangSettings.translation.lang.toLowerCase() !== \"en-us\";\r\n}\r\n\r\nexport function MCFormat(base: string, ...substitutions: string[]): string {\r\n    return vsprintf(base, substitutions);\r\n}\r\n","import {\r\n    Diagnostic,\r\n    DidChangeTextDocumentParams,\r\n    Range\r\n} from \"vscode-languageserver/lib/main\";\r\nimport { CommandError } from \"../brigadier/errors\";\r\nimport { FunctionInfo } from \"../types\";\r\nimport { splitLines } from \"./creators\";\r\nimport { shouldTranslate } from \"./translation\";\r\n\r\n/**\r\n * Turn a command error into a language server diagnostic\r\n */\r\nexport function commandErrorToDiagnostic(\r\n    error: CommandError,\r\n    line: number\r\n): Diagnostic {\r\n    const range: Range = {\r\n        end: { line, character: error.range.end },\r\n        start: { line, character: error.range.start }\r\n    };\r\n    // Run Translation stuff on the error?\r\n    const text = shouldTranslate()\r\n        ? `'${error.text}': Translation is not yet supported` // Translate(error.code)\r\n        : error.text;\r\n    return Diagnostic.create(\r\n        range,\r\n        text,\r\n        error.severity,\r\n        error.code,\r\n        \"mcfunction\"\r\n    );\r\n}\r\n\r\nexport function runChanges(\r\n    changes: DidChangeTextDocumentParams,\r\n    functionInfo: FunctionInfo\r\n): number[] {\r\n    const changed: number[] = [];\r\n    for (const change of changes.contentChanges) {\r\n        if (!!change.range) {\r\n            // Appease the compiler, as the change interface seems to have range optional\r\n            const { start, end }: Range = change.range;\r\n            const newLineContent = functionInfo.lines[start.line].text\r\n                .substring(0, start.character)\r\n                .concat(\r\n                    change.text,\r\n                    functionInfo.lines[end.line].text.substring(end.character)\r\n                );\r\n            const difference = end.line - start.line + 1;\r\n            const newLines = splitLines(newLineContent);\r\n            functionInfo.lines.splice(start.line, difference, ...newLines);\r\n            changed.forEach((v, i) => {\r\n                if (v > start.line) {\r\n                    changed[i] = v - difference + newLines.length;\r\n                }\r\n            });\r\n            changed.push(\r\n                ...Array.from(\r\n                    new Array(newLines.length),\r\n                    (_, i) => start.line + i\r\n                )\r\n            );\r\n        }\r\n    }\r\n    const unique = changed.filter(\r\n        (value, index, self) => self.indexOf(value) === index\r\n    );\r\n    unique.sort((a, b) => a - b);\r\n    return unique;\r\n}\r\n","import {\r\n    CommandNode,\r\n    CommandNodePath,\r\n    CommandTree,\r\n    MCNode\r\n} from \"../data/types\";\r\n\r\nexport function followPath<T extends MCNode<T>>(\r\n    tree: MCNode<T>,\r\n    path: CommandNodePath\r\n): MCNode<T> {\r\n    // There are no protections here, because if a path is given it should be correct.\r\n    let current = tree;\r\n    for (const section of path) {\r\n        if (!!current.children && !!current.children[section]) {\r\n            current = current.children[section];\r\n        }\r\n    }\r\n    return current;\r\n}\r\n\r\nexport function getNextNode(\r\n    node:\r\n        | CommandNode\r\n        | MCNode<CommandNode> & {\r\n              executable?: boolean;\r\n              redirect?: CommandNodePath;\r\n          }, // Allow use of node.redirect without a tsignore\r\n    nodePath: CommandNodePath,\r\n    tree: CommandTree\r\n): GetNodeResult {\r\n    const redirect: CommandNodePath | undefined = node.redirect;\r\n    if (!!redirect) {\r\n        return { node: followPath(tree, redirect), path: redirect };\r\n    } else {\r\n        if (!node.children && !node.executable) {\r\n            // In this case either tree is malformed or in `execute run`\r\n            // So we just return the entire tree\r\n            return { node: tree, path: [] };\r\n        }\r\n        return { node, path: nodePath };\r\n    }\r\n}\r\n\r\ninterface GetNodeResult {\r\n    node: MCNode<CommandNode>;\r\n    path: CommandNodePath;\r\n}\r\n","import * as path from \"path\";\r\n\r\nimport {\r\n    mkdirAsync,\r\n    readJSONRaw,\r\n    saveFileAsync,\r\n    writeJSON\r\n} from \"../misc-functions/promisified-fs\";\r\nimport { typed_keys } from \"../misc-functions/third_party/typed-keys\";\r\nimport { WorkspaceSecurity } from \"../types\";\r\nimport { Cacheable } from \"./types\";\r\n\r\nif (!process.env.MCFUNCTION_CACHE_DIR) {\r\n    throw new Error(\"Environment variable MCFUNCTION_CACHE_DIR must be set\");\r\n}\r\nconst cacheFolder = process.env.MCFUNCTION_CACHE_DIR;\r\n\r\nconst cacheFileNames: { [K in keyof Cacheable]: string } = {\r\n    blocks: \"blocks.json\",\r\n    commands: \"commands.json\",\r\n    items: \"items.json\",\r\n    meta_info: \"meta_info.json\",\r\n    resources: \"resources.json\"\r\n};\r\n\r\nexport async function readCache(): Promise<Cacheable> {\r\n    const data: Cacheable = {} as Cacheable;\r\n    const keys = typed_keys(cacheFileNames);\r\n    await Promise.all(\r\n        keys.map(async key => {\r\n            data[key] = await readJSONRaw<Cacheable[typeof key]>(\r\n                path.join(cacheFolder, cacheFileNames[key])\r\n            );\r\n        })\r\n    );\r\n    return data;\r\n}\r\n\r\nexport async function cacheData(data: Cacheable): Promise<void> {\r\n    try {\r\n        await mkdirAsync(cacheFolder, \"777\");\r\n    } catch (_) {\r\n        // Don't use the error, which is normally thrown if the folder doesn't exist\r\n    }\r\n    const keys: Array<keyof typeof cacheFileNames> = typed_keys(cacheFileNames);\r\n    await Promise.all(\r\n        keys.map(async key =>\r\n            writeJSON(path.join(cacheFolder, cacheFileNames[key]), data[key])\r\n        )\r\n    );\r\n    return;\r\n}\r\n\r\nexport async function storeSecurity(\r\n    security: WorkspaceSecurity\r\n): Promise<void> {\r\n    await saveFileAsync(\r\n        path.join(cacheFolder, \"security.json\"),\r\n        JSON.stringify(security)\r\n    );\r\n}\r\n\r\nexport async function readSecurity(): Promise<WorkspaceSecurity> {\r\n    try {\r\n        return await readJSONRaw(path.join(cacheFolder, \"security.json\"));\r\n    } catch (error) {\r\n        return {};\r\n    }\r\n}\r\n","import { IConnection } from \"vscode-languageserver/lib/main\";\r\nimport { storeSecurity } from \"../data/cache\";\r\nimport { WorkspaceSecurity } from \"../types\";\r\n\r\n/**\r\n * Check if the given change requires security confirmation\r\n */\r\nexport function securityIssues(\r\n    settings: McFunctionSettings,\r\n    security: WorkspaceSecurity\r\n): Array<keyof WorkspaceSecurity> {\r\n    const results: Array<keyof WorkspaceSecurity> = [];\r\n    if (!!settings.data) {\r\n        if (!!settings.data.customJar && security.JarPath !== true) {\r\n            results.push(\"JarPath\");\r\n        }\r\n        if (!!settings.data.javaPath && security.JavaPath !== true) {\r\n            results.push(\"JavaPath\");\r\n        }\r\n    }\r\n    if (!!settings.parsers /* && security.CustomParsers !== true */) {\r\n        /* const names = Object.keys(settings.parsers);\r\n        if (names.length > 0) {\r\n            results.push(\"CustomParsers\");\r\n        } */\r\n        throw new Error(`Custom parsers are not supported for client implementations.\r\nTo request this feature be enabled, open an issue at https://github.com/Levertion/mcfunction-langserver`);\r\n    }\r\n    return results;\r\n}\r\n\r\nexport async function actOnSecurity(\r\n    issues: Array<keyof WorkspaceSecurity>,\r\n    connection: IConnection,\r\n    security: WorkspaceSecurity\r\n): Promise<boolean> {\r\n    let securityChanged = false;\r\n    const resave = async () => {\r\n        if (securityChanged) {\r\n            await storeSecurity(security);\r\n        }\r\n    };\r\n    for (const issue of issues) {\r\n        const response = await Promise.resolve(\r\n            connection.window.showErrorMessage(\r\n                `[MCFUNCTION] You have the potentially insecure setting '${issue}' set, but no confirmation has been recieved.`,\r\n                { title: \"Yes\" },\r\n                { title: \"No (Stops server)\" }\r\n            )\r\n        );\r\n        if (!!response && response.title === \"Yes\") {\r\n            security[issue] = true;\r\n            securityChanged = true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n    await resave();\r\n    return true;\r\n}\r\n","import { IConnection } from \"vscode-languageserver/lib/main\";\r\n\r\nexport function setup_logging(connection: IConnection): void {\r\n    const log = (message: string) => {\r\n        connection.console.log(message);\r\n    };\r\n    // tslint:disable-next-line:prefer-object-spread\r\n    global.mcLangLog = Object.assign(log, {\r\n        internal: (m: string) => {\r\n            if (mcLangSettings.trace.internalLogging) {\r\n                log(`[McFunctionInternal] ${m}`);\r\n            }\r\n        }\r\n    });\r\n}\r\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\r\nimport {\r\n    convertToNamespace,\r\n    namespacesEqual,\r\n    ReturnHelper,\r\n    stringifyNamespace\r\n} from \"..\";\r\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { StringReader } from \"../../brigadier/string-reader\";\r\nimport { NamespacedName } from \"../../data/types\";\r\nimport { CE, ReturnedInfo, ReturnSuccess, Suggestion } from \"../../types\";\r\nimport { isNamespaceDefault, namesEqual } from \"../namespace\";\r\n\r\nconst NAMESPACEEXCEPTIONS = {\r\n    invalid_id: new CommandErrorBuilder(\r\n        \"argument.id.invalid\",\r\n        \"Invalid character '%s' in location %s\"\r\n    )\r\n};\r\n\r\nconst disallowedPath = /[^0-9a-z_/\\.-]/g;\r\n\r\nexport function readNamespaceText(reader: StringReader): string {\r\n    const namespaceChars = /^[0-9a-z_:/\\.-]$/;\r\n    return reader.readWhileRegexp(namespaceChars);\r\n}\r\n\r\n/**\r\n * Does `base`(eg minecraft:stone) start with `test` (e.g. sto) [Y]\r\n */\r\nexport function namespaceStart(\r\n    base: NamespacedName,\r\n    test: NamespacedName\r\n): boolean {\r\n    if (test.namespace === undefined) {\r\n        return (\r\n            (isNamespaceDefault(base) && base.path.startsWith(test.path)) ||\r\n            (!!base.namespace && base.namespace.startsWith(test.path))\r\n        );\r\n    } else {\r\n        return namesEqual(base, test) && base.path.startsWith(test.path);\r\n    }\r\n}\r\n\r\nexport function namespaceSuggestions(\r\n    options: NamespacedName[],\r\n    value: NamespacedName,\r\n    start: number\r\n): Suggestion[] {\r\n    const result: Suggestion[] = [];\r\n    for (const option of options) {\r\n        if (namespaceStart(option, value)) {\r\n            result.push({ text: stringifyNamespace(option), start });\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function namespaceSuggestionString(\r\n    options: string[],\r\n    value: NamespacedName,\r\n    start: number\r\n): Suggestion[] {\r\n    return namespaceSuggestions(\r\n        // tslint:disable-next-line:no-unnecessary-callback-wrapper this is a false positive - see https://github.com/palantir/tslint/issues/2430\r\n        options.map(v => convertToNamespace(v)),\r\n        value,\r\n        start\r\n    );\r\n}\r\n\r\nexport function parseNamespace(\r\n    reader: StringReader\r\n): ReturnedInfo<NamespacedName> {\r\n    const helper = new ReturnHelper();\r\n    const start = reader.cursor;\r\n    const text = readNamespaceText(reader);\r\n    const namespace = convertToNamespace(text);\r\n    let next: RegExpExecArray | null;\r\n    let failed = false;\r\n    // Give an error for each invalid character\r\n    do {\r\n        next = disallowedPath.exec(namespace.path);\r\n        if (next) {\r\n            // Relies on the fact that convertToNamespace splits on the first\r\n            const i = text.indexOf(\":\") + 1 + next.index + start;\r\n            failed = true;\r\n            helper.addErrors(\r\n                NAMESPACEEXCEPTIONS.invalid_id.create(i, i + 1, next[0], text)\r\n            );\r\n        }\r\n    } while (next);\r\n    if (failed) {\r\n        return helper.fail();\r\n    } else {\r\n        return helper.succeed(namespace);\r\n    }\r\n}\r\n\r\ninterface OptionResult<T> {\r\n    literal: NamespacedName;\r\n    values: T[];\r\n}\r\n\r\nexport function parseNamespaceOption<T extends NamespacedName>(\r\n    reader: StringReader,\r\n    options: T[],\r\n    completionKind?: CompletionItemKind\r\n): ReturnedInfo<OptionResult<T>, CE, NamespacedName | undefined> {\r\n    const helper = new ReturnHelper();\r\n    const start = reader.cursor;\r\n    const namespace = parseNamespace(reader);\r\n    if (helper.merge(namespace)) {\r\n        const results = processParsedNamespaceOption(\r\n            namespace.data,\r\n            options,\r\n            !reader.canRead(),\r\n            start,\r\n            completionKind\r\n        );\r\n        helper.merge(results);\r\n        if (results.data.length > 0) {\r\n            return helper.succeed<OptionResult<T>>({\r\n                literal: namespace.data,\r\n                values: results.data\r\n            });\r\n        } else {\r\n            return helper.failWithData(namespace.data);\r\n        }\r\n    } else {\r\n        return helper.failWithData(undefined);\r\n    }\r\n}\r\n\r\nexport function processParsedNamespaceOption<T extends NamespacedName>(\r\n    namespace: NamespacedName,\r\n    options: T[],\r\n    suggest: boolean,\r\n    start: number,\r\n    completionKind?: CompletionItemKind\r\n): ReturnSuccess<T[]> {\r\n    const results: T[] = [];\r\n    const helper = new ReturnHelper();\r\n    for (const val of options) {\r\n        if (namespacesEqual(val, namespace)) {\r\n            results.push(val);\r\n        }\r\n        if (suggest && namespaceStart(val, namespace)) {\r\n            helper.addSuggestion(\r\n                start,\r\n                stringifyNamespace(val),\r\n                completionKind\r\n            );\r\n        }\r\n    }\r\n    return helper.succeed(results);\r\n}\r\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\r\nimport {\r\n    buildPath,\r\n    convertToNamespace,\r\n    getResourcesofType,\r\n    namespacesEqual,\r\n    ReturnHelper\r\n} from \"..\";\r\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { StringReader } from \"../../brigadier/string-reader\";\r\nimport { TAG_START } from \"../../consts\";\r\nimport {\r\n    DataResource,\r\n    NamespacedName,\r\n    Resources,\r\n    Tag,\r\n    WorldInfo\r\n} from \"../../data/types\";\r\nimport { CE, ParserInfo, ReturnedInfo, ReturnSuccess } from \"../../types\";\r\nimport {\r\n    parseNamespace,\r\n    parseNamespaceOption,\r\n    readNamespaceText\r\n} from \"./namespace\";\r\n\r\nexport interface TagParseResult {\r\n    parsed: NamespacedName;\r\n    resolved?: NamespacedName[];\r\n    values?: Array<DataResource<Tag>>;\r\n}\r\n\r\n/**\r\n * Parse a namespace or tag.\r\n * Returned:\r\n *  - values are the resources which are the exact matches\r\n *  - resolved are the lowest level tag members\r\n *  - parsed is the literal tag. If parsed exists, but not resolved/values, then it was a non-tag\r\n *  - if not successful, if data undefined then parsing failed.\r\n *  - if data is a value, then a tag parsed but was unknown\r\n */\r\nexport function parseNamespaceOrTag(\r\n    reader: StringReader,\r\n    info: ParserInfo,\r\n    taghandling: keyof Resources | CommandErrorBuilder\r\n): ReturnedInfo<TagParseResult, CE, NamespacedName | undefined> {\r\n    const helper = new ReturnHelper(info);\r\n    const start = reader.cursor;\r\n    if (reader.peek() === TAG_START) {\r\n        reader.skip();\r\n        if (typeof taghandling === \"string\") {\r\n            const tags: Array<DataResource<Tag>> = getResourcesofType(\r\n                info.data,\r\n                taghandling\r\n            );\r\n            const parsed = parseNamespaceOption(\r\n                reader,\r\n                tags,\r\n                CompletionItemKind.Folder\r\n            );\r\n            if (helper.merge(parsed)) {\r\n                const values = parsed.data.values;\r\n                const resolved: NamespacedName[] = [];\r\n                for (const value of values) {\r\n                    resolved.push(...getLowestForTag(value, tags));\r\n                }\r\n                return helper.succeed<TagParseResult>({\r\n                    parsed: parsed.data.literal,\r\n                    resolved,\r\n                    values\r\n                });\r\n            } else {\r\n                return helper.failWithData(parsed.data);\r\n            }\r\n        } else {\r\n            readNamespaceText(reader);\r\n            return helper.fail(taghandling.create(start, reader.cursor));\r\n        }\r\n    } else {\r\n        if (!reader.canRead() && typeof taghandling === \"string\") {\r\n            helper.addSuggestion(\r\n                reader.cursor,\r\n                TAG_START,\r\n                CompletionItemKind.Operator\r\n            );\r\n        }\r\n        const parsed = parseNamespace(reader);\r\n        if (helper.merge(parsed)) {\r\n            return helper.succeed({ parsed: parsed.data });\r\n        } else {\r\n            return helper.fail();\r\n        }\r\n    }\r\n}\r\n\r\nfunction getLowestForTag(\r\n    tag: DataResource<Tag>,\r\n    options: Array<DataResource<Tag>>\r\n): NamespacedName[] {\r\n    if (!tag.data) {\r\n        return [];\r\n    }\r\n    const results: NamespacedName[] = [];\r\n    for (const tagMember of tag.data.values) {\r\n        if (tagMember[0] === TAG_START) {\r\n            const namespace = convertToNamespace(tagMember.substring(1));\r\n            for (const option of options) {\r\n                if (namespacesEqual(namespace, option)) {\r\n                    results.push(...getLowestForTag(option, options));\r\n                }\r\n            }\r\n        } else {\r\n            results.push(convertToNamespace(tagMember));\r\n        }\r\n    }\r\n    return results;\r\n}\r\n\r\nexport function buildTagActions(\r\n    tags: Array<DataResource<Tag>>,\r\n    low: number,\r\n    high: number,\r\n    type: keyof Resources,\r\n    localData?: WorldInfo\r\n): ReturnSuccess<void> {\r\n    const helper = new ReturnHelper();\r\n    for (const resource of tags) {\r\n        if (resource.data) {\r\n            helper.addActions({\r\n                data: `\\`\\`\\`json\r\n${JSON.stringify(resource.data, undefined, 4)}\r\n\\`\\`\\``,\r\n                high,\r\n                low,\r\n                type: \"hover\"\r\n            });\r\n        }\r\n        if (localData) {\r\n            const location = buildPath(resource, localData, type);\r\n            if (location) {\r\n                helper.addActions({\r\n                    data: location,\r\n                    high,\r\n                    low,\r\n                    type: \"source\"\r\n                });\r\n            }\r\n        }\r\n    }\r\n    return helper.succeed();\r\n}\r\n","export * from \"./context\";\r\nexport * from \"./creators\";\r\nexport * from \"./datapack-folder\";\r\nexport * from \"./file-errors\";\r\nexport * from \"./group-resources\";\r\nexport * from \"./lsp-conversions\";\r\nexport * from \"./namespace\";\r\nexport * from \"./node-tree\";\r\nexport * from \"./promisified-fs\";\r\nexport * from \"./return-helper\";\r\nexport * from \"./security\";\r\nexport * from \"./setup\";\r\nexport * from \"./translation\";\r\n\r\nexport * from \"./parsing/namespace\";\r\nexport * from \"./parsing/nmsp-tag\";\r\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\r\nimport { ReturnHelper } from \"../misc-functions\";\r\nimport { typed_keys } from \"../misc-functions/third_party/typed-keys\";\r\nimport { CE, ReturnedInfo, Suggestion } from \"../types\";\r\nimport { CommandErrorBuilder } from \"./errors\";\r\n\r\nconst EXCEPTIONS = {\r\n    EXPECTED_BOOL: new CommandErrorBuilder(\r\n        \"parsing.bool.expected\",\r\n        \"Expected bool\"\r\n    ),\r\n    EXPECTED_END_OF_QUOTE: new CommandErrorBuilder(\r\n        \"parsing.quote.expected.end\",\r\n        \"Unclosed quoted string\"\r\n    ),\r\n    EXPECTED_FLOAT: new CommandErrorBuilder(\r\n        \"parsing.float.expected\",\r\n        \"Expected float\"\r\n    ),\r\n    EXPECTED_INT: new CommandErrorBuilder(\r\n        \"parsing.int.expected\",\r\n        \"Expected integer\"\r\n    ),\r\n    EXPECTED_START_OF_QUOTE: new CommandErrorBuilder(\r\n        \"parsing.quote.expected.start\",\r\n        \"Expected quote to start a string\"\r\n    ),\r\n    EXPECTED_STRING_FROM: new CommandErrorBuilder(\r\n        \"parsing.expected.option\",\r\n        \"Expected string from %s, got '%s'\"\r\n    ),\r\n    EXPECTED_SYMBOL: new CommandErrorBuilder(\r\n        \"parsing.expected\",\r\n        \"Expected '%s'\"\r\n    ),\r\n    INVALID_BOOL: new CommandErrorBuilder(\r\n        \"parsing.bool.invalid\",\r\n        \"Invalid bool, expected true or false but found '%s'\"\r\n    ),\r\n    INVALID_ESCAPE: new CommandErrorBuilder(\r\n        \"parsing.quote.escape\",\r\n        \"Invalid escape sequence '\\\\%s' in quoted string)\"\r\n    ),\r\n    INVALID_FLOAT: new CommandErrorBuilder(\r\n        \"parsing.float.invalid\",\r\n        \"Invalid float '%s'\"\r\n    ),\r\n    INVALID_INT: new CommandErrorBuilder(\r\n        \"parsing.int.invalid\",\r\n        \"Invalid integer '%s'\"\r\n    )\r\n};\r\n\r\nconst QUOTE = '\"';\r\nconst ESCAPE = \"\\\\\";\r\n\r\nexport class StringReader {\r\n    public static charAllowedInUnquotedString = /^[0-9A-Za-z_\\-\\.+]$/;\r\n    public static charAllowedNumber = /^[0-9\\-\\.]$/;\r\n    private static readonly bools = { true: true, false: false };\r\n    public cursor = 0;\r\n    public readonly string: string;\r\n\r\n    public constructor(stringToRead: string) {\r\n        this.string = stringToRead;\r\n    }\r\n    public canRead(length: number = 1): boolean {\r\n        return this.cursor + length <= this.string.length;\r\n    }\r\n    /**\r\n     * Require that a specific string follows\r\n     * @param str The string which should come next\r\n     */\r\n    public expect(str: string): ReturnedInfo<undefined> {\r\n        const helper = new ReturnHelper();\r\n        if (str.startsWith(this.getRemaining())) {\r\n            helper.addSuggestions({ text: str, start: this.cursor });\r\n        }\r\n        const sub = this.string.substr(this.cursor, str.length);\r\n        if (sub !== str) {\r\n            return helper.fail(\r\n                EXCEPTIONS.EXPECTED_SYMBOL.create(\r\n                    this.cursor,\r\n                    Math.min(this.string.length, this.cursor + str.length),\r\n                    sub,\r\n                    str\r\n                )\r\n            );\r\n        }\r\n        this.cursor += str.length;\r\n        return helper.succeed();\r\n    }\r\n    public getRead(): string {\r\n        return this.string.substring(0, this.cursor);\r\n    }\r\n    public getRemaining(): string {\r\n        return this.string.substring(this.cursor);\r\n    }\r\n    public getRemainingLength(): number {\r\n        return this.string.length - this.cursor;\r\n    }\r\n    public getTotalLength(): number {\r\n        return this.string.length;\r\n    }\r\n    public peek(offset: number = 0): string {\r\n        return this.string.charAt(this.cursor + offset);\r\n    }\r\n    public read(): string {\r\n        return this.string.charAt(this.cursor++);\r\n    }\r\n    /**\r\n     * Read a boolean value from the string\r\n     */\r\n    public readBoolean(): ReturnedInfo<boolean> {\r\n        const helper = new ReturnHelper();\r\n        const start = this.cursor;\r\n        const value = this.readOption<keyof typeof StringReader[\"bools\"]>(\r\n            typed_keys(StringReader.bools),\r\n            false\r\n        );\r\n        if (!helper.merge(value)) {\r\n            if (value.data !== false) {\r\n                return helper.fail(\r\n                    EXCEPTIONS.INVALID_BOOL.create(\r\n                        start,\r\n                        this.cursor,\r\n                        value.data\r\n                    )\r\n                );\r\n            } else {\r\n                return helper.fail();\r\n            }\r\n        }\r\n        return helper.succeed(StringReader.bools[value.data]);\r\n    }\r\n    /**\r\n     * Read a float from the string\r\n     */\r\n    public readFloat(): ReturnedInfo<number> {\r\n        const helper = new ReturnHelper();\r\n        const start: number = this.cursor;\r\n        const readToTest: string = this.readWhileRegexp(\r\n            StringReader.charAllowedNumber\r\n        );\r\n        if (readToTest.length === 0) {\r\n            return helper.fail(\r\n                EXCEPTIONS.EXPECTED_FLOAT.create(start, this.string.length)\r\n            );\r\n        }\r\n\r\n        // The Java readInt throws upon multiple `.`s, but Javascript's doesn't\r\n        if ((readToTest.match(/\\./g) || []).length > 1) {\r\n            return helper.fail(\r\n                EXCEPTIONS.INVALID_FLOAT.create(\r\n                    start,\r\n                    this.cursor,\r\n                    this.string.substring(start, this.cursor)\r\n                )\r\n            );\r\n        }\r\n        try {\r\n            return helper.succeed(parseFloat(readToTest));\r\n        } catch (error) {\r\n            return helper.fail(\r\n                EXCEPTIONS.INVALID_FLOAT.create(start, this.cursor, readToTest)\r\n            );\r\n        }\r\n    }\r\n    /**\r\n     * Read an integer from the string\r\n     */\r\n    public readInt(): ReturnedInfo<number> {\r\n        const helper = new ReturnHelper();\r\n        const start: number = this.cursor;\r\n        const readToTest: string = this.readWhileRegexp(\r\n            StringReader.charAllowedNumber\r\n        );\r\n        if (readToTest.length === 0) {\r\n            return helper.fail(\r\n                EXCEPTIONS.EXPECTED_INT.create(start, this.string.length)\r\n            );\r\n        }\r\n        // The Java readInt throws upon a `.`, but the regex includes one in brigadier\r\n        // This handles this case\r\n        if (readToTest.indexOf(\".\") !== -1) {\r\n            return helper.fail(\r\n                EXCEPTIONS.INVALID_INT.create(\r\n                    start,\r\n                    this.cursor,\r\n                    this.string.substring(start, this.cursor)\r\n                )\r\n            );\r\n        }\r\n        try {\r\n            return helper.succeed(Number.parseInt(readToTest, 10));\r\n        } catch (error) {\r\n            return helper.fail(\r\n                EXCEPTIONS.INVALID_INT.create(start, this.cursor, readToTest)\r\n            );\r\n        }\r\n    }\r\n    /**\r\n     * Expect a string from a selection\r\n     * @param quoted how should the string be handled.\r\n     * - `both`: StringReader::readString()\r\n     * - `option`: expect an option, but don't advance cursor if fails\r\n     * - `yes`: StringReader::readQuotedString()\r\n     * - `no`: StringReader::readUnquotedString()\r\n     */\r\n    public readOption<T extends string>(\r\n        options: T[],\r\n        addError: boolean = true,\r\n        completion?: CompletionItemKind,\r\n        quoted: \"both\" | \"option\" | \"yes\" | \"no\" = \"both\"\r\n    ): ReturnedInfo<T, CE, string | false> {\r\n        const start = this.cursor;\r\n        const helper = new ReturnHelper();\r\n        let isquoted = false;\r\n        if (this.peek() === QUOTE) {\r\n            isquoted = true;\r\n        }\r\n        let resultaux: ReturnedInfo<string>;\r\n        switch (quoted) {\r\n            case \"both\":\r\n                resultaux = this.readString();\r\n                break;\r\n            case \"yes\":\r\n                resultaux = this.readQuotedString();\r\n                break;\r\n            case \"option\": {\r\n                // tslint:disable-next-line:no-unnecessary-initializer copt needs to be 'initialized'\r\n                let copt: string | undefined = undefined;\r\n                for (const opt of options) {\r\n                    if (this.getRemaining().startsWith(opt)) {\r\n                        copt = opt;\r\n                        this.cursor += opt.length;\r\n                        break;\r\n                    }\r\n                }\r\n                resultaux =\r\n                    copt === undefined\r\n                        ? new ReturnHelper(false).fail()\r\n                        : new ReturnHelper(false).succeed(copt);\r\n                break;\r\n            }\r\n            case \"no\":\r\n                resultaux = new ReturnHelper(false).succeed(\r\n                    this.readUnquotedString()\r\n                );\r\n                break;\r\n            default:\r\n                resultaux = this.readString();\r\n        }\r\n        const result = resultaux;\r\n        if (!helper.merge(result, false)) {\r\n            if (isquoted && !this.canRead()) {\r\n                const remaining = this.string.substring(start + 1);\r\n                // Note that if there are quotes and backslashes, this will fail\r\n                helper.addSuggestions(\r\n                    ...options\r\n                        .filter(v => v.startsWith(remaining))\r\n                        .map<Suggestion>(v => ({\r\n                            kind: completion,\r\n                            start,\r\n                            text: `${QUOTE}${v}${QUOTE}`\r\n                        }))\r\n                );\r\n            }\r\n            return helper.failWithData(false as any);\r\n        }\r\n        let valid: T | undefined;\r\n        for (const option of options) {\r\n            if (option === result.data) {\r\n                valid = option;\r\n            }\r\n        }\r\n        if (!this.canRead()) {\r\n            helper.addSuggestions(\r\n                ...options\r\n                    .filter(v => v.startsWith(result.data))\r\n                    .map<Suggestion>(v => ({\r\n                        kind: completion,\r\n                        start,\r\n                        text:\r\n                            isquoted || v.includes('\"') || v.includes(\"\\\\\")\r\n                                ? QUOTE +\r\n                                  v\r\n                                      .replace(/\\\\/g, \"\\\\\\\\\")\r\n                                      .replace(/\"/g, '\\\\\"') +\r\n                                  QUOTE\r\n                                : v\r\n                    }))\r\n            );\r\n        }\r\n        if (valid) {\r\n            return helper.succeed(valid);\r\n        } else {\r\n            if (addError) {\r\n                helper.addErrors(\r\n                    EXCEPTIONS.EXPECTED_STRING_FROM.create(\r\n                        start,\r\n                        this.cursor,\r\n                        JSON.stringify(options),\r\n                        result.data\r\n                    )\r\n                );\r\n            }\r\n            return helper.failWithData(result.data);\r\n        }\r\n    }\r\n    /**\r\n     * Read from the string, returning a string, which, in the original had been surrounded by quotes\r\n     */\r\n    public readQuotedString(): ReturnedInfo<string> {\r\n        const helper = new ReturnHelper();\r\n        const start = this.cursor;\r\n        if (!this.canRead()) {\r\n            return helper.succeed(\"\");\r\n        }\r\n        if (this.peek() !== QUOTE) {\r\n            return helper.fail(\r\n                EXCEPTIONS.EXPECTED_START_OF_QUOTE.create(\r\n                    this.cursor,\r\n                    this.string.length\r\n                )\r\n            );\r\n        }\r\n        let result = \"\";\r\n        let escaped = false;\r\n        while (this.canRead()) {\r\n            this.skip();\r\n            const c: string = this.peek();\r\n            if (escaped) {\r\n                if (c === QUOTE || c === ESCAPE) {\r\n                    result += c;\r\n                    escaped = false;\r\n                } else {\r\n                    return helper.fail(\r\n                        EXCEPTIONS.INVALID_ESCAPE.create(\r\n                            this.cursor - 1,\r\n                            this.cursor + 1,\r\n                            c\r\n                        )\r\n                    ); // Includes backslash\r\n                }\r\n            } else if (c === ESCAPE) {\r\n                escaped = true;\r\n            } else if (c === QUOTE) {\r\n                this.skip();\r\n                return helper.succeed(result);\r\n            } else {\r\n                result += c;\r\n            }\r\n        }\r\n        helper.addSuggestion(this.cursor, QUOTE); // Always cannot read at this point\r\n        return helper.fail(\r\n            EXCEPTIONS.EXPECTED_END_OF_QUOTE.create(start, this.string.length)\r\n        );\r\n    }\r\n    /**\r\n     * Read a string from the string. If it surrounded by quotes, the quotes are ignored.\r\n     * The cursor ends on the last character in the string.\r\n     */\r\n    public readString(): ReturnedInfo<string> {\r\n        if (this.canRead() && this.peek() === QUOTE) {\r\n            return this.readQuotedString();\r\n        } else {\r\n            const helper = new ReturnHelper();\r\n            if (!this.canRead()) {\r\n                helper.addSuggestions({\r\n                    start: this.cursor,\r\n                    text: QUOTE\r\n                });\r\n            }\r\n            return helper.succeed(this.readUnquotedString());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Read a string which is not surrounded by quotes.\r\n     * Can only contain alphanumerical characters, _,+,. and -\r\n     */\r\n    public readUnquotedString(): string {\r\n        return this.readWhileRegexp(StringReader.charAllowedInUnquotedString);\r\n    }\r\n\r\n    /**\r\n     * Read the string until a certain regular expression matches the\r\n     * character under the cursor.\r\n     * @param exp The Regular expression to test against.\r\n     */\r\n    public readUntilRegexp(exp: RegExp): string {\r\n        return this.readWhileFunction(s => !exp.test(s));\r\n    }\r\n    /**\r\n     * Read while a certain function returns true on each consecutive character starting with the one under the cursor.\r\n     * In most cases, it is better to use readWhileRegexp.\r\n     * @param callback The function to use.\r\n     */\r\n    public readWhileFunction(callback: (char: string) => boolean): string {\r\n        const begin = this.cursor;\r\n        while (callback(this.peek())) {\r\n            if (this.canRead()) {\r\n                this.skip();\r\n            } else {\r\n                return this.string.substring(begin);\r\n            }\r\n        }\r\n        return this.string.substring(begin, this.cursor);\r\n    }\r\n    /**\r\n     * Read the string while a certain regular expression matches the character under the cursor.\r\n     * The cursor ends on the first character which doesn't match\r\n     * @param exp The Regular Expression to test against\r\n     */\r\n    public readWhileRegexp(exp: RegExp): string {\r\n        return this.readWhileFunction(s => exp.test(s));\r\n    }\r\n\r\n    public skip(): void {\r\n        this.cursor++;\r\n    }\r\n    public skipWhitespace(): void {\r\n        this.readWhileRegexp(/\\s/); // Whitespace\r\n    }\r\n}\r\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\r\nimport { prepareForParser } from \"../../misc-functions\";\r\nimport { Parser } from \"../../types\";\r\n\r\nexport const boolParser: Parser = {\r\n    kind: CompletionItemKind.Keyword,\r\n    parse: (reader, props) => prepareForParser(reader.readBoolean(), props)\r\n};\r\n","import { ReturnHelper } from \"../../misc-functions\";\r\nimport { Parser } from \"../../types\";\r\n\r\nexport const stringParser: Parser = {\r\n    parse: (reader, properties) => {\r\n        const helper = new ReturnHelper(properties);\r\n        switch (properties.node_properties.type) {\r\n            case \"greedy\":\r\n                reader.cursor = reader.string.length;\r\n                return helper.succeed();\r\n            case \"word\":\r\n                reader.readUnquotedString();\r\n                return helper.succeed();\r\n            default:\r\n                if (helper.merge(reader.readString())) {\r\n                    return helper.succeed();\r\n                } else {\r\n                    return helper.fail();\r\n                }\r\n        }\r\n    }\r\n};\r\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { ReturnHelper } from \"../../misc-functions\";\r\nimport { Parser } from \"../../types\";\r\n\r\nconst JAVAMAXINT = 2147483647;\r\nconst JAVAMININT = -2147483648;\r\n\r\nconst INTEGEREXCEPTIONS = {\r\n    TOOBIG: new CommandErrorBuilder(\r\n        \"argument.integer.big\",\r\n        \"Integer must not be more than %s, found %s\"\r\n    ),\r\n    TOOSMALL: new CommandErrorBuilder(\r\n        \"argument.integer.low\",\r\n        \"Integer must not be less than %s, found %s\"\r\n    )\r\n};\r\n\r\nexport const intParser: Parser = {\r\n    parse: (reader, properties) => {\r\n        const helper = new ReturnHelper(properties);\r\n        const start = reader.cursor;\r\n        const result = reader.readInt();\r\n        if (!helper.merge(result)) {\r\n            return helper.fail();\r\n        }\r\n        const maxVal = properties.node_properties.max;\r\n        const minVal = properties.node_properties.min;\r\n        // See https://stackoverflow.com/a/12957445\r\n        const max = Math.min(\r\n            typeof maxVal === \"number\" ? maxVal : JAVAMAXINT,\r\n            JAVAMAXINT\r\n        );\r\n        const min = Math.max(\r\n            typeof minVal === \"number\" ? minVal : JAVAMININT,\r\n            JAVAMININT\r\n        );\r\n        if (result.data > max) {\r\n            helper.addErrors(\r\n                INTEGEREXCEPTIONS.TOOBIG.create(\r\n                    start,\r\n                    reader.cursor,\r\n                    max.toString(),\r\n                    result.data.toString()\r\n                )\r\n            );\r\n        }\r\n        if (result.data < min) {\r\n            helper.addErrors(\r\n                INTEGEREXCEPTIONS.TOOSMALL.create(\r\n                    start,\r\n                    reader.cursor,\r\n                    min.toString(),\r\n                    result.data.toString()\r\n                )\r\n            );\r\n        }\r\n        return helper.succeed();\r\n    }\r\n};\r\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { ReturnHelper } from \"../../misc-functions\";\r\nimport { Parser } from \"../../types\";\r\n\r\nconst JAVAMINFLOAT = -2139095039;\r\nconst JAVAMAXFLOAT = 2139095039;\r\n\r\nconst FLOATEXCEPTIONS = {\r\n    TOOBIG: new CommandErrorBuilder(\r\n        \"argument.float.big\",\r\n        \"Float must not be more than %s, found %s\"\r\n    ),\r\n    TOOSMALL: new CommandErrorBuilder(\r\n        \"argument.float.low\",\r\n        \"Float must not be less than %s, found %s\"\r\n    )\r\n};\r\n\r\nexport const floatParser: Parser = {\r\n    parse: (reader, properties) => {\r\n        const helper = new ReturnHelper(properties);\r\n        const start = reader.cursor;\r\n        const result = reader.readFloat();\r\n        if (!helper.merge(result)) {\r\n            return helper.fail();\r\n        }\r\n        const maxVal = properties.node_properties.max;\r\n        const minVal = properties.node_properties.min;\r\n        // See https://stackoverflow.com/a/12957445\r\n        const max = Math.min(\r\n            typeof maxVal === \"number\" ? maxVal : JAVAMAXFLOAT,\r\n            JAVAMAXFLOAT\r\n        );\r\n        const min = Math.max(\r\n            typeof minVal === \"number\" ? minVal : JAVAMINFLOAT,\r\n            JAVAMINFLOAT\r\n        );\r\n        if (result.data > max) {\r\n            helper.addErrors(\r\n                FLOATEXCEPTIONS.TOOBIG.create(\r\n                    start,\r\n                    reader.cursor,\r\n                    max.toString(),\r\n                    result.data.toString()\r\n                )\r\n            );\r\n        }\r\n        if (result.data < min) {\r\n            helper.addErrors(\r\n                FLOATEXCEPTIONS.TOOSMALL.create(\r\n                    start,\r\n                    reader.cursor,\r\n                    min.toString(),\r\n                    result.data.toString()\r\n                )\r\n            );\r\n        }\r\n        return helper.succeed();\r\n    }\r\n};\r\n","export * from \"./bool\";\r\nexport * from \"./string\";\r\nexport * from \"./integer\";\r\nexport * from \"./float\";\r\n","import { CompletionItemKind } from \"vscode-languageserver/lib/main\";\r\nimport { ReturnHelper } from \"../misc-functions\";\r\nimport { Parser } from \"../types\";\r\n\r\nexport const literalParser: Parser = {\r\n    kind: CompletionItemKind.Method,\r\n    parse: (reader, properties) => {\r\n        const helper = new ReturnHelper(properties);\r\n        const begin = reader.cursor;\r\n        const literal = properties.path[properties.path.length - 1];\r\n        if (\r\n            properties.suggesting &&\r\n            literal.startsWith(reader.getRemaining())\r\n        ) {\r\n            helper.addSuggestions(literal);\r\n        }\r\n        if (reader.canRead(literal.length)) {\r\n            const end = begin + literal.length;\r\n            if (reader.string.substring(begin, end) === literal) {\r\n                reader.cursor = end;\r\n                if (reader.peek() === \" \" || !reader.canRead()) {\r\n                    return helper.succeed();\r\n                }\r\n            }\r\n        }\r\n        return helper.fail();\r\n    }\r\n};\r\n","import * as path from \"path\";\r\nimport * as url from \"url\";\r\nimport { DiagnosticSeverity } from \"vscode-languageserver/lib/main\";\r\nimport { CommandErrorBuilder } from \"../../../../brigadier/errors\";\r\nimport { NBTTagCompound } from \"../tag/compound-tag\";\r\nimport { NBTTagList } from \"../tag/list-tag\";\r\nimport { NBTTag } from \"../tag/nbt-tag\";\r\n\r\nexport interface NBTFunction {\r\n    id: string;\r\n    params: any;\r\n}\r\n\r\nexport interface NodeBase {\r\n    readonly description?: string;\r\n    readonly references?: { [key: string]: any };\r\n    readonly suggestions?: Array<\r\n        | string\r\n        | { description?: string; value: string }\r\n        | { function: NBTFunction }\r\n    >;\r\n}\r\n\r\nexport interface NoPropertyNode extends NodeBase {\r\n    readonly type:\r\n        | \"no-nbt\"\r\n        | \"byte\"\r\n        | \"short\"\r\n        | \"int\"\r\n        | \"long\"\r\n        | \"float\"\r\n        | \"double\"\r\n        | \"byte_array\"\r\n        | \"string\"\r\n        | \"int_array\"\r\n        | \"long_array\";\r\n}\r\n\r\nexport interface RefNode extends NodeBase {\r\n    readonly ref: string;\r\n}\r\n\r\nexport interface FunctionNode extends NodeBase {\r\n    readonly function: NBTFunction;\r\n}\r\n\r\nexport interface ListNode extends NodeBase {\r\n    readonly item: NBTNode;\r\n    readonly type: \"list\";\r\n}\r\n\r\nexport interface CompoundNode extends NodeBase {\r\n    readonly child_ref?: string[];\r\n    readonly children?: { [key: string]: NBTNode };\r\n    readonly type: \"compound\";\r\n}\r\n\r\nexport interface RootNode extends NodeBase {\r\n    readonly children: { [key: string]: NBTNode };\r\n    readonly type: \"root\";\r\n}\r\n\r\nexport type ValueList = Array<string | { description: string; value: string }>;\r\n\r\nexport type NBTNode =\r\n    | NoPropertyNode\r\n    | CompoundNode\r\n    | RootNode\r\n    | ListNode\r\n    | RefNode\r\n    | FunctionNode;\r\n\r\nexport const parseRefPath = (\r\n    ref: string,\r\n    currentPath: string\r\n): [string, string[]] => {\r\n    const cpd = path.dirname(currentPath);\r\n    const refurl = url.parse(ref);\r\n    const fragPath = (refurl.hash || \"#\")\r\n        .substring(1)\r\n        .split(\"/\")\r\n        .filter(v => v !== \"\");\r\n    const nextPath = path.posix.join(\r\n        cpd,\r\n        refurl.path || path.basename(currentPath)\r\n    );\r\n    return [nextPath, fragPath];\r\n};\r\n\r\nexport function getNBTTagFromTree(\r\n    tag: NBTTag<any>,\r\n    nbtPath: string[]\r\n): NBTTag<any> | undefined {\r\n    let lastTag = tag;\r\n    for (const s of nbtPath) {\r\n        if (lastTag.tagType === \"list\" && /\\d+/.test(s)) {\r\n            lastTag = (tag as NBTTagList).getVal()[parseInt(s, 10)];\r\n        } else if (lastTag.tagType === \"compound\") {\r\n            lastTag = (tag as NBTTagCompound).getVal()[s];\r\n        } else {\r\n            return undefined;\r\n        }\r\n    }\r\n    return lastTag;\r\n}\r\n\r\nexport function isRefNode(node: NBTNode): node is RefNode {\r\n    return \"ref\" in node;\r\n}\r\n\r\nexport function isFunctionNode(node: NBTNode): node is FunctionNode {\r\n    return \"function\" in node;\r\n}\r\n\r\nexport function isTypedNode(\r\n    node: NBTNode\r\n): node is NoPropertyNode | CompoundNode | ListNode | RootNode {\r\n    return \"type\" in node;\r\n}\r\n\r\nexport function isCompoundNode(node: NBTNode): node is CompoundNode {\r\n    return isTypedNode(node) && node.type === \"compound\";\r\n}\r\n\r\nexport function isRootNode(node: NBTNode): node is RootNode {\r\n    return isTypedNode(node) && node.type === \"root\";\r\n}\r\n\r\nexport function isListNode(node: NBTNode): node is ListNode {\r\n    return isTypedNode(node) && node.type === \"list\";\r\n}\r\n\r\nexport interface NBTValidationInfo {\r\n    extraChildren: boolean;\r\n    compoundMerge(): CompoundNode; // This is so the compound parser can merge child ref on call\r\n}\r\n\r\nexport const VALIDATION_ERRORS = {\r\n    badIndex: new CommandErrorBuilder(\r\n        \"argument.nbt.validation.list.badpath\",\r\n        \"The index '%s' is not a valid index\"\r\n    ),\r\n    noSuchChild: new CommandErrorBuilder(\r\n        \"argument.nbt.validation.compound.nochild\",\r\n        \"The tag does not have a child named '%s'\",\r\n        DiagnosticSeverity.Warning\r\n    ),\r\n    wrongType: new CommandErrorBuilder(\r\n        \"argument.nbt.validation.wrongtype\",\r\n        \"The tag type '%s' is not the correct type '%s'\"\r\n    )\r\n};\r\n","import { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { CE, LineRange, ReturnedInfo, Suggestion } from \"../../../../types\";\r\nimport { runSuggestFunction } from \"../doc-walker-func\";\r\nimport {\r\n    isTypedNode,\r\n    NBTNode,\r\n    NBTValidationInfo,\r\n    VALIDATION_ERRORS\r\n} from \"../util/doc-walker-util\";\r\nimport { CorrectLevel, NBTErrorData } from \"../util/nbt-util\";\r\n\r\nexport type ParseReturn = ReturnedInfo<CorrectLevel, CE, NBTErrorData>;\r\n\r\nexport type TagType =\r\n    | \"byte\"\r\n    | \"short\"\r\n    | \"int\"\r\n    | \"long\"\r\n    | \"float\"\r\n    | \"double\"\r\n    | \"byte_array\"\r\n    | \"int_array\"\r\n    | \"long_array\"\r\n    | \"string\"\r\n    | \"list\"\r\n    | \"compound\";\r\n\r\nexport abstract class NBTTag<L> {\r\n    public abstract readonly tagType: TagType;\r\n    protected range: LineRange;\r\n\r\n    protected val: L;\r\n\r\n    public constructor(val: L) {\r\n        this.val = val;\r\n        this.range = { start: 0, end: 0 };\r\n    }\r\n\r\n    public getRange(): LineRange {\r\n        return this.range;\r\n    }\r\n\r\n    public getVal(): L {\r\n        return this.val;\r\n    }\r\n\r\n    public parse(reader: StringReader): ParseReturn {\r\n        const start = reader.cursor;\r\n        const out = this.readTag(reader);\r\n        this.range = {\r\n            end: reader.cursor,\r\n            start\r\n        };\r\n        return out;\r\n    }\r\n\r\n    /**\r\n     * Test if two NBT tags are equivalent in value\r\n     * @param tag The NBT tag to test against\r\n     */\r\n    public tagEq(tag: NBTTag<any>): boolean {\r\n        return tag.tagType === this.tagType && tag.getVal() === this.getVal();\r\n    }\r\n\r\n    public validationResponse(\r\n        node: NBTNode,\r\n        // @ts-ignore\r\n        info?: NBTValidationInfo\r\n    ): ReturnedInfo<undefined> {\r\n        const helper = new ReturnHelper();\r\n        if (!isTypedNode(node)) {\r\n            return helper.fail(\r\n                VALIDATION_ERRORS.wrongType.create(\r\n                    this.range.start,\r\n                    this.range.end,\r\n                    \"\",\r\n                    this.tagType\r\n                )\r\n            );\r\n        } else if (node.type !== this.tagType) {\r\n            return helper.fail(\r\n                VALIDATION_ERRORS.wrongType.create(\r\n                    this.range.start,\r\n                    this.range.end,\r\n                    node.type,\r\n                    this.tagType\r\n                )\r\n            );\r\n        } else {\r\n            if (node.suggestions) {\r\n                for (const k of node.suggestions) {\r\n                    if (typeof k === \"string\") {\r\n                        helper.addSuggestion(this.range.start, k);\r\n                    } else if (\"function\" in k) {\r\n                        helper.addSuggestions(\r\n                            ...runSuggestFunction(\r\n                                k.function.id,\r\n                                k.function.params\r\n                            ).map<Suggestion>(v => ({\r\n                                start: this.range.start,\r\n                                text: v\r\n                            }))\r\n                        );\r\n                    } else {\r\n                        helper.addSuggestion(\r\n                            this.range.start,\r\n                            k.value,\r\n                            undefined,\r\n                            k.description\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n            return helper.succeed();\r\n        }\r\n    }\r\n\r\n    protected abstract readTag(reader: StringReader): ParseReturn;\r\n}\r\n","import { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport class NBTTagString extends NBTTag<string> {\r\n    public tagType: \"string\" = \"string\";\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const helper = new ReturnHelper();\r\n        const str = reader.readString();\r\n        if (!helper.merge(str)) {\r\n            return helper.failWithData({ correct: 1 });\r\n        } else {\r\n            this.val = str.data;\r\n            return helper.succeed(1);\r\n        }\r\n    }\r\n}\r\n","import * as path from \"path\";\r\nimport { sprintf } from \"sprintf-js\";\r\nimport { NBTTag } from \"./tag/nbt-tag\";\r\nimport { NBTTagString } from \"./tag/string-tag\";\r\nimport { FunctionNode, getNBTTagFromTree } from \"./util/doc-walker-util\";\r\n\r\ninterface PathFunctions {\r\n    [key: string]: PathFunc;\r\n}\r\n\r\ninterface SuggestFuncs {\r\n    [key: string]: SuggestFunc;\r\n}\r\n\r\ntype PathFunc = (\r\n    parsed: NBTTag<any>,\r\n    nbtPath: string[],\r\n    node: FunctionNode,\r\n    args: any\r\n) => string;\r\ntype SuggestFunc = (func: string, args: any) => string[];\r\n\r\nconst pathsFuncs: PathFunctions = {\r\n    insertStringNBT\r\n};\r\n\r\nexport function runNodeFunction(\r\n    parsed: NBTTag<any>,\r\n    nbtPath: string[],\r\n    node: FunctionNode\r\n): string {\r\n    return pathsFuncs[node.function.id](\r\n        parsed,\r\n        nbtPath,\r\n        node,\r\n        node.function.params\r\n    );\r\n}\r\n\r\nconst suggestFuncs: SuggestFuncs = {};\r\n\r\ninterface InsertStringNBTArgs {\r\n    default: string;\r\n    ref: string;\r\n    tag_path: string;\r\n}\r\n\r\nfunction insertStringNBT(\r\n    parsed: NBTTag<any>,\r\n    nbtPath: string[],\r\n    // @ts-ignore\r\n    node: FunctionNode,\r\n    args: InsertStringNBTArgs\r\n): string {\r\n    const newRef = path.posix\r\n        .join(path.dirname(nbtPath.join(\"/\")), args.tag_path)\r\n        .split(\"/\");\r\n    const out = getNBTTagFromTree(parsed, newRef);\r\n    return !out || !(out instanceof NBTTagString)\r\n        ? args.default\r\n        : sprintf(args.ref, out.getVal());\r\n}\r\n\r\n// Suggest function\r\n\r\nexport function runSuggestFunction(func: string, args: any): string[] {\r\n    return suggestFuncs[func](func, args);\r\n}\r\n","import { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { ReturnSuccess, SuggestResult } from \"../../../../types\";\r\nimport { runSuggestFunction } from \"../doc-walker-func\";\r\nimport { NBTTag } from \"../tag/nbt-tag\";\r\nimport { isCompoundNode, isListNode, NBTNode } from \"./doc-walker-util\";\r\n\r\nexport const ARRAY_START = \"[\";\r\nexport const ARRAY_END = \"]\";\r\nexport const ARRAY_PREFIX_SEP = \";\";\r\nexport const ARRAY_VALUE_SEP = \",\";\r\n\r\nexport const LIST_START = \"[\";\r\nexport const LIST_END = \"]\";\r\nexport const LIST_VALUE_SEP = \",\";\r\n\r\nexport const COMPOUND_START = \"{\";\r\nexport const COMPOUND_END = \"}\";\r\nexport const COMPOUND_KEY_VALUE_SEP = \":\";\r\nexport const COMPOUND_PAIR_SEP = \",\";\r\n\r\nexport interface NBTErrorData {\r\n    correct: CorrectLevel;\r\n    parsed?: NBTTag<any>;\r\n    path?: string[];\r\n}\r\n\r\nexport enum CorrectLevel {\r\n    NO,\r\n    MAYBE,\r\n    YES\r\n}\r\n\r\nconst parseNumberNBT = (float: boolean) => (reader: StringReader) => {\r\n    const start = reader.cursor;\r\n    try {\r\n        const helper = new ReturnHelper();\r\n        const f = reader.readFloat();\r\n        if (!helper.merge(f)) {\r\n            throw undefined; // This gets caught\r\n        }\r\n        const e = reader.readOption([\"E\", \"e\"], true, undefined, \"option\");\r\n        if (!helper.merge(e)) {\r\n            throw undefined; // This gets caught\r\n        }\r\n        // Returns beyond here because it must be scientific notation\r\n        const exp = reader.readInt();\r\n        if (helper.merge(exp)) {\r\n            return helper.succeed(f.data * Math.pow(10, exp.data));\r\n        } else {\r\n            return helper.fail();\r\n        }\r\n    } catch (e) {\r\n        reader.cursor = start;\r\n        const helper = new ReturnHelper();\r\n        const int = float ? reader.readFloat() : reader.readInt();\r\n        if (helper.merge(int)) {\r\n            return helper.succeed(int.data);\r\n        } else {\r\n            return helper.fail();\r\n        }\r\n    }\r\n};\r\n\r\nexport const parseFloatNBT = parseNumberNBT(true);\r\nexport const parseIntNBT = parseNumberNBT(false);\r\n\r\nexport function getNBTSuggestions(\r\n    node: NBTNode,\r\n    cursor: number\r\n): ReturnSuccess<undefined> {\r\n    const helper = new ReturnHelper();\r\n    if (node.suggestions) {\r\n        const sugg = node.suggestions;\r\n        if (sugg) {\r\n            sugg.forEach(v => {\r\n                if (typeof v === \"string\") {\r\n                    helper.addSuggestion(cursor, v);\r\n                } else if (\"function\" in v) {\r\n                    runSuggestFunction(\r\n                        v.function.id,\r\n                        v.function.params\r\n                    ).forEach(v2 => helper.addSuggestion(cursor, v2));\r\n                } else {\r\n                    helper.addSuggestion(\r\n                        cursor,\r\n                        v.value,\r\n                        undefined,\r\n                        v.description\r\n                    );\r\n                }\r\n            });\r\n        }\r\n    }\r\n    if (isCompoundNode(node) && node.children) {\r\n        helper.addSuggestions(\r\n            ...Object.keys(node.children).map<SuggestResult>(v => ({\r\n                // @ts-ignore\r\n                description: node.children[v].description,\r\n                start: cursor,\r\n                text: v\r\n            }))\r\n        );\r\n    } else if (isListNode(node) && node.item) {\r\n        helper.mergeChain(getNBTSuggestions(node.item, cursor));\r\n    }\r\n    return helper.succeed();\r\n}\r\n","import { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { CorrectLevel, parseIntNBT } from \"../util/nbt-util\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport const BYTE_TAG_SUFFIX = \"b\";\r\n\r\nexport class NBTTagByte extends NBTTag<number> {\r\n    public tagType: \"byte\" = \"byte\";\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const readInt = parseIntNBT(reader);\r\n        const helper = new ReturnHelper();\r\n        if (!helper.merge(readInt)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        const exp = reader.expect(BYTE_TAG_SUFFIX);\r\n        if (!helper.merge(exp)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        this.val = readInt.data;\r\n        return helper.succeed(CorrectLevel.YES);\r\n    }\r\n}\r\n","import { CommandErrorBuilder } from \"../../../../brigadier/errors\";\r\nimport { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport {\r\n    ARRAY_END,\r\n    ARRAY_PREFIX_SEP,\r\n    ARRAY_START,\r\n    ARRAY_VALUE_SEP,\r\n    CorrectLevel\r\n} from \"../util/nbt-util\";\r\nimport { NBTTagByte } from \"./byte-tag\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport const BYTE_ARRAY_PREFIX = \"B\";\r\n\r\nconst EXCEPTIONS = {\r\n    BAD_CHAR: new CommandErrorBuilder(\r\n        \"argument.nbt.bytearray.badchar\",\r\n        \"Expected ',' or ']', got '%s'\"\r\n    ),\r\n    NO_VALUE: new CommandErrorBuilder(\r\n        \"argument.nbt.bytearray.value\",\r\n        \"Expected value\"\r\n    )\r\n};\r\n\r\nexport class NBTTagByteArray extends NBTTag<NBTTagByte[]> {\r\n    public tagType: \"byte_array\" = \"byte_array\";\r\n\r\n    public tagEq(tag: NBTTag<any>): boolean {\r\n        if (tag.tagType !== this.tagType) {\r\n            return false;\r\n        }\r\n        const taga: NBTTagByteArray = tag as NBTTagByteArray;\r\n        return (\r\n            this.val.length === taga.getVal().length &&\r\n            this.val.every((v, i) => v.getVal() === taga.val[i].getVal())\r\n        );\r\n    }\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const helper = new ReturnHelper();\r\n        const start = reader.cursor;\r\n        const arrstart = reader.expect(\r\n            ARRAY_START + BYTE_ARRAY_PREFIX + ARRAY_PREFIX_SEP\r\n        );\r\n        if (!helper.merge(arrstart)) {\r\n            return helper.failWithData({ correct: CorrectLevel.NO });\r\n        }\r\n        if (!reader.canRead()) {\r\n            helper.addSuggestion(reader.cursor, ARRAY_END);\r\n            helper.addErrors(EXCEPTIONS.NO_VALUE.create(start, reader.cursor));\r\n            return helper.failWithData({ parsed: this, correct: 2 });\r\n        }\r\n        if (reader.peek() === ARRAY_END) {\r\n            reader.skip();\r\n            return helper.succeed(2);\r\n        }\r\n        let next = reader.peek();\r\n        while (next !== ARRAY_END) {\r\n            reader.skipWhitespace();\r\n\r\n            if (!reader.canRead()) {\r\n                helper.addErrors(\r\n                    EXCEPTIONS.NO_VALUE.create(start, reader.cursor)\r\n                );\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            }\r\n\r\n            reader.skipWhitespace();\r\n\r\n            const val = new NBTTagByte(0);\r\n            const parseResult = val.parse(reader);\r\n\r\n            helper.merge(parseResult);\r\n\r\n            this.val.push(val);\r\n\r\n            if (!reader.canRead()) {\r\n                helper.addErrors(\r\n                    EXCEPTIONS.NO_VALUE.create(start, reader.cursor)\r\n                );\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            }\r\n\r\n            reader.skipWhitespace();\r\n            const opt = reader.readOption(\r\n                [ARRAY_END, ARRAY_VALUE_SEP],\r\n                true,\r\n                undefined,\r\n                \"option\"\r\n            );\r\n            if (!helper.merge(opt)) {\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            } else {\r\n                next = opt.data;\r\n            }\r\n        }\r\n        return helper.succeed(CorrectLevel.YES);\r\n    }\r\n}\r\n","import { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { CorrectLevel, parseFloatNBT } from \"../util/nbt-util\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport const DOUBLE_TAG_SUFFIX = \"d\";\r\n\r\nexport class NBTTagDouble extends NBTTag<number> {\r\n    public tagType: \"double\" = \"double\";\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const readInt = parseFloatNBT(reader);\r\n        const helper = new ReturnHelper();\r\n        if (!helper.merge(readInt)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        const exp = reader.expect(DOUBLE_TAG_SUFFIX);\r\n        if (!helper.merge(exp)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        this.val = readInt.data;\r\n        return helper.succeed(CorrectLevel.YES);\r\n    }\r\n}\r\n","import { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { CorrectLevel, parseFloatNBT } from \"../util/nbt-util\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport const FLOAT_TAG_SUFFIX = \"f\";\r\n\r\nexport class NBTTagFloat extends NBTTag<number> {\r\n    public tagType: \"float\" = \"float\";\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const readInt = parseFloatNBT(reader);\r\n        const helper = new ReturnHelper();\r\n        if (!helper.merge(readInt)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        const exp = reader.expect(FLOAT_TAG_SUFFIX);\r\n        if (!helper.merge(exp)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        this.val = readInt.data;\r\n        return helper.succeed(CorrectLevel.YES);\r\n    }\r\n}\r\n","import { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { CorrectLevel, parseIntNBT } from \"../util/nbt-util\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport class NBTTagInt extends NBTTag<number> {\r\n    public tagType: \"int\" = \"int\";\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const readInt = parseIntNBT(reader);\r\n        const helper = new ReturnHelper();\r\n        if (!helper.merge(readInt)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        this.val = readInt.data;\r\n        return helper.succeed(CorrectLevel.YES);\r\n    }\r\n}\r\n","import { CommandErrorBuilder } from \"../../../../brigadier/errors\";\r\nimport { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport {\r\n    ARRAY_END,\r\n    ARRAY_PREFIX_SEP,\r\n    ARRAY_START,\r\n    ARRAY_VALUE_SEP,\r\n    CorrectLevel\r\n} from \"../util/nbt-util\";\r\nimport { NBTTagInt } from \"./int-tag\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport const INT_ARRAY_PREFIX = \"I\";\r\n\r\nconst EXCEPTIONS = {\r\n    BAD_CHAR: new CommandErrorBuilder(\r\n        \"argument.nbt.intarray.badchar\",\r\n        \"Expected ',' or ']', got '%s'\"\r\n    ),\r\n    NO_VALUE: new CommandErrorBuilder(\r\n        \"argument.nbt.intarray.value\",\r\n        \"Expected value\"\r\n    )\r\n};\r\n\r\nexport class NBTTagIntArray extends NBTTag<NBTTagInt[]> {\r\n    public tagType: \"int_array\" = \"int_array\";\r\n\r\n    public tagEq(tag: NBTTag<any>): boolean {\r\n        if (tag.tagType !== this.tagType) {\r\n            return false;\r\n        }\r\n        const taga: NBTTagIntArray = tag as NBTTagIntArray;\r\n        return (\r\n            this.val.length === taga.getVal().length &&\r\n            this.val.every((v, i) => v.getVal() === taga.val[i].getVal())\r\n        );\r\n    }\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const helper = new ReturnHelper();\r\n        const start = reader.cursor;\r\n        const arrstart = reader.expect(\r\n            ARRAY_START + INT_ARRAY_PREFIX + ARRAY_PREFIX_SEP\r\n        );\r\n        if (!helper.merge(arrstart)) {\r\n            return helper.failWithData({ correct: CorrectLevel.NO });\r\n        }\r\n        if (!reader.canRead()) {\r\n            helper.addSuggestion(reader.cursor, ARRAY_END);\r\n            helper.addErrors(EXCEPTIONS.NO_VALUE.create(start, reader.cursor));\r\n            return helper.failWithData({ parsed: this, correct: 2 });\r\n        }\r\n        if (reader.peek() === ARRAY_END) {\r\n            reader.skip();\r\n            return helper.succeed(2);\r\n        }\r\n        let next = reader.peek();\r\n        while (next !== ARRAY_END) {\r\n            reader.skipWhitespace();\r\n\r\n            if (!reader.canRead()) {\r\n                helper.addErrors(\r\n                    EXCEPTIONS.NO_VALUE.create(start, reader.cursor)\r\n                );\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            }\r\n\r\n            reader.skipWhitespace();\r\n\r\n            const val = new NBTTagInt(0);\r\n            const parseResult = val.parse(reader);\r\n\r\n            helper.merge(parseResult);\r\n\r\n            this.val.push(val);\r\n\r\n            if (!reader.canRead()) {\r\n                helper.addErrors(\r\n                    EXCEPTIONS.NO_VALUE.create(start, reader.cursor)\r\n                );\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            }\r\n\r\n            reader.skipWhitespace();\r\n            const opt = reader.readOption(\r\n                [ARRAY_END, ARRAY_VALUE_SEP],\r\n                true,\r\n                undefined,\r\n                \"option\"\r\n            );\r\n            if (!helper.merge(opt)) {\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            } else {\r\n                next = opt.data;\r\n            }\r\n        }\r\n        return helper.succeed(CorrectLevel.YES);\r\n    }\r\n}\r\n","import { CommandErrorBuilder } from \"../../../../brigadier/errors\";\r\nimport { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { parseTag } from \"../tag-parser\";\r\nimport { LIST_END, LIST_START, LIST_VALUE_SEP } from \"../util/nbt-util\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nconst MIXED = new CommandErrorBuilder(\r\n    \"argument.nbt.list.mixed\",\r\n    \"Mixed value types\"\r\n);\r\nconst NOVAL = new CommandErrorBuilder(\r\n    \"argument.nbt.list.noval\",\r\n    \"Expected ']'\"\r\n);\r\n\r\nexport class NBTTagList extends NBTTag<Array<NBTTag<any>>> {\r\n    public tagType: \"list\" = \"list\";\r\n\r\n    public tagEq(tag: NBTTag<any>): boolean {\r\n        if (tag.tagType !== this.tagType) {\r\n            return false;\r\n        }\r\n        return (\r\n            this.val.length === (tag as NBTTagList).val.length &&\r\n            this.val.every((v, i) => v.tagEq((tag as NBTTagList).getVal()[i]))\r\n        );\r\n    }\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const start = reader.cursor;\r\n        const helper = new ReturnHelper();\r\n        const listStart = reader.expect(LIST_START);\r\n        if (!helper.merge(listStart)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        if (!reader.canRead()) {\r\n            helper.addSuggestion(reader.cursor, LIST_END);\r\n            helper.addErrors(NOVAL.create(start, reader.cursor));\r\n            return helper.failWithData({ parsed: this, correct: 2 });\r\n        }\r\n        if (reader.peek() === LIST_END) {\r\n            reader.skip();\r\n            return helper.succeed(2);\r\n        }\r\n        let type: NBTTag<any>[\"tagType\"] | undefined;\r\n        let next = reader.peek();\r\n        while (next !== LIST_END) {\r\n            reader.skipWhitespace();\r\n\r\n            let value: NBTTag<any>;\r\n\r\n            const tag = parseTag(reader);\r\n            if (helper.merge(tag)) {\r\n                value = tag.data;\r\n            } else {\r\n                if (tag.data.parsed) {\r\n                    this.val.push(tag.data.parsed);\r\n                }\r\n                return helper.failWithData({\r\n                    correct: 2,\r\n                    parsed: this,\r\n                    path: [\r\n                        (this.val.length - 1).toString(),\r\n                        ...(tag.data.path || [])\r\n                    ]\r\n                });\r\n            }\r\n\r\n            if (type === undefined) {\r\n                type = value.tagType;\r\n            } else if (type !== value.tagType) {\r\n                helper.addErrors(MIXED.create(start, reader.cursor));\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            }\r\n\r\n            this.val.push(value);\r\n\r\n            reader.skipWhitespace();\r\n            const opt = reader.readOption(\r\n                [LIST_END, LIST_VALUE_SEP],\r\n                true,\r\n                undefined,\r\n                \"option\"\r\n            );\r\n            if (!helper.merge(opt)) {\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            } else {\r\n                next = opt.data;\r\n            }\r\n        }\r\n        return helper.succeed(2);\r\n    }\r\n}\r\n","import { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { CorrectLevel, parseIntNBT } from \"../util/nbt-util\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport const LONG_TAG_SUFFIX = \"l\";\r\n\r\nexport class NBTTagLong extends NBTTag<number> {\r\n    public tagType: \"long\" = \"long\";\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const readInt = parseIntNBT(reader);\r\n        const helper = new ReturnHelper();\r\n        if (!helper.merge(readInt)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        const exp = reader.expect(LONG_TAG_SUFFIX);\r\n        if (!helper.merge(exp)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        this.val = readInt.data;\r\n        return helper.succeed(CorrectLevel.YES);\r\n    }\r\n}\r\n","import { CommandErrorBuilder } from \"../../../../brigadier/errors\";\r\nimport { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport {\r\n    ARRAY_END,\r\n    ARRAY_PREFIX_SEP,\r\n    ARRAY_START,\r\n    ARRAY_VALUE_SEP,\r\n    CorrectLevel\r\n} from \"../util/nbt-util\";\r\nimport { NBTTagLong } from \"./long-tag\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport const LONG_ARRAY_PREFIX = \"L\";\r\n\r\nconst EXCEPTIONS = {\r\n    BAD_CHAR: new CommandErrorBuilder(\r\n        \"argument.nbt.longarray.badchar\",\r\n        \"Expected ',' or ']', got '%s'\"\r\n    ),\r\n    NO_VALUE: new CommandErrorBuilder(\r\n        \"argument.nbt.longarray.value\",\r\n        \"Expected value\"\r\n    )\r\n};\r\n\r\nexport class NBTTagLongArray extends NBTTag<NBTTagLong[]> {\r\n    public tagType: \"long_array\" = \"long_array\";\r\n\r\n    public tagEq(tag: NBTTag<any>): boolean {\r\n        if (tag.tagType !== this.tagType) {\r\n            return false;\r\n        }\r\n        const taga: NBTTagLongArray = tag as NBTTagLongArray;\r\n        return (\r\n            this.val.length === taga.getVal().length &&\r\n            this.val.every((v, i) => v.getVal() === taga.val[i].getVal())\r\n        );\r\n    }\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const helper = new ReturnHelper();\r\n        const start = reader.cursor;\r\n        const arrstart = reader.expect(\r\n            ARRAY_START + LONG_ARRAY_PREFIX + ARRAY_PREFIX_SEP\r\n        );\r\n        if (!helper.merge(arrstart)) {\r\n            return helper.failWithData({ correct: CorrectLevel.NO });\r\n        }\r\n        if (!reader.canRead()) {\r\n            helper.addSuggestion(reader.cursor, ARRAY_END);\r\n            helper.addErrors(EXCEPTIONS.NO_VALUE.create(start, reader.cursor));\r\n            return helper.failWithData({ parsed: this, correct: 2 });\r\n        }\r\n        if (reader.peek() === ARRAY_END) {\r\n            reader.skip();\r\n            return helper.succeed(2);\r\n        }\r\n        let next = reader.peek();\r\n        while (next !== ARRAY_END) {\r\n            reader.skipWhitespace();\r\n\r\n            if (!reader.canRead()) {\r\n                helper.addErrors(\r\n                    EXCEPTIONS.NO_VALUE.create(start, reader.cursor)\r\n                );\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            }\r\n\r\n            reader.skipWhitespace();\r\n\r\n            const val = new NBTTagLong(0);\r\n            const parseResult = val.parse(reader);\r\n\r\n            helper.merge(parseResult);\r\n\r\n            this.val.push(val);\r\n\r\n            if (!reader.canRead()) {\r\n                helper.addErrors(\r\n                    EXCEPTIONS.NO_VALUE.create(start, reader.cursor)\r\n                );\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            }\r\n\r\n            reader.skipWhitespace();\r\n            const opt = reader.readOption(\r\n                [ARRAY_END, ARRAY_VALUE_SEP],\r\n                true,\r\n                undefined,\r\n                \"option\"\r\n            );\r\n            if (!helper.merge(opt)) {\r\n                return helper.failWithData({ parsed: this, correct: 2 });\r\n            } else {\r\n                next = opt.data;\r\n            }\r\n        }\r\n        return helper.succeed(CorrectLevel.YES);\r\n    }\r\n}\r\n","import { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { CorrectLevel, parseIntNBT } from \"../util/nbt-util\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nexport const SHORT_TAG_SUFFIX = \"s\";\r\n\r\nexport class NBTTagShort extends NBTTag<number> {\r\n    public tagType: \"short\" = \"short\";\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const readInt = parseIntNBT(reader);\r\n        const helper = new ReturnHelper();\r\n        if (!helper.merge(readInt)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        const exp = reader.expect(SHORT_TAG_SUFFIX);\r\n        if (!helper.merge(exp)) {\r\n            return helper.failWithData({ correct: 0 });\r\n        }\r\n        this.val = readInt.data;\r\n        return helper.succeed(CorrectLevel.YES);\r\n    }\r\n}\r\n","import { StringReader } from \"../../../brigadier/string-reader\";\r\nimport { isSuccessful, ReturnHelper } from \"../../../misc-functions\";\r\nimport { CE, ReturnedInfo } from \"../../../types\";\r\nimport { NBTTagByteArray } from \"./tag/byte-array-tag\";\r\nimport { NBTTagByte } from \"./tag/byte-tag\";\r\nimport { NBTTagCompound } from \"./tag/compound-tag\";\r\nimport { NBTTagDouble } from \"./tag/double-tag\";\r\nimport { NBTTagFloat } from \"./tag/float-tag\";\r\nimport { NBTTagIntArray } from \"./tag/int-array-tag\";\r\nimport { NBTTagInt } from \"./tag/int-tag\";\r\nimport { NBTTagList } from \"./tag/list-tag\";\r\nimport { NBTTagLongArray } from \"./tag/long-array-tag\";\r\nimport { NBTTagLong } from \"./tag/long-tag\";\r\nimport { NBTTag, ParseReturn } from \"./tag/nbt-tag\";\r\nimport { NBTTagShort } from \"./tag/short-tag\";\r\nimport { NBTTagString } from \"./tag/string-tag\";\r\nimport { CorrectLevel, NBTErrorData } from \"./util/nbt-util\";\r\n\r\nconst parsers: Array<() => NBTTag<any>> = [\r\n    () => new NBTTagByte(0),\r\n    () => new NBTTagShort(0),\r\n    () => new NBTTagLong(0),\r\n    () => new NBTTagFloat(0),\r\n    () => new NBTTagDouble(0),\r\n    () => new NBTTagInt(0),\r\n    () => new NBTTagByteArray([]),\r\n    () => new NBTTagIntArray([]),\r\n    () => new NBTTagLongArray([]),\r\n    () => new NBTTagCompound({}),\r\n    () => new NBTTagList([]),\r\n    () => new NBTTagString(\"\")\r\n];\r\n\r\nexport function parseTag(\r\n    reader: StringReader\r\n): ReturnedInfo<NBTTag<any>, CE, NBTErrorData> {\r\n    let correctTag: NBTTag<any> | undefined;\r\n    let correctness: CorrectLevel = 0;\r\n    let correctPlace: number = reader.cursor;\r\n\r\n    let lastResult: ParseReturn | undefined;\r\n    const helper = new ReturnHelper();\r\n\r\n    const start = reader.cursor;\r\n    for (const pf of parsers) {\r\n        const p = pf();\r\n        reader.cursor = start;\r\n        const out = p.parse(reader);\r\n        // @ts-ignore\r\n        if (isSuccessful(out)) {\r\n            if (out.data > correctness) {\r\n                lastResult = out;\r\n                correctPlace = reader.cursor;\r\n                correctness = out.data;\r\n                correctTag = p;\r\n            }\r\n        } else {\r\n            if (out.data.correct > correctness) {\r\n                lastResult = out;\r\n                correctPlace = reader.cursor;\r\n                correctness = out.data.correct;\r\n            }\r\n        }\r\n    }\r\n    // @ts-ignore\r\n    if (lastResult === undefined) {\r\n        return new ReturnHelper().failWithData({ correct: correctness });\r\n    }\r\n    if (helper.merge(lastResult)) {\r\n        if (correctTag === undefined) {\r\n            // This should never happen\r\n            return helper.failWithData({ correct: correctness });\r\n        } else {\r\n            reader.cursor = correctPlace;\r\n            return helper.succeed(correctTag);\r\n        }\r\n    } else {\r\n        return helper.failWithData(lastResult.data);\r\n    }\r\n}\r\n","import { CommandErrorBuilder } from \"../../../../brigadier/errors\";\r\nimport { StringReader } from \"../../../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../../../misc-functions\";\r\nimport { LineRange, ReturnedInfo } from \"../../../../types\";\r\nimport { parseTag } from \"../tag-parser\";\r\nimport {\r\n    isCompoundNode,\r\n    NBTNode,\r\n    NBTValidationInfo,\r\n    VALIDATION_ERRORS\r\n} from \"../util/doc-walker-util\";\r\nimport {\r\n    COMPOUND_END,\r\n    COMPOUND_KEY_VALUE_SEP,\r\n    COMPOUND_PAIR_SEP,\r\n    COMPOUND_START\r\n} from \"../util/nbt-util\";\r\nimport { NBTTag, ParseReturn } from \"./nbt-tag\";\r\n\r\nconst NO_KEY = new CommandErrorBuilder(\r\n    \"argument.nbt.compound.nokey\",\r\n    \"Expected key\"\r\n);\r\nconst NO_VAL = new CommandErrorBuilder(\r\n    \"argument.nbt.compound.noval\",\r\n    \"Expected value\"\r\n);\r\n\r\nexport interface KVPos {\r\n    key: string;\r\n    keyPos: LineRange;\r\n    valPos: LineRange;\r\n}\r\n\r\nexport class NBTTagCompound extends NBTTag<{ [key: string]: NBTTag<any> }> {\r\n    public tagType: \"compound\" = \"compound\";\r\n    private insertKeyPos = 0;\r\n\r\n    private kvpos: KVPos[] = [];\r\n\r\n    public getKeyPos(): KVPos[] {\r\n        return this.kvpos;\r\n    }\r\n\r\n    public tagEq(tag: NBTTag<any>): boolean {\r\n        if (tag.tagType !== this.tagType) {\r\n            return false;\r\n        }\r\n        return (\r\n            Object.keys(this.val).length === Object.keys(tag.getVal()).length &&\r\n            Object.keys(this.val).every(v =>\r\n                this.val[v].tagEq((tag as NBTTagCompound).val[v])\r\n            )\r\n        );\r\n    }\r\n\r\n    public validationResponse(\r\n        auxnode: NBTNode,\r\n        info: NBTValidationInfo\r\n    ): ReturnedInfo<undefined> {\r\n        const helper = new ReturnHelper();\r\n        const superResponse = super.validationResponse(auxnode, info);\r\n        if (!helper.merge(superResponse)) {\r\n            return helper.fail();\r\n        }\r\n        if (!isCompoundNode(auxnode)) {\r\n            // Mainly a type guard\r\n            return helper.fail();\r\n        }\r\n        const node = info.compoundMerge();\r\n        for (const k of this.kvpos) {\r\n            if (!info.extraChildren && !(k.key in (node.children || {}))) {\r\n                helper.addErrors(\r\n                    VALIDATION_ERRORS.noSuchChild.create(\r\n                        k.keyPos.start,\r\n                        k.valPos.end,\r\n                        k.key\r\n                    )\r\n                );\r\n            }\r\n        }\r\n        if (node.children) {\r\n            for (const c of Object.keys(node.children)) {\r\n                helper.addSuggestion(\r\n                    this.insertKeyPos,\r\n                    c,\r\n                    undefined,\r\n                    node.children[c].description\r\n                );\r\n            }\r\n        }\r\n        return helper.succeed();\r\n    }\r\n\r\n    protected readTag(reader: StringReader): ParseReturn {\r\n        const helper = new ReturnHelper();\r\n        const start = reader.cursor;\r\n        const compStart = reader.expect(COMPOUND_START);\r\n        if (!helper.merge(compStart)) {\r\n            return helper.failWithData({ correct: 0, parsed: this });\r\n        }\r\n        if (!reader.canRead()) {\r\n            this.insertKeyPos = reader.cursor;\r\n            helper.addSuggestion(reader.cursor, COMPOUND_END);\r\n            helper.addErrors(NO_KEY.create(start, reader.cursor));\r\n            return helper.failWithData({ parsed: this, correct: 2 });\r\n        }\r\n        if (reader.peek() === COMPOUND_END) {\r\n            reader.skip();\r\n            return helper.succeed(2);\r\n        }\r\n        let next = reader.peek();\r\n        const keys = [];\r\n        this.kvpos = [];\r\n        while (next !== COMPOUND_END) {\r\n            reader.skipWhitespace();\r\n\r\n            this.insertKeyPos = reader.cursor;\r\n\r\n            if (!reader.canRead()) {\r\n                helper.addErrors(NO_KEY.create(start, reader.cursor));\r\n                return helper.failWithData({\r\n                    correct: 2,\r\n                    parsed: this,\r\n                    path: []\r\n                });\r\n            }\r\n            const keyS = reader.cursor;\r\n            const key = reader.readString();\r\n            if (!helper.merge(key)) {\r\n                return helper.failWithData({\r\n                    correct: 2,\r\n                    parsed: this,\r\n                    path: []\r\n                });\r\n            }\r\n            const keyE = reader.cursor;\r\n            keys.push(key.data);\r\n\r\n            reader.skipWhitespace();\r\n\r\n            const kvs = reader.expect(COMPOUND_KEY_VALUE_SEP);\r\n            if (!helper.merge(kvs)) {\r\n                this.kvpos.push({\r\n                    key: key.data,\r\n                    keyPos: { start: keyS, end: keyE },\r\n                    valPos: { start: reader.cursor, end: reader.cursor }\r\n                });\r\n                return helper.failWithData({\r\n                    correct: 2,\r\n                    parsed: this,\r\n                    path: [key.data]\r\n                });\r\n            }\r\n\r\n            reader.skipWhitespace();\r\n\r\n            if (!reader.canRead()) {\r\n                this.kvpos.push({\r\n                    key: key.data,\r\n                    keyPos: { start: keyS, end: keyE },\r\n                    valPos: { start: reader.cursor, end: reader.cursor }\r\n                });\r\n                helper.addErrors(NO_VAL.create(keyS, reader.cursor));\r\n                return helper.failWithData({\r\n                    correct: 2,\r\n                    parsed: this,\r\n                    path: [key.data]\r\n                });\r\n            }\r\n\r\n            const valS = reader.cursor;\r\n\r\n            let val: NBTTag<any>;\r\n            const pkey = parseTag(reader);\r\n\r\n            this.kvpos.push({\r\n                key: key.data,\r\n                keyPos: { start: keyS, end: keyE },\r\n                valPos: { start: valS, end: reader.cursor }\r\n            });\r\n\r\n            if (helper.merge(pkey)) {\r\n                val = pkey.data;\r\n            } else {\r\n                const path = [key.data, ...(pkey.data.path || [])];\r\n                if (pkey.data.parsed) {\r\n                    this.val[key.data] = pkey.data.parsed;\r\n                }\r\n                return helper.failWithData({\r\n                    correct: 2,\r\n                    parsed: this,\r\n                    path\r\n                });\r\n            }\r\n\r\n            reader.skipWhitespace();\r\n\r\n            this.val[key.data] = val;\r\n\r\n            reader.skipWhitespace();\r\n\r\n            const opt = reader.readOption(\r\n                [COMPOUND_END, COMPOUND_PAIR_SEP],\r\n                true,\r\n                undefined,\r\n                \"option\"\r\n            );\r\n            if (!helper.merge(opt)) {\r\n                return helper.failWithData({\r\n                    correct: 2,\r\n                    parsed: this,\r\n                    path: [key.data]\r\n                });\r\n            } else {\r\n                next = opt.data;\r\n            }\r\n        }\r\n        return helper.succeed(2);\r\n    }\r\n}\r\n","export class ArrayReader {\r\n    private readonly arr: string[];\r\n    private index = 0;\r\n\r\n    public constructor(arr: string[]) {\r\n        this.arr = arr;\r\n    }\r\n\r\n    public end(): boolean {\r\n        return this.index === this.arr.length;\r\n    }\r\n\r\n    public getArray(): string[] {\r\n        return this.arr;\r\n    }\r\n\r\n    public getIndex(): number {\r\n        return this.index;\r\n    }\r\n\r\n    public getRead(): string[] {\r\n        return this.arr.slice(0, this.index);\r\n    }\r\n\r\n    public insert(val: string[], index: number = 0): void {\r\n        this.arr.splice(index, 0, ...val);\r\n    }\r\n\r\n    public peek(): string {\r\n        return this.arr[this.index];\r\n    }\r\n\r\n    public read(): string {\r\n        return this.arr[this.index++];\r\n    }\r\n\r\n    public setIndex(val: number): void {\r\n        this.index = val;\r\n    }\r\n\r\n    public skip(): void {\r\n        this.index++;\r\n    }\r\n}\r\n","import { isString } from \"util\";\r\nimport { ReturnHelper } from \"../../../misc-functions\";\r\nimport { ReturnedInfo } from \"../../../types\";\r\nimport { MemoryFS } from \"./doc-fs\";\r\nimport { runNodeFunction } from \"./doc-walker-func\";\r\nimport { NBTTagCompound } from \"./tag/compound-tag\";\r\nimport { NBTTagList } from \"./tag/list-tag\";\r\nimport { NBTTag } from \"./tag/nbt-tag\";\r\nimport { ArrayReader } from \"./util/array-reader\";\r\nimport {\r\n    CompoundNode,\r\n    FunctionNode,\r\n    isCompoundNode,\r\n    isFunctionNode,\r\n    isListNode,\r\n    isRefNode,\r\n    isRootNode,\r\n    isTypedNode,\r\n    ListNode,\r\n    NBTNode,\r\n    parseRefPath,\r\n    RefNode,\r\n    RootNode,\r\n    VALIDATION_ERRORS,\r\n    ValueList\r\n} from \"./util/doc-walker-util\";\r\n\r\ninterface ContextData<\r\n    N extends NBTNode = NBTNode,\r\n    T extends NBTTag<any> = NBTTag<any>\r\n> {\r\n    readonly allowRefWalk: boolean;\r\n    readonly finalValidation: boolean;\r\n    readonly node: N;\r\n    readonly path: string;\r\n    readonly reader: ArrayReader;\r\n    readonly tag?: T;\r\n}\r\n\r\n// tslint:disable:cyclomatic-complexity\r\nexport class NBTWalker {\r\n    private readonly docfs: MemoryFS;\r\n    private readonly extraChildren: boolean;\r\n    private readonly nbtvld: boolean;\r\n    private readonly parsed: NBTTag<any>;\r\n    private readonly root: string;\r\n\r\n    public constructor(\r\n        parsed: NBTTag<any>,\r\n        docfs: MemoryFS,\r\n        extraChild: boolean,\r\n        nbtvalidation: boolean = true,\r\n        root: string = \"root.json\"\r\n    ) {\r\n        this.docfs = docfs;\r\n        this.parsed = parsed;\r\n        this.extraChildren = extraChild;\r\n        this.root = root;\r\n        this.nbtvld = nbtvalidation;\r\n    }\r\n\r\n    public getFinalNode(nbtpath: string[]): ReturnedInfo<NBTNode> {\r\n        const node = this.docfs.get<NBTNode>(this.root);\r\n        const reader = new ArrayReader(nbtpath);\r\n        return this.getNextNode({\r\n            allowRefWalk: false,\r\n            finalValidation: true,\r\n            node,\r\n            path: this.root,\r\n            reader,\r\n            tag: this.nbtvld ? this.parsed : undefined\r\n        });\r\n    }\r\n\r\n    private evalRef(\r\n        ref: string,\r\n        path: string,\r\n        data: ContextData\r\n    ): ReturnedInfo<NBTNode> {\r\n        const [nextPath, fragPath] = parseRefPath(ref, path);\r\n        const reader = new ArrayReader(fragPath);\r\n        const node = this.docfs.get<NBTNode>(nextPath);\r\n        return this.getNextNode({\r\n            allowRefWalk: true,\r\n            finalValidation: false,\r\n            node,\r\n            path: nextPath,\r\n            reader,\r\n            tag: data.tag\r\n        });\r\n    }\r\n\r\n    private getNextNode(data: ContextData): ReturnedInfo<NBTNode> {\r\n        const { reader, node, tag, allowRefWalk, finalValidation } = data;\r\n        const helper = new ReturnHelper();\r\n        if (reader.end()) {\r\n            if (isRefNode(node)) {\r\n                return this.walkRefNode(data as ContextData<RefNode>);\r\n            } else if (isFunctionNode(node)) {\r\n                return this.walkFunctionNode(data as ContextData<FunctionNode>);\r\n            } else if (isCompoundNode(node)) {\r\n                if (finalValidation && this.nbtvld && tag) {\r\n                    const valres = tag.validationResponse(node, {\r\n                        compoundMerge: () =>\r\n                            this.mergeChildRef(data as ContextData<\r\n                                CompoundNode,\r\n                                NBTTagCompound\r\n                            >),\r\n                        extraChildren: this.extraChildren\r\n                    });\r\n                    if (!helper.merge(valres)) {\r\n                        return helper.fail();\r\n                    }\r\n                }\r\n                return helper.succeed(\r\n                    finalValidation\r\n                        ? this.mergeChildRef(data as ContextData<CompoundNode>)\r\n                        : node\r\n                );\r\n            } else {\r\n                if (finalValidation && this.nbtvld && tag) {\r\n                    const valres = tag.validationResponse(node);\r\n                    if (!helper.merge(valres)) {\r\n                        return helper.fail();\r\n                    }\r\n                }\r\n                return helper.succeed(node);\r\n            }\r\n        } else if (\r\n            allowRefWalk &&\r\n            node.references &&\r\n            reader.peek() in node.references\r\n        ) {\r\n            const next = reader.read();\r\n            return this.getNextNode({\r\n                ...data,\r\n                node: node.references[next]\r\n            });\r\n        } else if (isTypedNode(node)) {\r\n            if (isCompoundNode(node)) {\r\n                if (this.nbtvld && tag) {\r\n                    const valres = tag.validationResponse(node, {\r\n                        compoundMerge: () =>\r\n                            this.mergeChildRef(data as ContextData<\r\n                                CompoundNode\r\n                            >),\r\n                        extraChildren: this.extraChildren\r\n                    });\r\n                    if (!helper.merge(valres)) {\r\n                        return helper.fail();\r\n                    }\r\n                }\r\n                if (tag && !(tag instanceof NBTTagCompound)) {\r\n                    return helper.fail();\r\n                }\r\n                return this.walkCompoundNode(data as ContextData<\r\n                    CompoundNode,\r\n                    NBTTagCompound\r\n                >);\r\n            } else if (isListNode(node)) {\r\n                if (this.nbtvld && tag) {\r\n                    const valres = tag.validationResponse(node);\r\n                    if (!helper.merge(valres)) {\r\n                        return helper.fail();\r\n                    }\r\n                }\r\n                if (tag && !(tag instanceof NBTTagList)) {\r\n                    return helper.fail();\r\n                }\r\n                return this.walkListNode(data as ContextData<\r\n                    ListNode,\r\n                    NBTTagList\r\n                >);\r\n            } else if (isRootNode(node)) {\r\n                return this.walkRootNode(data as ContextData<RootNode>);\r\n            } else {\r\n                if (tag) {\r\n                    const valres = tag.validationResponse(node);\r\n                    helper.merge(valres);\r\n                }\r\n                return helper.fail();\r\n            }\r\n        } else {\r\n            if (isRefNode(node)) {\r\n                return this.walkRefNode(data as ContextData<RefNode>);\r\n            } else if (isFunctionNode(node)) {\r\n                return this.walkFunctionNode(data as ContextData<FunctionNode>);\r\n            }\r\n        }\r\n        return helper.fail();\r\n    }\r\n\r\n    private mergeChildRef(data: ContextData<CompoundNode>): CompoundNode {\r\n        const { node, path: currentPath } = data;\r\n        if (!node.child_ref) {\r\n            return node;\r\n        }\r\n        const helper = new ReturnHelper();\r\n        const newChildren = JSON.parse(\r\n            JSON.stringify(node.children || {})\r\n        ) as Exclude<CompoundNode[\"children\"], undefined>;\r\n        for (const ref of node.child_ref) {\r\n            const [nextPath] = parseRefPath(ref, currentPath);\r\n            const refNode = this.evalRef(ref, currentPath, data);\r\n            if (!helper.merge(refNode)) {\r\n                continue;\r\n            } else if (isCompoundNode(refNode.data)) {\r\n                const evalNode = this.mergeChildRef({\r\n                    ...data,\r\n                    node: refNode.data,\r\n                    path: nextPath\r\n                });\r\n                if (evalNode.children) {\r\n                    for (const child of Object.keys(evalNode.children)) {\r\n                        newChildren[child] = evalNode.children[child];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            children: newChildren,\r\n            description: node.description,\r\n            suggestions: node.suggestions,\r\n            type: \"compound\"\r\n        };\r\n    }\r\n\r\n    private walkCompoundNode(\r\n        data: ContextData<CompoundNode, NBTTagCompound>\r\n    ): ReturnedInfo<NBTNode> {\r\n        const { node, reader, path, tag } = data;\r\n        const helper = new ReturnHelper();\r\n        const next = reader.read();\r\n        if (node.children && next in node.children) {\r\n            /* \r\n             * It is safe to assume that next is in the tag\r\n             * val because the path is based off of the tag\r\n             */\r\n            return this.getNextNode({\r\n                ...data,\r\n                node: node.children[next],\r\n                tag: tag ? tag.getVal()[next] : undefined\r\n            });\r\n        } else if (node.child_ref) {\r\n            for (const c of node.child_ref) {\r\n                const [nextPath] = parseRefPath(c, path);\r\n                const cnode = this.evalRef(c, path, data);\r\n                if (\r\n                    helper.merge(cnode) &&\r\n                    isCompoundNode(cnode.data) &&\r\n                    cnode.data.children &&\r\n                    next in cnode.data.children\r\n                ) {\r\n                    return this.getNextNode({\r\n                        ...data,\r\n                        node: cnode.data.children[next],\r\n                        path: nextPath,\r\n                        tag: tag ? tag.getVal()[next] : undefined\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        return helper.fail();\r\n    }\r\n\r\n    private walkFunctionNode(\r\n        data: ContextData<FunctionNode>\r\n    ): ReturnedInfo<NBTNode> {\r\n        const { node, reader, path } = data;\r\n        const helper = new ReturnHelper();\r\n        const ref = runNodeFunction(this.parsed, reader.getRead(), node);\r\n        const [nextPath] = parseRefPath(ref, path);\r\n        const newNode = this.evalRef(ref, path, data);\r\n        if (!helper.merge(newNode)) {\r\n            return helper.fail();\r\n        }\r\n        return this.getNextNode({\r\n            ...data,\r\n            node: newNode.data,\r\n            path: nextPath\r\n        });\r\n    }\r\n\r\n    private walkListNode(\r\n        data: ContextData<ListNode, NBTTagList>\r\n    ): ReturnedInfo<NBTNode> {\r\n        const { node, reader, tag } = data;\r\n        const next = reader.read();\r\n        if (!/\\d+/.test(next)) {\r\n            return new ReturnHelper().fail(\r\n                tag\r\n                    ? VALIDATION_ERRORS.badIndex.create(\r\n                          tag.getRange().start,\r\n                          tag.getRange().end\r\n                      )\r\n                    : undefined\r\n            );\r\n        }\r\n        const nextTag = tag\r\n            ? tag.getVal()[Number.parseInt(next, 10)]\r\n            : undefined;\r\n        return this.getNextNode({\r\n            ...data,\r\n            node: node.item,\r\n            tag: nextTag\r\n        });\r\n    }\r\n\r\n    private walkRefNode(data: ContextData<RefNode>): ReturnedInfo<NBTNode> {\r\n        const { node, path } = data;\r\n        const helper = new ReturnHelper();\r\n        const [nextPath] = parseRefPath(node.ref, path);\r\n        const nnode = this.evalRef(node.ref, path, data);\r\n        if (helper.merge(nnode)) {\r\n            const out = this.getNextNode({\r\n                ...data,\r\n                node: nnode.data,\r\n                path: nextPath\r\n            });\r\n            if (helper.merge(out)) {\r\n                return helper.succeed(out.data);\r\n            } else {\r\n                return helper.fail();\r\n            }\r\n        } else {\r\n            return helper.fail();\r\n        }\r\n    }\r\n\r\n    private walkRootNode(data: ContextData<RootNode>): ReturnedInfo<NBTNode> {\r\n        const { node, reader, path } = data;\r\n        const next = reader.read();\r\n        if (next in node.children) {\r\n            return this.getNextNode({ ...data, node: node.children[next] });\r\n        } else {\r\n            for (const key of Object.keys(node.children)) {\r\n                if (key.startsWith(\"$\")) {\r\n                    const ref = key.substring(1);\r\n                    const [nextPath] = parseRefPath(ref, path);\r\n                    const list = this.docfs.get<ValueList>(nextPath);\r\n                    if (\r\n                        list.find(\r\n                            v => (isString(v) ? v === next : v.value === next)\r\n                        )\r\n                    ) {\r\n                        return this.getNextNode({\r\n                            ...data,\r\n                            node: node.children[key]\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return new ReturnHelper().fail();\r\n    }\r\n}\r\n","import { isArray } from \"util\";\r\nimport { StringReader } from \"../../../brigadier/string-reader\";\r\nimport { isSuccessful, ReturnHelper } from \"../../../misc-functions\";\r\nimport { ContextPath, resolvePaths } from \"../../../misc-functions/context\";\r\nimport { Parser, ParserInfo, ReturnedInfo } from \"../../../types\";\r\nimport { NBTWalker } from \"./doc-walker\";\r\nimport { NBTTagCompound } from \"./tag/compound-tag\";\r\n\r\ntype CtxPathFunc = (args: string[]) => NBTContextData;\r\n\r\nexport interface NBTContextData {\r\n    id?: string | string[];\r\n    type: \"entity\" | \"item\" | \"block\";\r\n}\r\n\r\nconst paths: Array<ContextPath<CtxPathFunc>> = [\r\n    {\r\n        data: () => ({\r\n            type: \"entity\"\r\n        }),\r\n        path: [\"data\", \"merge\", \"entity\", \"target\", \"nbt\"]\r\n    },\r\n    {\r\n        data: () => ({\r\n            type: \"block\"\r\n        }),\r\n        path: [\"data\", \"merge\", \"block\", \"pos\", \"nbt\"]\r\n    },\r\n    {\r\n        data: args => ({\r\n            id: args[1],\r\n            type: \"entity\"\r\n        }),\r\n        path: [\"summon\", \"entity\", \"pos\", \"nbt\"]\r\n    }\r\n];\r\n\r\nexport function parseNBT(\r\n    reader: StringReader,\r\n    info: ParserInfo,\r\n    data?: NBTContextData\r\n): ReturnedInfo<undefined> {\r\n    const helper = new ReturnHelper();\r\n    const tag = new NBTTagCompound({});\r\n    const docFS = info.data.globalData.nbt_docs;\r\n    const reply = tag.parse(reader);\r\n\r\n    if (helper.merge(reply)) {\r\n        return helper.succeed();\r\n    } else {\r\n        if (!!data) {\r\n            const walker = new NBTWalker(\r\n                reply.data.parsed || new NBTTagCompound({}),\r\n                docFS,\r\n                data.type === \"item\"\r\n            );\r\n            if (isArray(data.id)) {\r\n                for (const k of data.id) {\r\n                    const node = walker.getFinalNode([\r\n                        data.type,\r\n                        k,\r\n                        ...(reply.data.path || [])\r\n                    ]);\r\n                    if (isSuccessful(node)) {\r\n                        helper.mergeChain(node);\r\n                    } else {\r\n                        helper.mergeChain(node, false);\r\n                    }\r\n                }\r\n                return helper.fail();\r\n            } else {\r\n                const node = walker.getFinalNode([\r\n                    data.type,\r\n                    data.id || \"none\",\r\n                    ...(reply.data.path || [])\r\n                ]);\r\n                return helper.mergeChain(node).fail();\r\n            }\r\n        } else {\r\n            return helper.fail();\r\n        }\r\n    }\r\n}\r\n\r\nexport const parser: Parser = {\r\n    parse: (reader, prop) => {\r\n        const helper = new ReturnHelper(prop);\r\n        const ctxdatafn = resolvePaths(paths, prop.path || []);\r\n        const data = !ctxdatafn ? undefined : ctxdatafn([]);\r\n        if (helper.merge(parseNBT(reader, prop, data))) {\r\n            return helper.succeed();\r\n        } else {\r\n            return helper.fail();\r\n        }\r\n    }\r\n};\r\n","import {\r\n    CompletionItemKind,\r\n    DiagnosticSeverity\r\n} from \"vscode-languageserver/lib/main\";\r\n\r\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { StringReader } from \"../../brigadier/string-reader\";\r\nimport {\r\n    BlocksPropertyInfo,\r\n    NamespacedName,\r\n    SingleBlockPropertyInfo\r\n} from \"../../data/types\";\r\nimport {\r\n    namespaceSuggestionString,\r\n    ReturnHelper,\r\n    stringifyNamespace\r\n} from \"../../misc-functions\";\r\nimport {\r\n    buildTagActions,\r\n    parseNamespaceOrTag\r\n} from \"../../misc-functions/parsing/nmsp-tag\";\r\nimport { Parser, ParserInfo, ReturnedInfo, Suggestion } from \"../../types\";\r\nimport { parseNBT } from \"./nbt/nbt\";\r\n\r\nexport const predicateParser: Parser = {\r\n    parse: (reader, info) => parseBlockArgument(reader, info, true)\r\n};\r\n\r\nexport const stateParser: Parser = {\r\n    parse: (reader, info) => parseBlockArgument(reader, info, false)\r\n};\r\n\r\ninterface PropertyExceptions {\r\n    duplicate: CommandErrorBuilder;\r\n    invalid: CommandErrorBuilder;\r\n    novalue: CommandErrorBuilder;\r\n    unknown: CommandErrorBuilder;\r\n}\r\n\r\nconst exceptions = {\r\n    block_properties: {\r\n        duplicate: new CommandErrorBuilder(\r\n            \"argument.block.property.duplicate\",\r\n            \"Property '%s' can only be set once for block %s\"\r\n        ),\r\n        invalid: new CommandErrorBuilder(\r\n            \"argument.block.property.invalid\",\r\n            \"Block %s does not accept '%s' for %s property\"\r\n        ),\r\n        novalue: new CommandErrorBuilder(\r\n            \"argument.block.property.novalue\",\r\n            \"Expected value for property '%s' on block %s\"\r\n        ),\r\n        unknown: new CommandErrorBuilder(\r\n            \"argument.block.property.unknown\",\r\n            \"Block %s does not have property '%s'\"\r\n        )\r\n    },\r\n    invalid_block: new CommandErrorBuilder(\r\n        \"argument.block.id.invalid\",\r\n        \"Unknown block type '%s'\"\r\n    ),\r\n    no_tags: new CommandErrorBuilder(\r\n        \"argument.block.tag.disallowed\",\r\n        \"Tags aren't allowed here, only actual blocks\"\r\n    ),\r\n    tag_properties: {\r\n        duplicate: new CommandErrorBuilder(\r\n            \"argument.block_tag.property.duplicate\",\r\n            \"Property '%s' can only be set once for block tag %s\"\r\n        ),\r\n        invalid: new CommandErrorBuilder(\r\n            \"argument.block_tag.property.invalid\",\r\n            \"Block tag %s does not accept '%s' for %s property\"\r\n        ),\r\n        novalue: new CommandErrorBuilder(\r\n            \"argument.block_tag.property.novalue\",\r\n            \"Expected value for property '%s' on block tag %s\"\r\n        ),\r\n        unknown: new CommandErrorBuilder(\r\n            \"argument.block_tag.property.unknown\",\r\n            \"Block tag %s does not have property '%s'\"\r\n        )\r\n    },\r\n    unknown_properties: {\r\n        duplicate: new CommandErrorBuilder(\r\n            \"argument.unknown_block_tag.property.duplicate\",\r\n            \"Property '%s' can only be set once for unknown block tag %s\"\r\n        ),\r\n        invalid: new CommandErrorBuilder(\r\n            \"argument.unknown_block_tag.property.invalid\",\r\n            \"Unknown block tag %s might not accept '%s' for %s property\",\r\n            DiagnosticSeverity.Warning\r\n        ),\r\n        novalue: new CommandErrorBuilder(\r\n            \"argument.unknown_block_tag.property.novalue\",\r\n            \"Expected value for property '%s' on unknown block tag %s\"\r\n        ),\r\n        unknown: new CommandErrorBuilder(\r\n            \"argument.unknown_block_tag.property.unknown\",\r\n            \"Unknown block tag %s might not have property '%s'\",\r\n            DiagnosticSeverity.Warning\r\n        )\r\n    },\r\n\r\n    unclosed_props: new CommandErrorBuilder(\r\n        \"argument.block.property.unclosed\",\r\n        \"Expected closing ] for block state properties\"\r\n    ),\r\n\r\n    unknown_tag: new CommandErrorBuilder(\r\n        \"arguments.block.tag.unknown\", // Argument_s_ [sic]\r\n        \"Unknown block tag '%s'\"\r\n    )\r\n};\r\n\r\n// tslint:disable:cyclomatic-complexity\r\nexport function parseBlockArgument(\r\n    reader: StringReader,\r\n    info: ParserInfo,\r\n    tags: boolean\r\n): ReturnedInfo<undefined> {\r\n    const helper = new ReturnHelper(info);\r\n    const start = reader.cursor;\r\n    const tagHandling = tags ? \"block_tags\" : exceptions.no_tags;\r\n    const parsed = parseNamespaceOrTag(reader, info, tagHandling);\r\n    let stringifiedName: string | undefined;\r\n    if (helper.merge(parsed)) {\r\n        const parsedResult = parsed.data;\r\n        if (parsedResult.resolved && parsedResult.values) {\r\n            stringifiedName = `#${stringifyNamespace(parsedResult.parsed)}`;\r\n            helper.merge(\r\n                buildTagActions(\r\n                    parsedResult.values,\r\n                    start + 1,\r\n                    reader.cursor,\r\n                    \"block_tags\",\r\n                    info.data.localData\r\n                )\r\n            );\r\n            const props = constructProperties(\r\n                parsedResult.resolved,\r\n                info.data.globalData.blocks\r\n            );\r\n            const propsResult = parseProperties(\r\n                reader,\r\n                props || {},\r\n                exceptions.tag_properties,\r\n                stringifiedName\r\n            );\r\n            if (!helper.merge(propsResult)) {\r\n                return helper.fail();\r\n            }\r\n            if (reader.peek() === \"{\") {\r\n                const nbt = parseNBT(reader, info, {\r\n                    id: (parsedResult.resolved || []).map(stringifyNamespace),\r\n                    type: \"block\"\r\n                });\r\n                if (!helper.merge(nbt)) {\r\n                    return helper.fail();\r\n                }\r\n            } else {\r\n                helper.addSuggestion(reader.cursor, \"{\");\r\n            }\r\n        } else {\r\n            stringifiedName = stringifyNamespace(parsed.data.parsed);\r\n            if (info.suggesting && !reader.canRead()) {\r\n                helper.addSuggestions(\r\n                    ...namespaceSuggestionString(\r\n                        Object.keys(info.data.globalData.blocks),\r\n                        parsed.data.parsed,\r\n                        start\r\n                    )\r\n                );\r\n            }\r\n            const props = info.data.globalData.blocks[stringifiedName];\r\n            if (!props) {\r\n                helper.addErrors(\r\n                    exceptions.invalid_block.create(start, reader.cursor)\r\n                );\r\n            }\r\n            const result = parseProperties(\r\n                reader,\r\n                props || {},\r\n                exceptions.block_properties,\r\n                stringifiedName\r\n            );\r\n            if (!helper.merge(result)) {\r\n                return helper.fail();\r\n            }\r\n            if (reader.peek() === \"{\") {\r\n                const nbt = parseNBT(reader, info, {\r\n                    id: props ? stringifiedName : \"none\",\r\n                    type: \"block\"\r\n                });\r\n                if (!helper.merge(nbt)) {\r\n                    return helper.fail();\r\n                }\r\n            } else {\r\n                helper.addSuggestion(reader.cursor, \"{\");\r\n            }\r\n        }\r\n    } else {\r\n        if (parsed.data) {\r\n            helper.addErrors(\r\n                exceptions.unknown_tag.create(\r\n                    start,\r\n                    reader.cursor,\r\n                    stringifyNamespace(parsed.data)\r\n                )\r\n            );\r\n            stringifiedName = `#${stringifyNamespace(parsed.data)}`;\r\n            const propsResult = parseProperties(\r\n                reader,\r\n                {},\r\n                exceptions.unknown_properties,\r\n                stringifiedName\r\n            );\r\n            if (!helper.merge(propsResult)) {\r\n                return helper.fail();\r\n            }\r\n            if (reader.peek() === \"{\") {\r\n                const nbt = parseNBT(reader, info, {\r\n                    id: \"none\",\r\n                    type: \"block\"\r\n                });\r\n                if (!helper.merge(nbt)) {\r\n                    return helper.fail();\r\n                }\r\n            } else {\r\n                helper.addSuggestion(reader.cursor, \"{\");\r\n            }\r\n        } else {\r\n            // Parsing of the namespace failed\r\n            return helper.fail();\r\n        }\r\n    }\r\n    return helper.succeed();\r\n}\r\n\r\n// Ugly call signature. Need to see how upstream handles tag properties.\r\n// At the moment, it is very broken\r\nfunction parseProperties(\r\n    reader: StringReader,\r\n    options: SingleBlockPropertyInfo,\r\n    errors: PropertyExceptions,\r\n    name: string\r\n): ReturnedInfo<Map<string, string>> {\r\n    const helper = new ReturnHelper();\r\n    const result = new Map<string, string>();\r\n    if (reader.peek() === \"[\") {\r\n        const start = reader.cursor;\r\n        reader.skip();\r\n        const props = Object.keys(options);\r\n        reader.skipWhitespace();\r\n        while (reader.canRead() && reader.peek() !== \"]\") {\r\n            reader.skipWhitespace();\r\n            const propStart = reader.cursor;\r\n            const propParse = reader.readOption(\r\n                props,\r\n                false,\r\n                CompletionItemKind.Property\r\n            );\r\n            const propKey = propParse.data;\r\n            const propSuccessful = helper.merge(propParse);\r\n            if (propKey === false) {\r\n                // Strange order allows better type checker reasoning\r\n                // Parsing failed\r\n                return helper.fail();\r\n            }\r\n            if (!propSuccessful) {\r\n                helper.addErrors(\r\n                    errors.unknown.create(\r\n                        propStart,\r\n                        reader.cursor,\r\n                        name,\r\n                        propKey\r\n                    )\r\n                );\r\n            }\r\n            if (result.has(propKey)) {\r\n                helper.addErrors(\r\n                    errors.duplicate.create(\r\n                        propStart,\r\n                        reader.cursor,\r\n                        propKey,\r\n                        name\r\n                    )\r\n                );\r\n            }\r\n            reader.skipWhitespace();\r\n            if (!reader.canRead() || reader.peek() !== \"=\") {\r\n                return helper.fail(\r\n                    errors.novalue.create(\r\n                        propStart,\r\n                        reader.cursor,\r\n                        propKey,\r\n                        name\r\n                    )\r\n                );\r\n            }\r\n            reader.skip();\r\n            reader.skipWhitespace();\r\n            const valueStart = reader.cursor;\r\n            const valueParse = reader.readOption(\r\n                options[propKey] || [],\r\n                false,\r\n                CompletionItemKind.EnumMember\r\n            );\r\n            const valueSuccessful = helper.merge(valueParse);\r\n            const value = valueParse.data;\r\n            if (value === false) {\r\n                return helper.fail();\r\n            }\r\n            const error = errors.invalid.create(\r\n                valueStart,\r\n                reader.cursor,\r\n                name,\r\n                value,\r\n                propKey\r\n            );\r\n            const adderrorIf = (b: boolean) =>\r\n                b && propSuccessful && !valueSuccessful\r\n                    ? helper.addErrors(error)\r\n                    : undefined;\r\n            adderrorIf(value.length > 0);\r\n            result.set(propKey, value);\r\n            reader.skipWhitespace();\r\n            if (reader.canRead()) {\r\n                if (reader.peek() === \",\") {\r\n                    adderrorIf(value.length === 0);\r\n                    reader.skip();\r\n                    continue;\r\n                }\r\n                if (reader.peek() === \"]\") {\r\n                    adderrorIf(value.length === 0);\r\n                    break;\r\n                }\r\n            }\r\n            return helper.fail(\r\n                exceptions.unclosed_props.create(start, reader.cursor)\r\n            );\r\n        }\r\n        if (!reader.canRead()) {\r\n            helper.addSuggestions(\r\n                ...props.map<Suggestion>(prop => ({\r\n                    kind: CompletionItemKind.Property,\r\n                    start: reader.cursor,\r\n                    text: prop\r\n                }))\r\n            );\r\n            return helper.fail(\r\n                exceptions.unclosed_props.create(start, reader.cursor)\r\n            );\r\n        }\r\n        reader.expect(\"]\"); // Sanity check\r\n    }\r\n    return helper.succeed(result);\r\n}\r\n\r\nfunction constructProperties(\r\n    options: NamespacedName[],\r\n    blocks: BlocksPropertyInfo\r\n): SingleBlockPropertyInfo {\r\n    const result: SingleBlockPropertyInfo = {};\r\n    for (const blockName of options) {\r\n        const stringified = stringifyNamespace(blockName);\r\n        const block = blocks[stringified];\r\n        if (block) {\r\n            for (const prop in block) {\r\n                if (block.hasOwnProperty(prop)) {\r\n                    result[prop] = Array.from(\r\n                        new Set((result[prop] || []).concat(block[prop]))\r\n                    );\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { StringReader } from \"../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../misc-functions\";\r\nimport { Parser, ParserInfo, ReturnedInfo } from \"../../types\";\r\n\r\nconst MIXED = new CommandErrorBuilder(\r\n    \"argument.pos.mixed\",\r\n    \"Cannot mix world & local coordinates (everything must either use ^ or not)\"\r\n);\r\n\r\nconst INCOMPLETE = new CommandErrorBuilder(\r\n    \"argument.pos.incomplete\",\r\n    \"Incomplete position argument. Only %s coords are present, when %s should be\"\r\n);\r\n\r\nconst NO_LOCAL = new CommandErrorBuilder(\r\n    \"argument.pos.nolocal\",\r\n    \"Local coords are not allowed\"\r\n);\r\n\r\nconst LOCAL = \"^\";\r\nconst RELATIVE = \"~\";\r\n\r\nexport interface CoordRules {\r\n    count: 2 | 3;\r\n    float: boolean;\r\n    local: boolean;\r\n}\r\n\r\nconst fail = (\r\n    reader: StringReader,\r\n    helper: ReturnHelper,\r\n    count: number,\r\n    hasWorld: boolean,\r\n    hasLocal: boolean,\r\n    start: number,\r\n    i: number\r\n) => {\r\n    if (!hasWorld) {\r\n        helper.addSuggestions({\r\n            start: reader.cursor,\r\n            text: LOCAL\r\n        });\r\n    }\r\n    if (!hasLocal) {\r\n        helper.addSuggestions({\r\n            start: reader.cursor,\r\n            text: RELATIVE\r\n        });\r\n    }\r\n    return helper.fail(\r\n        INCOMPLETE.create(\r\n            start,\r\n            reader.cursor,\r\n            (i + 1).toString(),\r\n            count.toString()\r\n        )\r\n    );\r\n};\r\n\r\nexport class CoordParser implements Parser {\r\n    private readonly rules: CoordRules;\r\n\r\n    public constructor(rules: CoordRules) {\r\n        this.rules = rules;\r\n    }\r\n\r\n    public parse(\r\n        reader: StringReader,\r\n        info: ParserInfo\r\n    ): ReturnedInfo<undefined> {\r\n        const helper = new ReturnHelper(info);\r\n        let hasLocal = false;\r\n        let hasWorld = false;\r\n        const start = reader.cursor;\r\n        for (let i = 0; i < this.rules.count; i++) {\r\n            if (!reader.canRead()) {\r\n                return fail(\r\n                    reader,\r\n                    helper,\r\n                    this.rules.count,\r\n                    hasWorld,\r\n                    hasLocal,\r\n                    start,\r\n                    0\r\n                );\r\n            }\r\n\r\n            const cstart = reader.cursor;\r\n            switch (reader.peek()) {\r\n                case RELATIVE:\r\n                    hasWorld = true;\r\n                    reader.skip();\r\n                    if (!helper.merge(this.parseNumber(reader))) {\r\n                        return helper.fail();\r\n                    }\r\n                    if (hasLocal) {\r\n                        helper.addErrors(MIXED.create(cstart, reader.cursor));\r\n                    }\r\n                    break;\r\n                case LOCAL:\r\n                    if (!this.rules.local) {\r\n                        helper.addErrors(\r\n                            NO_LOCAL.create(reader.cursor, reader.cursor + 1)\r\n                        );\r\n                    }\r\n                    hasLocal = true;\r\n                    reader.skip();\r\n                    if (!helper.merge(this.parseNumber(reader))) {\r\n                        return helper.fail();\r\n                    }\r\n                    if (hasWorld) {\r\n                        helper.addErrors(MIXED.create(cstart, reader.cursor));\r\n                    }\r\n                    break;\r\n                default:\r\n                    hasWorld = true;\r\n                    if (!helper.merge(this.parseNumber(reader, false))) {\r\n                        return helper.fail();\r\n                    }\r\n                    if (hasLocal) {\r\n                        helper.addErrors(MIXED.create(cstart, reader.cursor));\r\n                    }\r\n            }\r\n\r\n            if (\r\n                i < this.rules.count - 1 &&\r\n                (!reader.canRead() || !helper.merge(reader.expect(\" \")))\r\n            ) {\r\n                return fail(\r\n                    reader,\r\n                    helper,\r\n                    this.rules.count,\r\n                    hasWorld,\r\n                    hasLocal,\r\n                    start,\r\n                    i\r\n                );\r\n            }\r\n        }\r\n        return helper.succeed();\r\n    }\r\n\r\n    private parseNumber(\r\n        reader: StringReader,\r\n        allowBlank: boolean = true\r\n    ): ReturnedInfo<number> {\r\n        if ((!reader.canRead() || reader.peek().match(/\\s/)) && allowBlank) {\r\n            return new ReturnHelper().succeed(0);\r\n        }\r\n        return this.rules.float ? reader.readFloat() : reader.readInt();\r\n    }\r\n}\r\n\r\nexport const rotation = new CoordParser({\r\n    count: 2,\r\n    float: true,\r\n    local: false\r\n});\r\n\r\nexport const vec2 = new CoordParser({\r\n    count: 2,\r\n    float: true,\r\n    local: true\r\n});\r\n\r\nexport const vec3 = new CoordParser({\r\n    count: 3,\r\n    float: true,\r\n    local: true\r\n});\r\n\r\nexport const blockPos = new CoordParser({\r\n    count: 3,\r\n    float: false,\r\n    local: true\r\n});\r\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { StringReader } from \"../../brigadier/string-reader\";\r\nimport {\r\n    buildTagActions,\r\n    namespaceSuggestionString,\r\n    parseNamespaceOrTag,\r\n    ReturnHelper,\r\n    stringifyNamespace\r\n} from \"../../misc-functions\";\r\nimport { Parser, ParserInfo, ReturnedInfo } from \"../../types\";\r\nimport { parseNBT } from \"./nbt/nbt\";\r\n\r\nconst NOTAG = new CommandErrorBuilder(\r\n    \"argument.item.tag.disallowed\",\r\n    \"Tags aren't allowed here, only actual items\"\r\n);\r\n\r\nconst UNKNOWNTAG = new CommandErrorBuilder(\r\n    \"arguments.item.tag.unknown\",\r\n    \"Unknown item tag '%s'\"\r\n);\r\n\r\nconst UNKNOWNITEM = new CommandErrorBuilder(\r\n    \"argument.item.id.invalid\",\r\n    \"Unknown item '%s'\"\r\n);\r\n\r\nexport class ItemParser implements Parser {\r\n    private readonly useTags: boolean;\r\n\r\n    public constructor(useTags: boolean) {\r\n        this.useTags = useTags;\r\n    }\r\n\r\n    public parse(\r\n        reader: StringReader,\r\n        properties: ParserInfo\r\n    ): ReturnedInfo<undefined> {\r\n        const helper = new ReturnHelper(properties);\r\n        const start = reader.cursor;\r\n        const parsed = parseNamespaceOrTag(\r\n            reader,\r\n            properties,\r\n            this.useTags ? \"item_tags\" : NOTAG\r\n        );\r\n        if (helper.merge(parsed)) {\r\n            const items: string[] = [];\r\n            if (parsed.data.resolved && parsed.data.values) {\r\n                helper.merge(\r\n                    buildTagActions(\r\n                        parsed.data.values,\r\n                        start + 1,\r\n                        reader.cursor,\r\n                        \"item_tags\",\r\n                        properties.data.localData\r\n                    )\r\n                );\r\n                parsed.data.values.forEach(v => {\r\n                    items.push(...(v.data || { values: [] }).values);\r\n                });\r\n            } else {\r\n                if (properties.suggesting && !reader.canRead()) {\r\n                    helper.addSuggestions(\r\n                        ...namespaceSuggestionString(\r\n                            properties.data.globalData.items,\r\n                            parsed.data.parsed,\r\n                            start\r\n                        )\r\n                    );\r\n                }\r\n                const name = stringifyNamespace(parsed.data.parsed);\r\n                if (properties.data.globalData.items.indexOf(name) < 0) {\r\n                    helper.addErrors(\r\n                        UNKNOWNITEM.create(start, reader.cursor, name)\r\n                    );\r\n                }\r\n                items.push(name);\r\n            }\r\n            if (reader.peek() === \"{\") {\r\n                const nbt = parseNBT(reader, properties, {\r\n                    id: items,\r\n                    type: \"item\"\r\n                });\r\n                helper.merge(nbt);\r\n            } else {\r\n                helper.addSuggestion(reader.cursor, \"{\");\r\n            }\r\n        } else {\r\n            if (parsed.data) {\r\n                helper.addErrors(\r\n                    UNKNOWNTAG.create(\r\n                        start,\r\n                        reader.cursor,\r\n                        stringifyNamespace(parsed.data)\r\n                    )\r\n                );\r\n                if (reader.peek() === \"{\") {\r\n                    const nbt = parseNBT(reader, properties, {\r\n                        id: \"none\",\r\n                        type: \"item\"\r\n                    });\r\n                    helper.merge(nbt);\r\n                } else {\r\n                    helper.addSuggestion(reader.cursor, \"{\");\r\n                }\r\n            } else {\r\n                return helper.fail();\r\n            }\r\n        }\r\n        return helper.succeed();\r\n    }\r\n}\r\n\r\nexport const stack = new ItemParser(false);\r\nexport const predicate = new ItemParser(true);\r\n","export const COLORS = [\r\n    \"black\",\r\n    \"dark_blue\",\r\n    \"dark_green\",\r\n    \"dark_aqua\",\r\n    \"dark_red\",\r\n    \"dark_purple\",\r\n    \"gold\",\r\n    \"gray\",\r\n    \"dark_gray\",\r\n    \"blue\",\r\n    \"green\",\r\n    \"aqua\",\r\n    \"red\",\r\n    \"light_purple\",\r\n    \"yellow\",\r\n    \"white\",\r\n    \"reset\"\r\n];\r\n","export const itemSlots = slotsBuilder();\r\n\r\nfunction slotsBuilder(): string[] {\r\n    const slots = [];\r\n\r\n    slots.push(\"armor.chest\", \"armor.feet\", \"armor.head\", \"armor.legs\");\r\n\r\n    for (let i = 0; i < 54; i++) {\r\n        slots.push(`container.${i}`);\r\n    }\r\n\r\n    for (let i = 0; i < 27; i++) {\r\n        slots.push(`enderchest.${i}`);\r\n    }\r\n\r\n    for (let i = 0; i < 25; i++) {\r\n        slots.push(`horse.${i}`);\r\n    }\r\n    slots.push(\"horse.armor\", \"horse.chest\", \"horse.saddle\");\r\n\r\n    for (let i = 0; i < 9; i++) {\r\n        slots.push(`hotbar.${i}`);\r\n    }\r\n\r\n    for (let i = 0; i < 27; i++) {\r\n        slots.push(`inventory.${i}`);\r\n    }\r\n\r\n    for (let i = 0; i < 8; i++) {\r\n        slots.push(`villager.${i}`);\r\n    }\r\n\r\n    slots.push(\"weapon\", \"weapon.mainhand\", \"weapon.offhand\");\r\n    return slots;\r\n}\r\n","import { COLORS } from \"../../colors\";\r\n\r\nexport const scoreboardSlots = createSlots();\r\n\r\nfunction createSlots(): string[] {\r\n    const slots = [];\r\n\r\n    slots.push(\"list\", \"sidebar\", \"belowName\");\r\n\r\n    for (const s of COLORS) {\r\n        slots.push(`sidebar.team.${s}`);\r\n    }\r\n    return slots;\r\n}\r\n","import { COLORS } from \"../../colors\";\r\n\r\nexport const anchors = [\"feet\", \"eyes\"];\r\nexport const operations = [\"+=\", \"-=\", \"*=\", \"/=\", \"%=\", \"=\", \">\", \"<\", \"><\"];\r\nexport const colors = COLORS;\r\n\r\nexport const effects = [\r\n    \"minecraft:speed\",\r\n    \"minecraft:slowness\",\r\n    \"minecraft:haste\",\r\n    \"minecraft:mining_fatigue\",\r\n    \"minecraft:strength\",\r\n    \"minecraft:instant_health\",\r\n    \"minecraft:instant_damage\",\r\n    \"minecraft:jump_boost\",\r\n    \"minecraft:nausea\",\r\n    \"minecraft:regeneration\",\r\n    \"minecraft:resistance\",\r\n    \"minecraft:fire_resistance\",\r\n    \"minecraft:water_breathing\",\r\n    \"minecraft:invisibility\",\r\n    \"minecraft:blindness\",\r\n    \"minecraft:night_vision\",\r\n    \"minecraft:hunger\",\r\n    \"minecraft:weakness\",\r\n    \"minecraft:poison\",\r\n    \"minecraft:wither\",\r\n    \"minecraft:health_boost\",\r\n    \"minecraft:absorption\",\r\n    \"minecraft:saturation\",\r\n    \"minecraft:glowing\",\r\n    \"minecraft:levitation\",\r\n    \"minecraft:luck\",\r\n    \"minecraft:unluck\",\r\n    \"minecraft:slow_falling\",\r\n    \"minecraft:conduit_power\",\r\n    \"minecraft:dolphins_grace\"\r\n];\r\n\r\nexport const enchantments = [\r\n    \"minecraft:protection\",\r\n    \"minecraft:fire_protection\",\r\n    \"minecraft:feather_falling\",\r\n    \"minecraft:blast_protection\",\r\n    \"minecraft:projectile_protection\",\r\n    \"minecraft:respiration\",\r\n    \"minecraft:aqua_affinity\",\r\n    \"minecraft:thorns\",\r\n    \"minecraft:depth_strider\",\r\n    \"minecraft:frost_walker\",\r\n    \"minecraft:binding_curse\",\r\n    \"minecraft:sharpness\",\r\n    \"minecraft:smite\",\r\n    \"minecraft:bane_of_arthropods\",\r\n    \"minecraft:knockback\",\r\n    \"minecraft:fire_aspect\",\r\n    \"minecraft:looting\",\r\n    \"minecraft:sweeping\",\r\n    \"minecraft:efficiency\",\r\n    \"minecraft:silk_touch\",\r\n    \"minecraft:unbreaking\",\r\n    \"minecraft:fortune\",\r\n    \"minecraft:power\",\r\n    \"minecraft:punch\",\r\n    \"minecraft:flame\",\r\n    \"minecraft:infinity\",\r\n    \"minecraft:luck_of_the_sea\",\r\n    \"minecraft:lure\",\r\n    \"minecraft:loyalty\",\r\n    \"minecraft:impaling\",\r\n    \"minecraft:riptide\",\r\n    \"minecraft:channeling\",\r\n    \"minecraft:mending\",\r\n    \"minecraft:vanishing_curse\"\r\n];\r\n\r\nexport const particles = [\r\n    \"minecraft:ambient_entity_effect\",\r\n    \"minecraft:angry_villager\",\r\n    \"minecraft:barrier\",\r\n    \"minecraft:block\",\r\n    \"minecraft:bubble\",\r\n    \"minecraft:cloud\",\r\n    \"minecraft:crit\",\r\n    \"minecraft:damage_indicator\",\r\n    \"minecraft:dragon_breath\",\r\n    \"minecraft:dripping_lava\",\r\n    \"minecraft:dripping_water\",\r\n    \"minecraft:dust\",\r\n    \"minecraft:effect\",\r\n    \"minecraft:elder_guardian\",\r\n    \"minecraft:enchanted_hit\",\r\n    \"minecraft:enchant\",\r\n    \"minecraft:end_rod\",\r\n    \"minecraft:entity_effect\",\r\n    \"minecraft:explosion_emitter\",\r\n    \"minecraft:explosion\",\r\n    \"minecraft:falling_dust\",\r\n    \"minecraft:firework\",\r\n    \"minecraft:fishing\",\r\n    \"minecraft:flame\",\r\n    \"minecraft:happy_villager\",\r\n    \"minecraft:heart\",\r\n    \"minecraft:instant_effect\",\r\n    \"minecraft:item\",\r\n    \"minecraft:item_slime\",\r\n    \"minecraft:item_snowball\",\r\n    \"minecraft:large_smoke\",\r\n    \"minecraft:lava\",\r\n    \"minecraft:mycelium\",\r\n    \"minecraft:note\",\r\n    \"minecraft:poof\",\r\n    \"minecraft:portal\",\r\n    \"minecraft:rain\",\r\n    \"minecraft:smoke\",\r\n    \"minecraft:spit\",\r\n    \"minecraft:squid_ink\",\r\n    \"minecraft:sweep_attack\",\r\n    \"minecraft:totem_of_undying\",\r\n    \"minecraft:underwater\",\r\n    \"minecraft:splash\",\r\n    \"minecraft:witch\",\r\n    \"minecraft:bubble_pop\",\r\n    \"minecraft:current_down\",\r\n    \"minecraft:bubble_column_up\",\r\n    \"minecraft:nautilus\"\r\n];\r\n\r\nexport const entities = [\r\n    \"area_effect_cloud\",\r\n    \"armor_stand\",\r\n    \"arrow\",\r\n    \"bat\",\r\n    \"blaze\",\r\n    \"boat\",\r\n    \"cave_spider\",\r\n    \"chicken\",\r\n    \"cod\",\r\n    \"cow\",\r\n    \"creeper\",\r\n    \"donkey\",\r\n    \"dolphin\",\r\n    \"dragon_fireball\",\r\n    \"drowned\",\r\n    \"elder_guardian\",\r\n    \"end_crystal\",\r\n    \"ender_dragon\",\r\n    \"enderman\",\r\n    \"endermite\",\r\n    \"evoker_fangs\",\r\n    \"evoker\",\r\n    \"experience_orb\",\r\n    \"eye_of_ender\",\r\n    \"falling_block\",\r\n    \"firework_rocket\",\r\n    \"ghast\",\r\n    \"giant\",\r\n    \"guardian\",\r\n    \"horse\",\r\n    \"husk\",\r\n    \"illusioner\",\r\n    \"item\",\r\n    \"item_frame\",\r\n    \"fireball\",\r\n    \"leash_knot\",\r\n    \"llama\",\r\n    \"llama_spit\",\r\n    \"magma_cube\",\r\n    \"minecart\",\r\n    \"chest_minecart\",\r\n    \"command_block_minecart\",\r\n    \"furnace_minecart\",\r\n    \"hopper_minecart\",\r\n    \"spawner_minecart\",\r\n    \"tnt_minecart\",\r\n    \"mule\",\r\n    \"mooshroom\",\r\n    \"ocelot\",\r\n    \"painting\",\r\n    \"parrot\",\r\n    \"pig\",\r\n    \"pufferfish\",\r\n    \"zombie_pigman\",\r\n    \"polar_bear\",\r\n    \"tnt\",\r\n    \"rabbit\",\r\n    \"salmon\",\r\n    \"sheep\",\r\n    \"shulker\",\r\n    \"shulker_bullet\",\r\n    \"silverfish\",\r\n    \"skeleton\",\r\n    \"skeleton_horse\",\r\n    \"slime\",\r\n    \"small_fireball\",\r\n    \"snow_golem\",\r\n    \"snowball\",\r\n    \"spectral_arrow\",\r\n    \"spider\",\r\n    \"squid\",\r\n    \"stray\",\r\n    \"tropical_fish\",\r\n    \"turtle\",\r\n    \"egg\",\r\n    \"ender_pearl\",\r\n    \"experience_bottle\",\r\n    \"potion\",\r\n    \"vex\",\r\n    \"villager\",\r\n    \"iron_golem\",\r\n    \"vindicator\",\r\n    \"witch\",\r\n    \"wither\",\r\n    \"wither_skeleton\",\r\n    \"wither_skull\",\r\n    \"wolf\",\r\n    \"zombie\",\r\n    \"zombie_horse\",\r\n    \"zombie_villager\",\r\n    \"phantom\",\r\n    \"lightning_bolt\",\r\n    \"trident\"\r\n];\r\n\r\nexport const dimensions = [\"overworld\", \"the_nether\", \"the_end\"];\r\n","import { CompletionItemKind } from \"vscode-languageserver\";\r\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { StringReader } from \"../../brigadier/string-reader\";\r\nimport { COLORS } from \"../../colors\";\r\nimport { itemSlots } from \"../../data/lists/item-slot\";\r\nimport { scoreboardSlots } from \"../../data/lists/scoreboard-slot\";\r\nimport { anchors, operations } from \"../../data/lists/statics\";\r\nimport { ReturnHelper } from \"../../misc-functions\";\r\nimport { Parser, ParserInfo, ReturnedInfo } from \"../../types\";\r\n\r\nexport class ListParser implements Parser {\r\n    private readonly error: CommandErrorBuilder;\r\n    private readonly options: string[];\r\n\r\n    public constructor(options: string[], err: CommandErrorBuilder) {\r\n        this.options = options;\r\n        this.error = err;\r\n    }\r\n\r\n    public parse(\r\n        reader: StringReader,\r\n        info: ParserInfo\r\n    ): ReturnedInfo<undefined> {\r\n        const start = reader.cursor;\r\n        const helper = new ReturnHelper(info);\r\n        const optResult = reader.readOption(\r\n            this.options,\r\n            false,\r\n            CompletionItemKind.EnumMember,\r\n            \"no\"\r\n        );\r\n        if (helper.merge(optResult)) {\r\n            return helper.succeed();\r\n        } else {\r\n            return helper.fail(\r\n                this.error.create(\r\n                    start,\r\n                    reader.cursor,\r\n                    optResult.data.toString()\r\n                )\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nconst colorError = new CommandErrorBuilder(\r\n    \"argument.color.invalid\",\r\n    \"Unknown color '%s'\"\r\n);\r\nexport const colorParser = new ListParser(COLORS, colorError);\r\n\r\nconst entityAnchorError = new CommandErrorBuilder(\r\n    \"argument.anchor.invalid\",\r\n    \"Invalid entity anchor position %s\"\r\n);\r\nexport const entityAnchorParser = new ListParser(anchors, entityAnchorError);\r\n\r\nconst slotError = new CommandErrorBuilder(\"slot.unknown\", \"Unknown slot '%s'\");\r\nexport const itemSlotParser = new ListParser(itemSlots, slotError);\r\n\r\nconst operationError = new CommandErrorBuilder(\r\n    \"arguments.operation.invalid\",\r\n    \"Invalid operation\"\r\n);\r\nexport const operationParser = new ListParser(operations, operationError);\r\n\r\nconst scoreboardSlotError = new CommandErrorBuilder(\r\n    \"argument.scoreboardDisplaySlot.invalid\",\r\n    \"Unknown display slot '%s'\"\r\n);\r\nexport const scoreBoardSlotParser = new ListParser(\r\n    scoreboardSlots,\r\n    scoreboardSlotError\r\n);\r\n","import { StringReader } from \"../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../misc-functions\";\r\nimport { Parser } from \"../../types\";\r\n\r\nexport const messageParser: Parser = {\r\n    parse: (reader: StringReader) => {\r\n        reader.cursor = reader.getTotalLength();\r\n        return new ReturnHelper().succeed();\r\n    }\r\n};\r\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { StringReader } from \"../../brigadier/string-reader\";\r\nimport {\r\n    dimensions,\r\n    effects,\r\n    enchantments,\r\n    entities,\r\n    particles\r\n} from \"../../data/lists/statics\";\r\nimport {\r\n    convertToNamespace,\r\n    parseNamespaceOption,\r\n    ReturnHelper,\r\n    stringifyNamespace\r\n} from \"../../misc-functions\";\r\nimport { ContextChange, Parser, ParserInfo, ReturnedInfo } from \"../../types\";\r\n\r\nexport class NamespaceListParser implements Parser {\r\n    private readonly error: CommandErrorBuilder;\r\n    private readonly options: string[];\r\n    public constructor(options: string[], errorBuilder: CommandErrorBuilder) {\r\n        this.options = options;\r\n        this.error = errorBuilder;\r\n    }\r\n    public parse(\r\n        reader: StringReader,\r\n        info: ParserInfo\r\n    ): ReturnedInfo<ContextChange> {\r\n        const helper = new ReturnHelper(info);\r\n        const start = reader.cursor;\r\n        const result = parseNamespaceOption(\r\n            reader,\r\n            this.options.map((v, _) => convertToNamespace(v))\r\n        );\r\n        if (helper.merge(result)) {\r\n            return helper.succeed();\r\n        } else {\r\n            if (result.data) {\r\n                return helper\r\n                    .addErrors(\r\n                        this.error.create(\r\n                            start,\r\n                            reader.cursor,\r\n                            stringifyNamespace(result.data)\r\n                        )\r\n                    )\r\n                    .succeed();\r\n            } else {\r\n                return helper.fail();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nconst summonError = new CommandErrorBuilder(\r\n    \"entity.notFound\",\r\n    \"Unknown entity: %s\"\r\n);\r\nexport const summonParser = new NamespaceListParser(entities, summonError);\r\n\r\nconst enchantmentError = new CommandErrorBuilder(\r\n    \"enchantment.unknown\",\r\n    \"Unknown enchantment: %s\"\r\n);\r\nexport const enchantmentParser = new NamespaceListParser(\r\n    enchantments,\r\n    enchantmentError\r\n);\r\n\r\nconst mobEffectError = new CommandErrorBuilder(\r\n    \"effect.effectNotFound\",\r\n    \"Unknown effect: %s\"\r\n);\r\nexport const mobEffectParser = new NamespaceListParser(effects, mobEffectError);\r\n\r\nconst particleError = new CommandErrorBuilder(\r\n    \"particle.notFound\",\r\n    \"Unknown particle: %s\"\r\n);\r\nexport const particleParser = new NamespaceListParser(particles, particleError);\r\n\r\nconst dimensionError = new CommandErrorBuilder(\r\n    \"argument.dimension.invalid\",\r\n    \"Unknown dimension: '%s'\"\r\n);\r\n\r\nexport const dimensionParser = new NamespaceListParser(\r\n    dimensions,\r\n    dimensionError\r\n);\r\n","import { CompletionItemKind } from \"vscode-languageserver\";\r\nimport { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { Resources } from \"../../data/types\";\r\nimport {\r\n    buildPath,\r\n    buildTagActions,\r\n    ContextPath,\r\n    convertToNamespace,\r\n    getResourcesofType,\r\n    parseNamespace,\r\n    parseNamespaceOption,\r\n    parseNamespaceOrTag,\r\n    processParsedNamespaceOption,\r\n    ReturnHelper,\r\n    startPaths,\r\n    stringifyNamespace\r\n} from \"../../misc-functions\";\r\nimport { Parser } from \"../../types\";\r\n\r\nconst exceptions = {\r\n    advancement_notfound: new CommandErrorBuilder(\r\n        \"advancement.advancementNotFound\",\r\n        \"Unknown advancement: %s\"\r\n    ),\r\n    nobossbar: new CommandErrorBuilder(\r\n        \"commands.bossbar.unknown\",\r\n        \"No bossbar exists with the ID '%s'\"\r\n    ),\r\n    recipe_notfound: new CommandErrorBuilder(\r\n        \"recipe.notFound\",\r\n        \"Unkown recipe: %s\"\r\n    ),\r\n    unknown_function: new CommandErrorBuilder(\r\n        \"arguments.function.unknown\",\r\n        \"Unknown function '%s'\"\r\n    ),\r\n    unknown_resource: new CommandErrorBuilder(\r\n        \"argument.id.unknown\",\r\n        \"Unknown resource '%s'\"\r\n    ),\r\n    unknown_tag: new CommandErrorBuilder(\r\n        \"arguments.function.tag.unknown\",\r\n        \"Unknown function tag '#%s'\"\r\n    )\r\n};\r\n\r\nexport const functionParser: Parser = {\r\n    parse: (reader, info) => {\r\n        const helper = new ReturnHelper(info);\r\n        const start = reader.cursor;\r\n        const parsed = parseNamespaceOrTag(reader, info, \"function_tags\");\r\n        const localData = info.data.localData;\r\n        if (helper.merge(parsed)) {\r\n            const data = parsed.data;\r\n            if (data.resolved && data.values) {\r\n                helper.merge(\r\n                    buildTagActions(\r\n                        data.values,\r\n                        start,\r\n                        reader.cursor,\r\n                        \"function_tags\",\r\n                        localData\r\n                    )\r\n                );\r\n                return helper.succeed();\r\n            } else {\r\n                const options = getResourcesofType(info.data, \"functions\");\r\n                const postProcess = processParsedNamespaceOption(\r\n                    data.parsed,\r\n                    options,\r\n                    info.suggesting && !reader.canRead(),\r\n                    start,\r\n                    CompletionItemKind.Method\r\n                );\r\n                if (postProcess.data.length === 0) {\r\n                    helper.addErrors(\r\n                        exceptions.unknown_function.create(\r\n                            start,\r\n                            reader.cursor,\r\n                            stringifyNamespace(data.parsed)\r\n                        )\r\n                    );\r\n                }\r\n                if (localData) {\r\n                    for (const func of postProcess.data) {\r\n                        const location = buildPath(\r\n                            func,\r\n                            localData,\r\n                            \"functions\"\r\n                        );\r\n                        if (location) {\r\n                            helper.addActions({\r\n                                data: location,\r\n                                high: reader.cursor,\r\n                                low: start,\r\n                                type: \"source\"\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                return helper.mergeChain(postProcess).succeed();\r\n            }\r\n        } else {\r\n            if (!parsed.data) {\r\n                return helper.fail();\r\n            } else {\r\n                return helper\r\n                    .addErrors(\r\n                        exceptions.unknown_tag.create(\r\n                            start,\r\n                            reader.cursor,\r\n                            stringifyNamespace(parsed.data)\r\n                        )\r\n                    )\r\n                    .succeed();\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nconst idParser: Parser = {\r\n    parse: parseNamespace\r\n};\r\n\r\nconst bossbarParser: Parser = {\r\n    parse: (reader, info) => {\r\n        const helper = new ReturnHelper(info);\r\n        if (info.data.localData && info.data.localData.nbt.level) {\r\n            const start = reader.cursor;\r\n            const bars = info.data.localData.nbt.level.Data.CustomBossEvents;\r\n            const options = Object.keys(bars).map((v, _) =>\r\n                convertToNamespace(v)\r\n            );\r\n            const result = parseNamespaceOption(reader, options);\r\n            if (helper.merge(result)) {\r\n                return helper.succeed();\r\n            } else {\r\n                if (result.data) {\r\n                    return helper\r\n                        .addErrors(\r\n                            exceptions.nobossbar.create(\r\n                                start,\r\n                                reader.cursor,\r\n                                stringifyNamespace(result.data)\r\n                            )\r\n                        )\r\n                        .succeed();\r\n                } else {\r\n                    return helper.fail();\r\n                }\r\n            }\r\n        } else {\r\n            return helper.return(parseNamespace(reader));\r\n        }\r\n    }\r\n};\r\n\r\nconst resourceKinds: Array<\r\n    ContextPath<\r\n        | {\r\n              issue: CommandErrorBuilder;\r\n              resource: keyof Resources;\r\n          }\r\n        | { resource: Parser }\r\n    >\r\n> = [\r\n    {\r\n        data: {\r\n            issue: exceptions.advancement_notfound,\r\n            resource: \"advancements\"\r\n        },\r\n        path: [\"advancement\"]\r\n    },\r\n    { data: { resource: idParser }, path: [\"bossbar\", \"add\"] },\r\n    { data: { resource: bossbarParser }, path: [\"bossbar\"] },\r\n    {\r\n        data: { resource: bossbarParser },\r\n        path: [\"execute\", \"store\", \"result\"]\r\n    },\r\n    // Worrying about sounds is not in scope for initial release\r\n    { data: { resource: idParser }, path: [\"playsound\"] },\r\n    { data: { resource: idParser }, path: [\"stopsound\"] },\r\n    {\r\n        data: { resource: \"recipes\", issue: exceptions.advancement_notfound },\r\n        path: [\"recipe\"]\r\n    }\r\n];\r\n\r\nexport const resourceParser: Parser = {\r\n    parse: (reader, info) => {\r\n        const start = reader.cursor;\r\n        const helper = new ReturnHelper(info);\r\n        const kind = startPaths(resourceKinds, info.path);\r\n        if (kind) {\r\n            if (typeof kind.resource === \"object\") {\r\n                return helper.return(kind.resource.parse(reader, info));\r\n            } else {\r\n                const result = parseNamespaceOption(\r\n                    reader,\r\n                    getResourcesofType(info.data, kind.resource)\r\n                );\r\n                if (helper.merge(result)) {\r\n                    return helper.succeed();\r\n                } else {\r\n                    if (result.data) {\r\n                        return helper\r\n                            .addErrors(\r\n                                // @ts-ignore type inference failure\r\n                                (kind.issue as CommandErrorBuilder).create(\r\n                                    start,\r\n                                    reader.cursor,\r\n                                    stringifyNamespace(result.data)\r\n                                )\r\n                            )\r\n                            .succeed();\r\n                    } else {\r\n                        return helper.fail();\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            throw new Error(\r\n                `Resource at path ${\r\n                    info.path\r\n                } does not have a supported resource`\r\n            );\r\n        }\r\n    }\r\n};\r\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { DisplaySlots } from \"../../data/nbt/nbt-types\";\r\nimport { ReturnHelper } from \"../../misc-functions\";\r\nimport { typed_keys } from \"../../misc-functions/third_party/typed-keys\";\r\nimport { Parser } from \"../../types\";\r\n\r\nconst exceptions = {\r\n    unknown_objective: new CommandErrorBuilder(\r\n        \"arguments.objective.notFound\",\r\n        \"Unknown scoreboard objective '%s'\"\r\n    ),\r\n    unknown_team: new CommandErrorBuilder(\"team.notFound\", \"Unknown team '%s'\")\r\n};\r\n\r\nconst slotPurposes: { [_ in keyof DisplaySlots]: string } = {\r\n    slot_0: \"list\",\r\n    slot_1: \"sidebar\",\r\n    slot_10: \"sidebar.team.gray\",\r\n    slot_11: \"sidebar.team.dark_gray\",\r\n    slot_12: \"sidebar.team.blue\",\r\n    slot_13: \"sidebar.team.green\",\r\n    slot_14: \"sidebar.team.aqua\",\r\n    slot_15: \"sidebar.team.red\",\r\n    slot_16: \"sidebar.team.light_purple\",\r\n    slot_17: \"sidebar.team.yellow\",\r\n    slot_18: \"sidebar.team.white\",\r\n    slot_2: \"belowName\",\r\n    slot_3: \"sidebar.team.black\",\r\n    slot_4: \"sidebar.team.dark_blue\",\r\n    slot_5: \"sidebar.team.dark_green\",\r\n    slot_6: \"sidebar.team.dark_aqua\",\r\n    slot_7: \"sidebar.team.dark_red\",\r\n    slot_8: \"sidebar.team.dark_purple\",\r\n    slot_9: \"sidebar.team.gold\"\r\n};\r\n\r\nexport const objectiveParser: Parser = {\r\n    parse: (reader, info) => {\r\n        const helper = new ReturnHelper(info);\r\n        const start = reader.cursor;\r\n        if (info.data.localData) {\r\n            const scoreboardData = info.data.localData.nbt.scoreboard;\r\n            if (scoreboardData) {\r\n                const options = scoreboardData.data.Objectives.map(v => v.Name);\r\n                const result = reader.readOption(\r\n                    options,\r\n                    false,\r\n                    undefined,\r\n                    \"no\"\r\n                );\r\n                if (helper.merge(result)) {\r\n                    if (!info.suggesting) {\r\n                        for (const objective of scoreboardData.data\r\n                            .Objectives) {\r\n                            if (objective.Name === result.data) {\r\n                                helper.addActions({\r\n                                    data: `Displayed as: ${\r\n                                        objective.DisplayName\r\n                                    }\r\n\r\nCriteria: ${objective.CriteriaName}`,\r\n                                    high: reader.cursor,\r\n                                    low: start,\r\n                                    type: \"hover\"\r\n                                });\r\n                                break;\r\n                            }\r\n                        }\r\n                        if (scoreboardData.data.DisplaySlots) {\r\n                            for (const slot of typed_keys(\r\n                                scoreboardData.data.DisplaySlots\r\n                            )) {\r\n                                if (\r\n                                    scoreboardData.data.DisplaySlots[slot] ===\r\n                                    result.data\r\n                                ) {\r\n                                    helper.addActions({\r\n                                        data: `Displayed in ${\r\n                                            slotPurposes[slot]\r\n                                        }`,\r\n                                        high: reader.cursor,\r\n                                        low: start,\r\n                                        type: \"hover\"\r\n                                    });\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (result.data) {\r\n                        helper.addErrors(\r\n                            exceptions.unknown_objective.create(\r\n                                start,\r\n                                reader.cursor,\r\n                                result.data\r\n                            )\r\n                        );\r\n                    } else {\r\n                        return helper.fail();\r\n                    }\r\n                }\r\n                return helper.succeed();\r\n            }\r\n        }\r\n        reader.readUnquotedString();\r\n        return helper.succeed();\r\n    }\r\n};\r\n\r\nexport const teamParser: Parser = {\r\n    parse: (reader, info) => {\r\n        const helper = new ReturnHelper();\r\n        const start = reader.cursor;\r\n        if (info.data.localData) {\r\n            const scoreboardData = info.data.localData.nbt.scoreboard;\r\n            if (scoreboardData) {\r\n                const options = scoreboardData.data.Teams;\r\n                const result = reader.readOption(\r\n                    options.map(v => v.Name),\r\n                    false,\r\n                    undefined,\r\n                    \"no\"\r\n                );\r\n                if (helper.merge(result)) {\r\n                    for (const team of options) {\r\n                        if (team.Name === result.data) {\r\n                            helper.addActions({\r\n                                data: `\\`\\`\\`json\r\n${JSON.stringify(team, undefined, 4)}\r\n\\`\\`\\``,\r\n                                high: reader.cursor,\r\n                                low: start,\r\n                                type: \"hover\"\r\n                            });\r\n                            break;\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (result.data) {\r\n                        helper.addErrors(\r\n                            exceptions.unknown_objective.create(\r\n                                start,\r\n                                reader.cursor,\r\n                                result.data\r\n                            )\r\n                        );\r\n                    } else {\r\n                        return helper.fail();\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            reader.readUnquotedString();\r\n        }\r\n        return helper.succeed();\r\n    }\r\n};\r\nexport const criteriaParser = undefined;\r\n","import { CommandErrorBuilder } from \"../../brigadier/errors\";\r\nimport { StringReader } from \"../../brigadier/string-reader\";\r\nimport { ReturnHelper } from \"../../misc-functions\";\r\nimport { Parser, ParserInfo, ReturnedInfo } from \"../../types\";\r\nimport { NBTWalker } from \"./nbt/doc-walker\";\r\nimport { NBTTagCompound } from \"./nbt/tag/compound-tag\";\r\n\r\nconst COMPACC = \".\";\r\nconst ARROPEN = \"[\";\r\nconst ARRCLOSE = \"]\";\r\n\r\nconst badChar = new CommandErrorBuilder(\r\n    \"argument.nbt_path.badchar\",\r\n    \"Bad character '%s'\"\r\n);\r\n\r\nexport const parser: Parser = {\r\n    parse: (\r\n        reader: StringReader,\r\n        prop: ParserInfo\r\n    ): ReturnedInfo<undefined> => {\r\n        const helper = new ReturnHelper();\r\n        const out: string[] = [];\r\n        const walker = new NBTWalker(\r\n            new NBTTagCompound({}),\r\n            prop.data.globalData.nbt_docs,\r\n            true,\r\n            false\r\n        );\r\n        const chr = reader.readString();\r\n        if (helper.merge(chr)) {\r\n            out.push(chr.data);\r\n        } else {\r\n            const node = walker.getFinalNode([]);\r\n            helper.mergeChain(node);\r\n        }\r\n        while (reader.canRead() && !/\\s/.test(reader.peek())) {\r\n            const next = reader.read();\r\n            if (next === COMPACC) {\r\n                const str = reader.readString();\r\n                if (helper.merge(str)) {\r\n                    out.push(str.data);\r\n                } else {\r\n                    const node = walker.getFinalNode([]);\r\n                    helper.mergeChain(node);\r\n                }\r\n            } else if (next === ARROPEN) {\r\n                const num = reader.readInt();\r\n                if (helper.merge(num)) {\r\n                    out.push(num.data.toString());\r\n                } else {\r\n                    const node = walker.getFinalNode([]);\r\n                    helper.mergeChain(node);\r\n                }\r\n                if (!helper.merge(reader.expect(ARRCLOSE))) {\r\n                    return helper.fail();\r\n                }\r\n            } else {\r\n                return helper.fail(\r\n                    badChar.create(reader.cursor - 1, reader.cursor, next)\r\n                );\r\n            }\r\n        }\r\n        helper.addSuggestion(reader.cursor, \".\");\r\n        helper.addSuggestion(reader.cursor, \"[\");\r\n        return helper.succeed();\r\n    }\r\n};\r\n","import { CommandNode } from \"../data/types\";\r\nimport { Parser } from \"../types\";\r\n\r\nimport * as brigadierParsers from \"./brigadier\";\r\nimport { literalParser } from \"./literal\";\r\nimport * as blockParsers from \"./minecraft/block\";\r\nimport * as coordParsers from \"./minecraft/coordinates\";\r\nimport * as itemParsers from \"./minecraft/item\";\r\nimport * as listParsers from \"./minecraft/lists\";\r\nimport { messageParser } from \"./minecraft/message\";\r\nimport * as namespaceParsers from \"./minecraft/namespace-list\";\r\nimport { functionParser, resourceParser } from \"./minecraft/resources\";\r\nimport { objectiveParser, teamParser } from \"./minecraft/scoreboard\";\r\n\r\nimport { parser as NBTPathParser } from \"./minecraft/nbt-path\";\r\nimport { parser as NBTParser } from \"./minecraft/nbt/nbt\";\r\n\r\n/**\r\n * Incomplete:\r\n * https://github.com/Levertion/mcfunction-langserver/projects/1\r\n */\r\nconst implementedParsers: { [id: string]: Parser } = {\r\n    \"brigadier:bool\": brigadierParsers.boolParser,\r\n    \"brigadier:float\": brigadierParsers.floatParser,\r\n    \"brigadier:integer\": brigadierParsers.intParser,\r\n    \"brigadier:string\": brigadierParsers.stringParser,\r\n    \"minecraft:block_pos\": coordParsers.blockPos,\r\n    \"minecraft:block_predicate\": blockParsers.predicateParser,\r\n    \"minecraft:block_state\": blockParsers.stateParser,\r\n    \"minecraft:color\": listParsers.colorParser,\r\n    \"minecraft:dimension\": namespaceParsers.dimensionParser,\r\n    \"minecraft:entity_anchor\": listParsers.entityAnchorParser,\r\n    \"minecraft:entity_summon\": namespaceParsers.summonParser,\r\n    \"minecraft:function\": functionParser,\r\n    \"minecraft:item_enchantment\": namespaceParsers.enchantmentParser,\r\n    \"minecraft:item_predicate\": itemParsers.predicate,\r\n    \"minecraft:item_slot\": listParsers.itemSlotParser,\r\n    \"minecraft:item_stack\": itemParsers.stack,\r\n    \"minecraft:message\": messageParser,\r\n    \"minecraft:mob_effect\": namespaceParsers.mobEffectParser,\r\n    \"minecraft:nbt\": NBTParser,\r\n    \"minecraft:nbt-path\": NBTPathParser,\r\n    \"minecraft:objective\": objectiveParser,\r\n    \"minecraft:operation\": listParsers.operationParser,\r\n    \"minecraft:particle\": namespaceParsers.particleParser,\r\n    \"minecraft:resource_location\": resourceParser,\r\n    \"minecraft:rotation\": coordParsers.rotation,\r\n    \"minecraft:scoreboard_slot\": listParsers.scoreBoardSlotParser,\r\n    \"minecraft:team\": teamParser,\r\n    \"minecraft:vec2\": coordParsers.vec2,\r\n    \"minecraft:vec3\": coordParsers.vec3\r\n};\r\n\r\nexport function getParser(node: CommandNode): Parser | undefined {\r\n    switch (node.type) {\r\n        case \"literal\":\r\n            return literalParser;\r\n        case \"argument\":\r\n            if (!!node.parser) {\r\n                return getArgParser(node.parser);\r\n            }\r\n            break;\r\n        default:\r\n    }\r\n    return undefined;\r\n}\r\n\r\nfunction getArgParser(id: string): Parser | undefined {\r\n    if (\r\n        !!global.mcLangSettings &&\r\n        !!global.mcLangSettings.parsers &&\r\n        global.mcLangSettings.parsers.hasOwnProperty(id)\r\n    ) {\r\n        try {\r\n            return global.mcLangSettings.parsers[id];\r\n        } catch (_) {\r\n            mcLangLog(\r\n                `${global.mcLangSettings.parsers[id]} could not be loaded`\r\n            );\r\n        }\r\n    }\r\n    if (implementedParsers.hasOwnProperty(id)) {\r\n        return implementedParsers[id];\r\n    }\r\n    mcLangLog(`Argument with parser id ${id} has no associated parser.\r\nPlease consider reporting this at https://github.com/Levertion/mcfunction-language-server/issues`);\r\n    return undefined;\r\n}\r\n","import {\r\n    CompletionItem,\r\n    CompletionItemKind,\r\n    CompletionList\r\n} from \"vscode-languageserver/lib/main\";\r\n\r\nimport { StringReader } from \"./brigadier/string-reader\";\r\nimport { COMMENT_START } from \"./consts\";\r\nimport { DataManager } from \"./data/manager\";\r\nimport { CommandNodePath, CommandTree } from \"./data/types\";\r\nimport { createParserInfo } from \"./misc-functions/creators\";\r\nimport { followPath, getNextNode } from \"./misc-functions/node-tree\";\r\nimport { getParser } from \"./parsers/get-parser\";\r\nimport {\r\n    CommandContext,\r\n    CommmandData,\r\n    FunctionInfo,\r\n    ParseNode,\r\n    SuggestResult\r\n} from \"./types\";\r\n\r\nexport function computeCompletions(\r\n    linenum: number,\r\n    character: number,\r\n    document: FunctionInfo,\r\n    data: DataManager\r\n): CompletionList {\r\n    const line = document.lines[linenum];\r\n    if (line.parseInfo === undefined || line.text.startsWith(COMMENT_START)) {\r\n        return CompletionList.create([], true);\r\n    }\r\n    const commandData: CommmandData = {\r\n        globalData: data.globalData,\r\n        localData: data.getPackFolderData(document.pack_segments)\r\n    };\r\n    const nodes = line.parseInfo ? line.parseInfo.nodes : [];\r\n    if (nodes.length === 0) {\r\n        return CompletionList.create(\r\n            getCompletionsFromNode(\r\n                linenum,\r\n                0,\r\n                character,\r\n                line.text,\r\n                [],\r\n                commandData,\r\n                {}\r\n            ),\r\n            true\r\n        );\r\n    }\r\n    const finals: ParseNode[] = [];\r\n    const internals: ParseNode[] = [];\r\n    for (const node of nodes) {\r\n        if (node.high < character) {\r\n            if (node.final) {\r\n                finals.push(node);\r\n            }\r\n        } else {\r\n            if (node.low <= character) {\r\n                internals.push(node);\r\n            }\r\n        }\r\n    }\r\n    const completions: CompletionItem[] = [];\r\n    for (const finalNode of finals) {\r\n        completions.push(\r\n            ...getCompletionsFromNode(\r\n                linenum,\r\n                finalNode.high + 1,\r\n                character,\r\n                line.text,\r\n                finalNode.path,\r\n                commandData,\r\n                finalNode.context\r\n            )\r\n        );\r\n    }\r\n    for (const insideNode of internals) {\r\n        const newPath = insideNode.path.slice();\r\n        const parentPath = newPath.slice(0, -1);\r\n        completions.push(\r\n            ...getCompletionsFromNode(\r\n                linenum,\r\n                insideNode.low,\r\n                character,\r\n                line.text,\r\n                parentPath,\r\n                commandData,\r\n                insideNode.context\r\n            )\r\n        );\r\n    }\r\n    return CompletionList.create(completions, true);\r\n}\r\n\r\nfunction getCompletionsFromNode(\r\n    line: number,\r\n    start: number,\r\n    end: number,\r\n    text: string,\r\n    nodepath: CommandNodePath,\r\n    data: CommmandData,\r\n    context: CommandContext\r\n): CompletionItem[] {\r\n    const parent = getNextNode(\r\n        followPath(data.globalData.commands, nodepath),\r\n        nodepath,\r\n        (data.globalData.commands as any) as CommandTree\r\n    ).node;\r\n    const result: CompletionItem[] = [];\r\n    if (!!parent.children) {\r\n        for (const childKey in parent.children) {\r\n            if (parent.children.hasOwnProperty(childKey)) {\r\n                const child = parent.children[childKey];\r\n                const childPath = [...nodepath, childKey];\r\n                const info = createParserInfo(\r\n                    child,\r\n                    data,\r\n                    childPath,\r\n                    context,\r\n                    true\r\n                );\r\n                const parser = getParser(child);\r\n                if (!!parser) {\r\n                    const reader = new StringReader(text.substring(start, end));\r\n                    const parseResult = parser.parse(reader, info);\r\n                    if (!!parseResult) {\r\n                        result.push(\r\n                            ...suggestionsToCompletions(\r\n                                parseResult.suggestions,\r\n                                line,\r\n                                start,\r\n                                end,\r\n                                parser.kind\r\n                            )\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction suggestionsToCompletions(\r\n    suggestions: SuggestResult[],\r\n    line: number,\r\n    start: number,\r\n    end: number,\r\n    defaultKind: CompletionItemKind = CompletionItemKind.Keyword\r\n): CompletionItem[] {\r\n    const result: CompletionItem[] = [];\r\n    for (const suggestion of suggestions) {\r\n        if (typeof suggestion === \"string\") {\r\n            result.push({\r\n                kind: defaultKind,\r\n                label: suggestion,\r\n                textEdit: {\r\n                    newText: suggestion,\r\n                    range: {\r\n                        end: { character: end, line },\r\n                        start: { character: start, line }\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            const completion: CompletionItem = {\r\n                kind: suggestion.kind || defaultKind,\r\n                label: suggestion.text,\r\n                textEdit: {\r\n                    newText: suggestion.text,\r\n                    range: {\r\n                        end: { character: end, line },\r\n                        start: { character: start + suggestion.start, line }\r\n                    }\r\n                }\r\n            };\r\n            if (!!suggestion.description) {\r\n                completion.detail = suggestion.description;\r\n            }\r\n            result.push(completion);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n","import { resourceTypes, ReturnHelper } from \"../../misc-functions\";\r\nimport { typed_keys } from \"../../misc-functions/third_party/typed-keys\";\r\n\r\nimport { join } from \"path\";\r\nimport { ReturnSuccess } from \"../../types\";\r\nimport { GlobalData, Resources, WorldInfo } from \"../types\";\r\n\r\nexport async function runMapFunctions(\r\n    resources: Resources,\r\n    globalData: GlobalData,\r\n    packRoot: string,\r\n    localData?: WorldInfo\r\n): Promise<ReturnSuccess<Resources>> {\r\n    const result: Resources = {};\r\n    const helper = new ReturnHelper();\r\n    const promises: Array<Promise<void>> = [];\r\n    for (const type of typed_keys(resources)) {\r\n        type resourcesType = NonNullable<Resources[typeof type]>;\r\n        const val = (result[type] = [] as resourcesType);\r\n        const data = resources[type] as resourcesType;\r\n        // tslint:disable-next-line:no-unbound-method We control this function, so we know it won't use the this keyword.\r\n        const mapFunction = resourceTypes[type].mapFunction;\r\n        if (mapFunction) {\r\n            promises.push(\r\n                ...data.map(async v => {\r\n                    const res = await mapFunction(\r\n                        v,\r\n                        packRoot,\r\n                        globalData,\r\n                        localData\r\n                    );\r\n                    helper.merge(res);\r\n                    val.push(res.data);\r\n                })\r\n            );\r\n        } else {\r\n            val.push(...data);\r\n        }\r\n    }\r\n    await Promise.all(promises);\r\n    return helper.succeed(result);\r\n}\r\n\r\nexport async function mapPacksInfo(\r\n    packsInfo: WorldInfo,\r\n    global: GlobalData\r\n): Promise<ReturnSuccess<WorldInfo>> {\r\n    const helper = new ReturnHelper();\r\n    const result: WorldInfo = { ...packsInfo, packs: {} };\r\n    const promises = typed_keys(packsInfo.packs).map(async packID => {\r\n        const element = packsInfo.packs[packID];\r\n        const subresult = await runMapFunctions(\r\n            element.data,\r\n            global,\r\n            join(packsInfo.location, element.name),\r\n            packsInfo\r\n        );\r\n        helper.merge(subresult);\r\n        result.packs[packID] = { ...element, data: subresult.data };\r\n    });\r\n    await Promise.all(promises);\r\n    return helper.succeed(result);\r\n}\r\n","import * as Long from \"long\";\r\n\r\nexport class BufferStream {\r\n    private readonly buf: Buffer;\r\n    private index: number;\r\n\r\n    public constructor(buffer: Buffer) {\r\n        this.index = 0;\r\n        this.buf = buffer;\r\n    }\r\n\r\n    public getByte(): number {\r\n        const out = this.buf.readInt8(this.index);\r\n        this.index++;\r\n        return out;\r\n    }\r\n\r\n    public getDouble(): number {\r\n        const out = this.buf.readDoubleBE(this.index);\r\n        this.index += 8;\r\n        return out;\r\n    }\r\n\r\n    public getFloat(): number {\r\n        const out = this.buf.readFloatBE(this.index);\r\n        this.index += 4;\r\n        return out;\r\n    }\r\n\r\n    public getInt(): number {\r\n        const out = this.buf.readInt32BE(this.index);\r\n        this.index += 4;\r\n        return out;\r\n    }\r\n\r\n    public getLong(): Long {\r\n        const arr = this.buf.subarray(this.index, this.index + 8);\r\n        this.index += 8;\r\n        return Long.fromBytesBE([...arr]);\r\n    }\r\n\r\n    public getShort(): number {\r\n        const out = this.buf.readInt16BE(this.index);\r\n        this.index += 2;\r\n        return out;\r\n    }\r\n\r\n    public getUTF8(): string {\r\n        const len = this.getShort();\r\n        const out = this.buf.toString(\"utf8\", this.index, this.index + len);\r\n        this.index += len;\r\n        return out;\r\n    }\r\n}\r\n","import { promisify } from \"util\";\r\nimport * as zlib from \"zlib\";\r\nimport { BufferStream } from \"./buffer-stream\";\r\n\r\nconst unzipAsync = promisify<zlib.InputType, Buffer>(zlib.unzip);\r\n\r\nlet tags: Tag;\r\n\r\ntype tagparser<T> = (buffer: BufferStream) => T;\r\n\r\nconst nbtbyte = (buffer: BufferStream) => buffer.getByte();\r\nconst nbtshort = (buffer: BufferStream) => buffer.getShort();\r\nconst nbtint = (buffer: BufferStream) => buffer.getInt();\r\nconst nbtlong = (buffer: BufferStream) => buffer.getLong();\r\nconst nbtfloat = (buffer: BufferStream) => buffer.getFloat();\r\nconst nbtdouble = (buffer: BufferStream) => buffer.getDouble();\r\n\r\nconst nbtbytearray = (buffer: BufferStream) => {\r\n    const len = buffer.getInt();\r\n    const out: number[] = [];\r\n    for (let i = 0; i < len; i++) {\r\n        out.push(buffer.getByte());\r\n    }\r\n    return out;\r\n};\r\n\r\nconst nbtstring = (buffer: BufferStream) => buffer.getUTF8();\r\n\r\nconst nbtlist = (buffer: BufferStream) => {\r\n    const id = buffer.getByte();\r\n    const len = buffer.getInt();\r\n    const parser = tags[id];\r\n    const out: any[] = [];\r\n    for (let i = 0; i < len; i++) {\r\n        out.push(parser(buffer));\r\n    }\r\n    return out;\r\n};\r\n\r\nconst nbtcompound = (buffer: BufferStream) => {\r\n    let tag: number = buffer.getByte();\r\n    const out: { [key: string]: any } = {};\r\n    while (tag !== 0) {\r\n        const name = buffer.getUTF8();\r\n        const parser = tags[tag];\r\n        out[name] = parser(buffer);\r\n        tag = buffer.getByte();\r\n    }\r\n    return out;\r\n};\r\n\r\nconst nbtintarray = (buffer: BufferStream) => {\r\n    const len = buffer.getInt();\r\n    const out: number[] = [];\r\n    for (let i = 0; i < len; i++) {\r\n        out.push(buffer.getInt());\r\n    }\r\n    return out;\r\n};\r\n\r\nconst nbtlongarray = (buffer: BufferStream) => {\r\n    const len = buffer.getInt();\r\n    const out: Long[] = [];\r\n    for (let i = 0; i < len; i++) {\r\n        out.push(buffer.getLong());\r\n    }\r\n    return out;\r\n};\r\n\r\ninterface Tag {\r\n    [id: number]: tagparser<any>;\r\n}\r\n\r\ntags = {\r\n    // Need to redeclare because of TSLint\r\n    1: nbtbyte,\r\n    2: nbtshort,\r\n    3: nbtint,\r\n    4: nbtlong,\r\n    5: nbtfloat,\r\n    6: nbtdouble,\r\n    7: nbtbytearray,\r\n    8: nbtstring,\r\n    9: nbtlist,\r\n    10: nbtcompound,\r\n    11: nbtintarray,\r\n    12: nbtlongarray\r\n};\r\n\r\nexport async function parse<T>(\r\n    buffer: Buffer,\r\n    named: boolean = true\r\n): Promise<T> {\r\n    let unzipbuf;\r\n    try {\r\n        unzipbuf = await unzipAsync(buffer);\r\n    } catch (e) {\r\n        unzipbuf = buffer;\r\n    }\r\n    const stream = new BufferStream(unzipbuf);\r\n    const id = stream.getByte();\r\n    if (named) {\r\n        stream.getUTF8(); // Name\r\n    }\r\n    const parser = tags[id];\r\n    return parser(stream) as T;\r\n}\r\n","import * as path from \"path\";\r\nimport { readFileAsync } from \"../../misc-functions\";\r\nimport { WorldNBT } from \"../types\";\r\nimport { Level, Scoreboard } from \"./nbt-types\";\r\nimport { parse } from \"./parser\";\r\n\r\nexport async function loadNBT(worldLoc: string): Promise<WorldNBT> {\r\n    const nbt: WorldNBT = {} as WorldNBT;\r\n\r\n    const levelpath = path.resolve(worldLoc, \"./level.dat\");\r\n    try {\r\n        const levelbuf: Buffer = await readFileAsync(levelpath);\r\n        nbt.level = await parse<Level>(levelbuf);\r\n    } catch (e) {\r\n        // Level doesn't exist\r\n    }\r\n\r\n    const scpath = path.resolve(worldLoc, \"./data/scoreboard.dat\");\r\n    try {\r\n        const scoreboardbuf: Buffer = await readFileAsync(scpath);\r\n        nbt.scoreboard = await parse<Scoreboard>(scoreboardbuf);\r\n    } catch (e) {\r\n        // Scoreboard file doesn't exist\r\n    }\r\n\r\n    return nbt;\r\n}\r\n","import * as path from \"path\";\r\n\r\nimport { DATAFOLDER, MCMETAFILE, SLASH, SLASHREPLACEREGEX } from \"../consts\";\r\nimport { resourceTypes, ReturnHelper } from \"../misc-functions\";\r\nimport { createExtensionFileError } from \"../misc-functions/file-errors\";\r\nimport {\r\n    readDirAsync,\r\n    readJSON,\r\n    statAsync,\r\n    walkDir\r\n} from \"../misc-functions/promisified-fs\";\r\nimport { typed_keys } from \"../misc-functions/third_party/typed-keys\";\r\nimport { ReturnSuccess } from \"../types\";\r\nimport { mapPacksInfo } from \"./extractor/mapfunctions\";\r\nimport { loadNBT } from \"./nbt/nbt-cache\";\r\nimport {\r\n    Datapack,\r\n    DataPackID,\r\n    GlobalData,\r\n    McmetaFile,\r\n    MinecraftResource,\r\n    Resources,\r\n    WorldInfo\r\n} from \"./types\";\r\n\r\nexport async function getNamespaceResources(\r\n    namespace: string,\r\n    dataFolder: string,\r\n    id: DataPackID | undefined,\r\n    result: Resources = {}\r\n): Promise<ReturnSuccess<Resources>> {\r\n    const helper = new ReturnHelper();\r\n    const namespaceFolder = path.join(dataFolder, namespace);\r\n    const subDirs = await subDirectories(namespaceFolder);\r\n    await Promise.all(\r\n        typed_keys(resourceTypes).map(async type => {\r\n            const resourceInfo = resourceTypes[type];\r\n            if (subDirs.indexOf(resourceInfo.path[0]) === -1) {\r\n                return;\r\n            }\r\n            const dataContents = path.join(\r\n                namespaceFolder,\r\n                ...resourceInfo.path\r\n            );\r\n            const files = await walkDir(dataContents);\r\n            if (files.length === 0) {\r\n                return;\r\n            }\r\n            const nameSpaceContents = result[type] || [];\r\n            await Promise.all(\r\n                files.map(async file => {\r\n                    const realExtension = path.extname(file);\r\n                    if (realExtension !== resourceInfo.extension) {\r\n                        helper.addMisc(\r\n                            createExtensionFileError(\r\n                                file,\r\n                                resourceInfo.extension,\r\n                                realExtension\r\n                            )\r\n                        );\r\n                    }\r\n                    const internalUri = path.relative(dataContents, file);\r\n                    const newResource: MinecraftResource = {\r\n                        namespace,\r\n                        pack: id,\r\n                        path: internalUri\r\n                            .slice(0, -realExtension.length)\r\n                            .replace(SLASHREPLACEREGEX, SLASH)\r\n                    };\r\n                    nameSpaceContents.push(newResource);\r\n                })\r\n            );\r\n            result[type] = nameSpaceContents;\r\n        })\r\n    );\r\n\r\n    return helper.succeed(result);\r\n}\r\n\r\nasync function buildDataPack(\r\n    packFolder: string,\r\n    id: DataPackID,\r\n    packName: string\r\n): Promise<ReturnSuccess<Datapack>> {\r\n    const helper = new ReturnHelper();\r\n    const dataFolder = path.join(packFolder, DATAFOLDER);\r\n    const [mcmeta, packResources] = await Promise.all([\r\n        readJSON<McmetaFile>(path.join(packFolder, MCMETAFILE)),\r\n        getPackResources(dataFolder, id)\r\n    ]);\r\n    const result: Datapack = { id, data: packResources.data, name: packName };\r\n    helper.merge(packResources);\r\n    if (helper.merge(mcmeta)) {\r\n        result.mcmeta = mcmeta.data;\r\n    }\r\n    return helper.succeed(result);\r\n}\r\n\r\nasync function getPackResources(\r\n    dataFolder: string,\r\n    id: DataPackID\r\n): Promise<ReturnSuccess<Resources>> {\r\n    const helper = new ReturnHelper();\r\n    const namespaces = await subDirectories(dataFolder);\r\n    const result: Resources = {};\r\n    await Promise.all(\r\n        namespaces.map(async namespace => {\r\n            const resources = await getNamespaceResources(\r\n                namespace,\r\n                dataFolder,\r\n                id,\r\n                result\r\n            );\r\n            helper.merge(resources);\r\n            return resources.data;\r\n        })\r\n    );\r\n    return helper.succeed(result);\r\n}\r\n\r\nexport async function getPacksInfo(\r\n    location: string,\r\n    globalData: GlobalData\r\n): Promise<ReturnSuccess<WorldInfo>> {\r\n    const packNames = await subDirectories(location);\r\n    const helper = new ReturnHelper();\r\n    const packs = [...packNames.entries()];\r\n    const nbt = await loadNBT(path.resolve(location, \"../\"));\r\n    const result: WorldInfo = { location, packnamesmap: {}, packs: {}, nbt };\r\n    const promises: Array<Promise<void>> = packs.map(\r\n        async ([packID, packName]) => {\r\n            const loc = path.join(location, packName);\r\n            const packData = await buildDataPack(loc, packID, packName);\r\n            helper.merge(packData);\r\n            result.packs[packID] = packData.data;\r\n            result.packnamesmap[packName] = packID;\r\n        }\r\n    );\r\n    await Promise.all(promises);\r\n    const otherResult = await mapPacksInfo(result, globalData);\r\n    return helper.mergeChain(otherResult).succeed(otherResult.data);\r\n}\r\n\r\nasync function subDirectories(baseFolder: string): Promise<string[]> {\r\n    let files: string[] = [];\r\n    try {\r\n        files = await readDirAsync(baseFolder);\r\n    } catch {\r\n        return [];\r\n    }\r\n    const promises = files.map<Promise<boolean>>(async name => {\r\n        try {\r\n            return (await statAsync(path.join(baseFolder, name))).isDirectory();\r\n        } catch {\r\n            return false;\r\n        }\r\n    });\r\n    const results = await Promise.all(promises);\r\n    return files.filter((_, i) => results[i]);\r\n}\r\n","import * as fs from \"fs\";\r\nimport * as path from \"path\";\r\nimport { promisify } from \"util\";\r\n\r\nimport { DATAFOLDER } from \"../../consts\";\r\nimport { ReturnHelper } from \"../../misc-functions\";\r\nimport { ReturnSuccess } from \"../../types\";\r\nimport { getNamespaceResources } from \"../datapack-resources\";\r\nimport { BlocksPropertyInfo, CommandTree, GlobalData } from \"../types\";\r\nimport { runMapFunctions } from \"./mapfunctions\";\r\nconst readFileAsync = promisify(fs.readFile);\r\n\r\ntype DataSaveResult<T extends keyof GlobalData> = [T, GlobalData[T]];\r\n\r\nexport async function collectData(\r\n    version: string,\r\n    dataDir: string\r\n): Promise<ReturnSuccess<GlobalData>> {\r\n    const helper = new ReturnHelper();\r\n    const result: GlobalData = { meta_info: { version } } as GlobalData;\r\n    const cleanups = await Promise.all([\r\n        getBlocks(dataDir),\r\n        getItems(dataDir),\r\n        getCommands(dataDir),\r\n        getResources(dataDir)\r\n    ]);\r\n    for (const dataType of cleanups) {\r\n        result[dataType[0]] = dataType[1];\r\n    }\r\n    const resources = await runMapFunctions(result.resources, result, dataDir);\r\n    return helper\r\n        .mergeChain(resources)\r\n        .succeed({ ...result, resources: resources.data });\r\n}\r\n\r\n//#region Resources\r\nasync function getResources(\r\n    dataDir: string\r\n): Promise<DataSaveResult<\"resources\">> {\r\n    const namespacePath = path.join(dataDir, DATAFOLDER);\r\n    const resources = await getNamespaceResources(\r\n        \"minecraft\",\r\n        namespacePath,\r\n        undefined\r\n    );\r\n    return [\"resources\", resources.data];\r\n}\r\n//#endregion\r\n//#region Items\r\nasync function getItems(dataDir: string): Promise<DataSaveResult<\"items\">> {\r\n    const itemsData: Dictionary<{ protocol_id: number }> = JSON.parse(\r\n        (await readFileAsync(\r\n            path.join(dataDir, \"reports\", \"items.json\")\r\n        )).toString()\r\n    );\r\n    return [\"items\", Object.keys(itemsData)];\r\n}\r\nasync function getCommands(\r\n    dataDir: string\r\n): Promise<DataSaveResult<\"commands\">> {\r\n    const tree: CommandTree = JSON.parse(\r\n        (await readFileAsync(\r\n            path.join(dataDir, \"reports\", \"commands.json\")\r\n        )).toString()\r\n    );\r\n    return [\"commands\", tree];\r\n}\r\n//#endregion\r\n\r\n//#region Blocks\r\nasync function getBlocks(dataDir: string): Promise<DataSaveResult<\"blocks\">> {\r\n    const blocksData: BlocksJson = JSON.parse(\r\n        (await readFileAsync(\r\n            path.join(dataDir, \"reports\", \"blocks.json\")\r\n        )).toString()\r\n    );\r\n    return [\"blocks\", cleanBlocks(blocksData)];\r\n}\r\n\r\nfunction cleanBlocks(blocks: BlocksJson): BlocksPropertyInfo {\r\n    const result: BlocksPropertyInfo = {};\r\n    for (const blockName in blocks) {\r\n        if (blocks.hasOwnProperty(blockName)) {\r\n            const blockInfo = blocks[blockName];\r\n            result[blockName] = {};\r\n            if (!!blockInfo.properties) {\r\n                Object.assign(result[blockName], blockInfo.properties);\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\ninterface BlocksJson {\r\n    [id: string]: {\r\n        properties?: {\r\n            [id: string]: string[];\r\n        };\r\n    };\r\n}\r\n//#endregion\r\n","// tslint:disable:no-require-imports\r\nimport * as fs from \"fs\";\r\nimport * as path from \"path\";\r\n// @ts-ignore `import *` syntax is broken in this case as requestPromise would be a function\r\nimport requestPromise from \"request-promise-native\";\r\n\r\nexport async function getPathToJar(\r\n    tempdir: string,\r\n    currentversion: string\r\n): Promise<JarInfo> {\r\n    if (!!mcLangSettings.data.customJar) {\r\n        return { jarPath: mcLangSettings.data.customJar, version: \"\" };\r\n    } else {\r\n        return downloadJar(currentversion, tempdir);\r\n    }\r\n}\r\n\r\nexport async function downloadJar(\r\n    currentversion: string,\r\n    tmpDirName: string\r\n): Promise<JarInfo> {\r\n    const versionInfo = await getLatestVersionInfo();\r\n    if (versionInfo.id !== currentversion) {\r\n        const singleVersion: SingleVersionInformation = await requestPromise(\r\n            versionInfo.url,\r\n            {\r\n                json: true\r\n            }\r\n        ).promise();\r\n        const jarPath = path.join(\r\n            tmpDirName,\r\n            `minecraft-function-${versionInfo.id}.jar`\r\n        );\r\n        const requestPromised = requestPromise(\r\n            singleVersion.downloads.server.url\r\n        );\r\n        requestPromised.pipe(fs.createWriteStream(jarPath));\r\n        await Promise.resolve(requestPromised);\r\n        return { jarPath, version: versionInfo.id };\r\n    } else {\r\n        throw new Error(\r\n            \"Downloading new global data not needed as current version is the same as the latest version.\"\r\n        );\r\n    }\r\n}\r\n\r\nexport interface JarInfo {\r\n    jarPath: string;\r\n    version: string;\r\n}\r\n\r\n//#region Version Manifest Usage\r\ninterface SingleVersionInformation {\r\n    downloads: {\r\n        server: {\r\n            sha1: string;\r\n            size: number;\r\n            url: string;\r\n        };\r\n    };\r\n}\r\n\r\nasync function getLatestVersionInfo(): Promise<VersionInfo> {\r\n    const manifest: VersionsManifest = await requestPromise(\r\n        \"https://launchermeta.mojang.com/mc/game/version_manifest.json\",\r\n        {\r\n            json: true\r\n        }\r\n    ).promise();\r\n    const version = findVersion(getVersionId(manifest), manifest);\r\n    return version;\r\n}\r\n\r\nfunction getVersionId(manifest: VersionsManifest): string {\r\n    if (mcLangSettings.data.snapshots) {\r\n        return manifest.latest.snapshot;\r\n    } else {\r\n        return manifest.latest.release;\r\n    }\r\n}\r\n\r\nfunction findVersion(version: string, manifest: VersionsManifest): VersionInfo {\r\n    return manifest.versions.find(\r\n        verInfo => verInfo.id === version\r\n    ) as VersionInfo;\r\n}\r\n\r\ninterface VersionInfo {\r\n    id: string;\r\n    releaseTime: string;\r\n    time: string;\r\n    type: \"snapshot\" | \"release\";\r\n    url: string;\r\n}\r\n\r\ninterface VersionsManifest {\r\n    latest: {\r\n        release: string;\r\n        snapshot: string;\r\n    };\r\n    versions: VersionInfo[];\r\n}\r\n//#endregion\r\n","import { execFile } from \"child_process\";\r\nimport * as path from \"path\";\r\nimport { promisify } from \"util\";\r\nconst execFileAsync = promisify(execFile);\r\n\r\n/**\r\n * Get the command used to execute a java version\r\n */\r\nexport async function checkJavaPath(): Promise<string> {\r\n    const javaPath = mcLangSettings.data.javaPath || \"java\";\r\n    try {\r\n        await execFileAsync(javaPath, [\"-version\"], { env: process.env });\r\n        return javaPath;\r\n    } catch (error) {\r\n        throw new Error(\r\n            `Could not find Java executable. Got message: '${error}'`\r\n        );\r\n    }\r\n}\r\n\r\nexport async function runGenerator(\r\n    javapath: string,\r\n    tempdir: string,\r\n    jarpath: string\r\n): Promise<string> {\r\n    const resultFolder = path.join(tempdir, \"generated\");\r\n    await execFileAsync(javapath, [\r\n        \"-cp\",\r\n        jarpath,\r\n        \"net.minecraft.data.Main\",\r\n        \"--output\",\r\n        resultFolder,\r\n        \"--all\"\r\n    ]);\r\n    return resultFolder;\r\n}\r\n","import * as fs from \"fs\";\r\nimport { tmpdir } from \"os\";\r\nimport * as path from \"path\";\r\nimport { promisify } from \"util\";\r\n\r\nimport { ReturnHelper } from \"../../misc-functions\";\r\nimport { ReturnSuccess } from \"../../types\";\r\nimport { cacheData } from \"../cache\";\r\nimport { Cacheable } from \"../types\";\r\nimport { collectData } from \"./collect-data\";\r\nimport { getPathToJar } from \"./download\";\r\nimport { checkJavaPath, runGenerator } from \"./extract-data\";\r\n\r\nconst mkdtmpAsync = promisify(fs.mkdtemp);\r\n\r\n/**\r\n * Will throw an error if something goes wrong.\r\n * Steps:\r\n * - Check if enabled in settings. \r\n * - Check versions manifest. Compare with cached if available \r\n *  - At the same time, check if java is installed \r\n * - Get single version information \r\n * - Download the jar into a temporary folder \r\n * - Run the exposed data generator. \r\n * - Collect the data exposed\r\n *  - Blocks and states\r\n *  - Items\r\n *  - (Entities)?\r\n *  - Commands\r\n *  - Advancements, recipes, structures, tags, etc\r\n * - Cache that data\r\n * - Return the data\r\n */\r\nexport async function collectGlobalData(\r\n    currentversion: string = \"\"\r\n): Promise<ReturnSuccess<Cacheable>> {\r\n    if (mcLangSettings.data.enabled) {\r\n        const javaPath = await checkJavaPath();\r\n        const dir = await mkdtmpAsync(path.join(tmpdir(), \"mcfunction\"));\r\n        const jarInfo = await getPathToJar(dir, currentversion);\r\n        const datadir = await runGenerator(javaPath, dir, jarInfo.jarPath);\r\n        mcLangLog(\"Generator Finished\");\r\n        const helper = new ReturnHelper();\r\n        const data = await collectData(jarInfo.version, datadir);\r\n        await cacheData(data.data);\r\n        return helper.mergeChain(data).succeed(data.data);\r\n    } else {\r\n        throw new Error(\r\n            \"Data Obtainer disabled in settings. To obtain data automatically, please enable it.\"\r\n        );\r\n    }\r\n}\r\n","import * as path from \"path\";\r\nimport { readJSONRaw } from \"../../../misc-functions/promisified-fs\";\r\n\r\nexport class MemoryFS {\r\n    private data: { [internalPath: string]: any };\r\n    /**\r\n     * The real filesystem path of the root folder\r\n     */\r\n    private readonly root: string;\r\n\r\n    public constructor(root: string, internal?: MemoryFS[\"data\"]) {\r\n        this.root = root;\r\n        this.data = internal || {};\r\n    }\r\n\r\n    public clear(): void {\r\n        this.data = {};\r\n    }\r\n\r\n    public get<T>(internalPath: string): T {\r\n        return this.data[internalPath];\r\n    }\r\n\r\n    public getRoot(): string {\r\n        return this.root;\r\n    }\r\n\r\n    public isEmpty(): boolean {\r\n        return Object.keys(this.data).length === 0;\r\n    }\r\n\r\n    public async load(realPath: string): Promise<void> {\r\n        if (path.extname(realPath) === \".json\") {\r\n            const data = await readJSONRaw(realPath);\r\n            this.setExternal(realPath, data);\r\n        }\r\n    }\r\n\r\n    public set(internalPath: string, data: any): void {\r\n        this.data[internalPath] = data;\r\n    }\r\n\r\n    public setExternal(realPath: string, data: any): void {\r\n        const internalPath = path\r\n            .relative(this.root, realPath)\r\n            .replace(new RegExp(`\\\\${path.win32.sep}`, \"g\"), path.posix.sep);\r\n        this.data[internalPath] = data;\r\n    }\r\n}\r\n","import * as path from \"path\";\r\nimport { walkDir } from \"../misc-functions/promisified-fs\";\r\nimport { MemoryFS } from \"../parsers/minecraft/nbt/doc-fs\";\r\nimport { NonCacheable } from \"./types\";\r\n\r\nexport const rootNodePath = require.resolve(\"mc-nbt-paths/root.json\");\r\nexport const modulePath = path.dirname(rootNodePath);\r\n\r\nexport async function setupFiles(dir: string = modulePath): Promise<MemoryFS> {\r\n    const docfs = new MemoryFS(dir);\r\n    const paths = await walkDir(dir);\r\n    const promises: Array<Promise<void>> = [];\r\n    for (const p of paths) {\r\n        promises.push(docfs.load(p));\r\n    }\r\n    await Promise.all(promises);\r\n    return docfs;\r\n}\r\n\r\nexport async function loadNonCached(): Promise<NonCacheable> {\r\n    const [nbtDocs] = await Promise.all([setupFiles()]);\r\n    return { nbt_docs: nbtDocs };\r\n}\r\n","import {\r\n    DidChangeWatchedFilesParams,\r\n    FileChangeType\r\n} from \"vscode-languageserver\";\r\n\r\nimport { extname, join } from \"path\";\r\nimport { MCMETAFILE } from \"../consts\";\r\nimport {\r\n    getKindAndNamespace,\r\n    namespacesEqual,\r\n    PackLocationSegments,\r\n    parseDataPath,\r\n    resourceTypes,\r\n    ReturnHelper\r\n} from \"../misc-functions\";\r\nimport { createExtensionFileError } from \"../misc-functions/file-errors\";\r\nimport { readJSON } from \"../misc-functions/promisified-fs\";\r\nimport { ReturnedInfo, ReturnSuccess } from \"../types\";\r\nimport { readCache } from \"./cache\";\r\nimport { getPacksInfo } from \"./datapack-resources\";\r\nimport { collectGlobalData } from \"./extractor\";\r\nimport { loadNonCached } from \"./noncached\";\r\nimport {\r\n    Datapack,\r\n    DataPackID,\r\n    GlobalData,\r\n    LocalData,\r\n    McmetaFile,\r\n    MinecraftResource,\r\n    WorldInfo\r\n} from \"./types\";\r\n\r\nexport class DataManager {\r\n    /**\r\n     * Create a datamanager using Dummy Data for running tests.\r\n     */\r\n    public static newWithData(\r\n        dummyGlobal?: DataManager[\"globalDataInternal\"],\r\n        dummyPacks?: DataManager[\"packDataComplete\"]\r\n    ): DataManager {\r\n        const manager = new DataManager();\r\n\r\n        manager.globalDataInternal = dummyGlobal || manager.globalDataInternal;\r\n        Object.assign(manager.packDataComplete, dummyPacks);\r\n        return manager;\r\n    }\r\n    //#region Data Management\r\n    private globalDataInternal: GlobalData = {} as GlobalData;\r\n\r\n    private readonly packDataComplete: { [root: string]: WorldInfo } = {};\r\n\r\n    private readonly packDataPromises: {\r\n        [root: string]: Promise<ReturnSuccess<WorldInfo>>;\r\n    } = {};\r\n\r\n    public get globalData(): GlobalData {\r\n        return this.globalDataInternal;\r\n    }\r\n    //#endregion\r\n    //#region Constructor\r\n    //#endregion\r\n    public getPackFolderData(\r\n        folder: PackLocationSegments | undefined\r\n    ): LocalData | undefined {\r\n        if (\r\n            !!folder &&\r\n            this.packDataComplete.hasOwnProperty(folder.packsFolder)\r\n        ) {\r\n            const info = this.packDataComplete[folder.packsFolder];\r\n\r\n            return { ...info, current: info.packnamesmap[folder.pack] };\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    public async handleChanges(\r\n        event: DidChangeWatchedFilesParams\r\n    ): Promise<ReturnedInfo<undefined>> {\r\n        const helper = new ReturnHelper(false);\r\n        const firsts = new Set<string>();\r\n        const promises = event.changes.map(async change => {\r\n            try {\r\n                const parsedPath = parseDataPath(change.uri);\r\n                if (parsedPath) {\r\n                    interface InlineData {\r\n                        data: WorldInfo;\r\n                        pack: Datapack;\r\n                        packID: DataPackID;\r\n                    }\r\n                    const getData = async (): Promise<InlineData> => {\r\n                        const first = await this.readPackFolderData(\r\n                            parsedPath.packsFolder\r\n                        );\r\n                        if (first) {\r\n                            firsts.add(parsedPath.packsFolder);\r\n                        }\r\n                        const data = this.getPackFolderData(parsedPath);\r\n                        if (!data) {\r\n                            throw new Error(\r\n                                \"Could not load data from datapacks folder\"\r\n                            );\r\n                        }\r\n                        const packID = data.packnamesmap[parsedPath.pack];\r\n                        const pack = data.packs[packID];\r\n                        return { data, pack, packID };\r\n                    };\r\n\r\n                    if (parsedPath.rest === MCMETAFILE) {\r\n                        const { pack } = await getData();\r\n                        if (!firsts.has(parsedPath.packsFolder)) {\r\n                            const res = await readJSON<McmetaFile>(change.uri);\r\n                            pack.mcmeta = helper.merge(res)\r\n                                ? res.data\r\n                                : undefined;\r\n                        }\r\n                    } else {\r\n                        const namespace = getKindAndNamespace(parsedPath.rest);\r\n                        if (namespace) {\r\n                            const { pack, packID, data } = await getData();\r\n                            if (!firsts.has(parsedPath.packsFolder)) {\r\n                                const shouldUpdateContents =\r\n                                    change.type === FileChangeType.Changed &&\r\n                                    resourceTypes[namespace.kind].mapFunction;\r\n                                let contents = pack.data[namespace.kind];\r\n                                if (\r\n                                    (change.type === FileChangeType.Deleted ||\r\n                                        shouldUpdateContents) &&\r\n                                    !!contents\r\n                                ) {\r\n                                    for (let i = 0; i < contents.length; i++) {\r\n                                        const element = contents[i];\r\n                                        if (\r\n                                            namespacesEqual(\r\n                                                element,\r\n                                                namespace.location\r\n                                            )\r\n                                        ) {\r\n                                            contents.splice(i, 1);\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                }\r\n                                if (\r\n                                    change.type === FileChangeType.Created ||\r\n                                    shouldUpdateContents\r\n                                ) {\r\n                                    if (!contents) {\r\n                                        contents = pack.data[\r\n                                            namespace.kind\r\n                                        ] = [];\r\n                                    }\r\n                                    const newResource: MinecraftResource = {\r\n                                        ...namespace.location,\r\n                                        pack: packID\r\n                                    };\r\n                                    const actual = extname(change.uri);\r\n                                    const expected =\r\n                                        resourceTypes[namespace.kind].extension;\r\n                                    if (actual === expected) {\r\n                                        const mapFunction =\r\n                                            // tslint:disable-next-line:no-unbound-method We control this function, so we know it won't use the this keyword.\r\n                                            resourceTypes[namespace.kind]\r\n                                                .mapFunction;\r\n                                        if (mapFunction) {\r\n                                            const result = await mapFunction(\r\n                                                newResource,\r\n                                                join(\r\n                                                    parsedPath.packsFolder,\r\n                                                    parsedPath.pack\r\n                                                ),\r\n                                                this.globalData,\r\n                                                data\r\n                                            );\r\n                                            if (helper.merge(result)) {\r\n                                                contents.push(result.data);\r\n                                            }\r\n                                        } else {\r\n                                            contents.push(newResource);\r\n                                        }\r\n                                    } else {\r\n                                        helper.addMisc(\r\n                                            createExtensionFileError(\r\n                                                change.uri,\r\n                                                expected,\r\n                                                actual\r\n                                            )\r\n                                        );\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                mcLangLog(\r\n                    `Change ${JSON.stringify(\r\n                        change\r\n                    )} could not be completed, due to '${JSON.stringify(\r\n                        error\r\n                    )}'`\r\n                );\r\n            }\r\n        });\r\n        await Promise.all(promises);\r\n        return helper.succeed();\r\n    }\r\n\r\n    public async loadGlobalData(): Promise<true | string> {\r\n        let version: string | undefined;\r\n        if (!!this.globalData.meta_info) {\r\n            version = this.globalData.meta_info.version;\r\n        }\r\n        try {\r\n            const helper = new ReturnHelper();\r\n            const data = await collectGlobalData(version);\r\n            const noncache = await loadNonCached();\r\n            helper.merge(data);\r\n            this.globalDataInternal = { ...data.data, ...noncache };\r\n            return true;\r\n        } catch (error) {\r\n            return `Error loading global data: ${error.stack ||\r\n                error.toString()}`;\r\n        }\r\n    }\r\n\r\n    public async readCache(): Promise<boolean> {\r\n        try {\r\n            const cache = await readCache();\r\n            const noncache = await loadNonCached();\r\n            this.globalDataInternal = { ...cache, ...noncache };\r\n            mcLangLog(\"Cache Successfully read\");\r\n            return true;\r\n        } catch (error) {\r\n            mcLangLog(\r\n                `Reading cache failed with error ${JSON.stringify(error)}`\r\n            );\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @returns Whether this is the first request for this folder\r\n     */\r\n    public async readPackFolderData(\r\n        folder: string\r\n    ): Promise<ReturnedInfo<void>> {\r\n        const helper = new ReturnHelper();\r\n        if (!this.packDataPromises.hasOwnProperty(folder)) {\r\n            this.packDataPromises[folder] = getPacksInfo(\r\n                folder,\r\n                this.globalData\r\n            );\r\n            const result = await this.packDataPromises[folder];\r\n            this.packDataComplete[folder] = result.data;\r\n            helper.merge(result);\r\n            return helper.succeed();\r\n        } else {\r\n            await this.packDataPromises[folder];\r\n            return helper.fail();\r\n        }\r\n    }\r\n}\r\n","/**\r\n * merge_deep function adapted from:\r\n *\r\n * https://stackoverflow.com/a/34749873/8728461\r\n *\r\n * Originally, non-typescript code by: https://github.com/salakar\r\n */\r\n\r\ntype AnyDict = Dictionary<any>;\r\n\r\n/**\r\n * Simple object check.\r\n * @param item the item\r\n */\r\nexport function isObject(item: any): item is AnyDict {\r\n    return item && typeof item === \"object\" && !Array.isArray(item);\r\n}\r\n\r\n/**\r\n * Deep merge two objects.\r\n */\r\nexport function mergeDeep(target: AnyDict, ...sources: AnyDict[]): AnyDict {\r\n    if (!sources.length) {\r\n        return target;\r\n    }\r\n    const source = sources.shift();\r\n    if (isObject(target) && isObject(source)) {\r\n        for (const key in source) {\r\n            if (isObject(source[key])) {\r\n                if (!target[key]) {\r\n                    Object.assign(target, { [key]: {} });\r\n                }\r\n                mergeDeep(target[key], source[key]);\r\n            } else {\r\n                Object.assign(target, { [key]: source[key] });\r\n            }\r\n        }\r\n    }\r\n    return mergeDeep(target, ...sources);\r\n}\r\n","import { EventEmitter } from \"events\";\r\nimport { DiagnosticSeverity } from \"vscode-languageserver/lib/main\";\r\n\r\nimport { CommandErrorBuilder } from \"./brigadier/errors\";\r\nimport { StringReader } from \"./brigadier/string-reader\";\r\nimport { COMMENT_START, SPACE } from \"./consts\";\r\nimport { DataManager } from \"./data/manager\";\r\nimport {\r\n    CommandNode,\r\n    CommandNodePath,\r\n    GlobalData,\r\n    LocalData\r\n} from \"./data/types\";\r\nimport {\r\n    createParserInfo,\r\n    getNextNode,\r\n    isSuccessful,\r\n    ReturnHelper\r\n} from \"./misc-functions\";\r\nimport { getParser } from \"./parsers/get-parser\";\r\nimport {\r\n    CommandContext,\r\n    CommmandData,\r\n    FunctionInfo,\r\n    ParseNode,\r\n    ReturnedInfo,\r\n    StoredParseResult\r\n} from \"./types\";\r\n\r\nconst parseExceptions = {\r\n    Ambiguity: new CommandErrorBuilder(\r\n        \"parsing.command.ambiguous\",\r\n        \"Command text is possibly ambiguous\",\r\n        DiagnosticSeverity.Information\r\n    ),\r\n    NoSuccesses: new CommandErrorBuilder(\r\n        \"command.parsing.matchless\",\r\n        \"No nodes which matched '%s' found\"\r\n    ),\r\n    NotRunnable: new CommandErrorBuilder(\r\n        \"parsing.command.executable\",\r\n        \"The command '%s' cannot be run.\",\r\n        DiagnosticSeverity.Warning\r\n    )\r\n};\r\n\r\nexport function parseCommand(\r\n    text: string,\r\n    globalData: GlobalData,\r\n    localData: LocalData | undefined\r\n): StoredParseResult | void {\r\n    if (text.length === 0 || text.startsWith(COMMENT_START)) {\r\n        return undefined;\r\n    }\r\n    const reader = new StringReader(text);\r\n    const data: CommmandData = { globalData, localData };\r\n    const startingcontext: CommandContext = {};\r\n    const recurse = parsechildren(\r\n        reader,\r\n        globalData.commands as any,\r\n        [],\r\n        data,\r\n        startingcontext\r\n    );\r\n    const nodes: ParseNode[] = [];\r\n    if (isSuccessful(recurse)) {\r\n        nodes.push(...recurse.data);\r\n    }\r\n    return { actions: recurse.actions, nodes, errors: recurse.errors };\r\n}\r\n\r\nfunction parsechildren(\r\n    reader: StringReader,\r\n    node: CommandNode,\r\n    path: CommandNodePath,\r\n    data: CommmandData,\r\n    context: CommandContext\r\n): ReturnedInfo<ParseNode[]> {\r\n    const parent = getNextNode(node, path, data.globalData.commands);\r\n    const helper = new ReturnHelper();\r\n    const children = parent.node.children;\r\n    if (children) {\r\n        const nodes: ParseNode[] = [];\r\n        const start = reader.cursor;\r\n        let successCount = 0;\r\n        let min: number = reader.getTotalLength();\r\n        for (const childKey of Object.keys(children)) {\r\n            const child = children[childKey];\r\n            const childpath = [...parent.path, childKey];\r\n            const result = parseAgainstNode(\r\n                reader,\r\n                child,\r\n                childpath,\r\n                data,\r\n                context\r\n            );\r\n            if (helper.merge(result)) {\r\n                const newNode: ParseNode = {\r\n                    context,\r\n                    final: true,\r\n                    high: reader.cursor,\r\n                    low: start,\r\n                    path: childpath\r\n                };\r\n                const childdata = result.data;\r\n                function checkRead(): boolean {\r\n                    if (reader.canRead()) {\r\n                        return true;\r\n                    } else {\r\n                        if (!childdata.node.executable) {\r\n                            helper.addErrors(\r\n                                parseExceptions.NotRunnable.create(\r\n                                    0,\r\n                                    reader.cursor,\r\n                                    reader.string\r\n                                )\r\n                            );\r\n                        }\r\n                        return false;\r\n                    }\r\n                }\r\n                if (checkRead()) {\r\n                    if (reader.peek() === SPACE) {\r\n                        successCount++;\r\n                        reader.skip();\r\n                        if (checkRead()) {\r\n                            const newContext = childdata.newContext\r\n                                ? childdata.newContext\r\n                                : context;\r\n                            const recurse = parsechildren(\r\n                                reader,\r\n                                childdata.node,\r\n                                childpath,\r\n                                data,\r\n                                newContext\r\n                            );\r\n                            if (helper.merge(recurse)) {\r\n                                min = Math.min(min, reader.cursor);\r\n                                nodes.push(...recurse.data);\r\n                                newNode.final = false;\r\n                            }\r\n                        }\r\n                        nodes.push(newNode);\r\n                    }\r\n                } else {\r\n                    successCount++;\r\n                    nodes.push(newNode);\r\n                }\r\n            }\r\n            reader.cursor = start;\r\n        }\r\n        if (successCount === 0) {\r\n            return helper.fail(\r\n                parseExceptions.NoSuccesses.create(\r\n                    reader.cursor,\r\n                    reader.getTotalLength(),\r\n                    reader.getRemaining()\r\n                )\r\n            );\r\n        }\r\n        if (successCount > 1) {\r\n            helper.addErrors(parseExceptions.Ambiguity.create(start, min));\r\n        }\r\n        return helper.succeed(nodes);\r\n    } else {\r\n        if (!(parent.node as CommandNode).executable) {\r\n            mcLangLog(\r\n                `Malformed tree at path ${JSON.stringify(\r\n                    path\r\n                )}. No children and not executable`\r\n            );\r\n        }\r\n        return helper.fail();\r\n    }\r\n}\r\n\r\ninterface NodeParseSuccess {\r\n    max: number;\r\n    newContext?: CommandContext;\r\n    node: CommandNode;\r\n}\r\n\r\nfunction parseAgainstNode(\r\n    reader: StringReader,\r\n    node: CommandNode,\r\n    path: CommandNodePath,\r\n    data: CommmandData,\r\n    context: CommandContext\r\n): ReturnedInfo<NodeParseSuccess> {\r\n    const parser = getParser(node);\r\n    const helper = new ReturnHelper(false);\r\n    if (!!parser) {\r\n        const result = parser.parse(\r\n            reader,\r\n            createParserInfo(node, data, path, context, false)\r\n        );\r\n        if (!!result) {\r\n            if (helper.merge(result)) {\r\n                const newContext = { ...context, ...result.data };\r\n                return helper.succeed<NodeParseSuccess>({\r\n                    max: reader.cursor,\r\n                    newContext,\r\n                    node\r\n                });\r\n            } else {\r\n                return helper.fail();\r\n            }\r\n        } else {\r\n            return helper.succeed<NodeParseSuccess>({\r\n                max: reader.cursor,\r\n                node\r\n            });\r\n        }\r\n    } else {\r\n        return helper.fail();\r\n    }\r\n}\r\n\r\nexport function parseLines(\r\n    document: FunctionInfo,\r\n    data: DataManager,\r\n    emitter: EventEmitter,\r\n    documentUri: string,\r\n    lines: number[]\r\n): void {\r\n    for (const lineNo of lines) {\r\n        const line = document.lines[lineNo];\r\n        const packsInfo = data.getPackFolderData(document.pack_segments);\r\n        let localData: LocalData | undefined;\r\n        if (packsInfo && document.pack_segments) {\r\n            localData = {\r\n                ...packsInfo,\r\n                current: packsInfo.packnamesmap[document.pack_segments.pack]\r\n            };\r\n        }\r\n        const result = parseCommand(line.text, data.globalData, localData);\r\n        line.parseInfo = result ? result : false;\r\n        line.actions = undefined;\r\n        line.nodes = undefined;\r\n        emitter.emit(`${documentUri}:${lineNo}`);\r\n    }\r\n}\r\n\r\nexport function parseDocument(\r\n    document: FunctionInfo,\r\n    data: DataManager,\r\n    emitter: EventEmitter,\r\n    documentUri: string\r\n): void {\r\n    const lines = document.lines.map((_, i) => i);\r\n    parseLines(document, data, emitter, documentUri, lines);\r\n}\r\n","import { EventEmitter } from \"events\";\r\nimport { promisify } from \"util\";\r\nimport { shim } from \"util.promisify\";\r\nshim();\r\nimport { Interval, IntervalTree } from \"node-interval-tree\";\r\nimport {\r\n    CompletionList,\r\n    createConnection,\r\n    Diagnostic,\r\n    DidChangeWatchedFilesNotification,\r\n    Hover,\r\n    IPCMessageReader,\r\n    IPCMessageWriter,\r\n    Location,\r\n    Position,\r\n    TextDocumentPositionParams,\r\n    TextDocumentSyncKind\r\n} from \"vscode-languageserver/lib/main\";\r\nimport Uri from \"vscode-uri\";\r\n\r\nimport { computeCompletions } from \"./completions\";\r\nimport { readSecurity } from \"./data/cache\";\r\nimport { DataManager } from \"./data/manager\";\r\nimport { CommandNode } from \"./data/types\";\r\nimport {\r\n    actOnSecurity,\r\n    commandErrorToDiagnostic,\r\n    followPath,\r\n    isSuccessful,\r\n    parseDataPath,\r\n    runChanges,\r\n    securityIssues,\r\n    setup_logging,\r\n    splitLines\r\n} from \"./misc-functions\";\r\nimport { mergeDeep } from \"./misc-functions/third_party/merge-deep\";\r\nimport { parseDocument, parseLines } from \"./parse\";\r\nimport {\r\n    CommandLine,\r\n    FunctionInfo,\r\n    MiscInfo,\r\n    ParseNode,\r\n    SubAction,\r\n    WorkspaceSecurity\r\n} from \"./types\";\r\n\r\nconst connection = createConnection(\r\n    new IPCMessageReader(process),\r\n    new IPCMessageWriter(process)\r\n);\r\nconnection.listen();\r\n\r\n//#region Data Storage\r\nlet manager: DataManager;\r\nconst documents: Map<string, FunctionInfo> = new Map();\r\nconst fileErrors = new Map<string, { [group: string]: string }>();\r\n// Avoids race condition between parsing after change and getting completions\r\nconst parseCompletionEvents = new EventEmitter();\r\nlet security: Promise<WorkspaceSecurity>;\r\n\r\nlet started = false;\r\nlet starting = false;\r\n//#endregion\r\n\r\n// For Server Startup logic, see: https://github.com/Microsoft/language-server-protocol/issues/246\r\nconnection.onInitialize(() => {\r\n    setup_logging(connection);\r\n\r\n    manager = new DataManager();\r\n    return {\r\n        capabilities: {\r\n            completionProvider: {\r\n                resolveProvider: false\r\n            },\r\n            definitionProvider: true,\r\n            hoverProvider: true,\r\n            textDocumentSync: {\r\n                change: TextDocumentSyncKind.Incremental,\r\n                openClose: true\r\n            }\r\n        }\r\n    };\r\n});\r\n\r\n// Handles the starting of the server\r\nconnection.onDidChangeConfiguration(async params => {\r\n    let startinglocal = false;\r\n    if (!starting) {\r\n        starting = true;\r\n        startinglocal = true;\r\n        global.mcLangSettings = {} as McFunctionSettings;\r\n        security = readSecurity();\r\n    }\r\n    await ensureSecure(params.settings);\r\n    const reparseall = () => {\r\n        for (const [uri, doc] of documents.entries()) {\r\n            loadData(uri);\r\n            parseDocument(doc, manager, parseCompletionEvents, uri);\r\n            sendDiagnostics(uri);\r\n        }\r\n    };\r\n    if (startinglocal) {\r\n        const cacheread = await manager.readCache();\r\n        if (cacheread) {\r\n            started = true;\r\n            reparseall();\r\n        }\r\n        const getDataResult = await manager.loadGlobalData();\r\n        if (getDataResult === true) {\r\n            started = true;\r\n            reparseall();\r\n        } else if (!cacheread) {\r\n            connection.sendNotification(\"mcfunction/shutdown\", getDataResult);\r\n            return;\r\n        }\r\n    }\r\n});\r\n\r\nasync function ensureSecure(settings: {\r\n    mcfunction: Partial<McFunctionSettings>;\r\n}): Promise<void> {\r\n    const secure = await security;\r\n    const newsettings = mergeDeep(\r\n        {},\r\n        global.mcLangSettings,\r\n        settings.mcfunction\r\n    ) as McFunctionSettings;\r\n\r\n    try {\r\n        const issues = securityIssues(newsettings, secure);\r\n        if (issues.length > 0) {\r\n            // Failed security checkup challenge\r\n            const safeToContinue = await actOnSecurity(\r\n                issues,\r\n                connection,\r\n                secure\r\n            );\r\n            if (!safeToContinue) {\r\n                connection.sendNotification(\r\n                    \"mcfunction/shutdown\",\r\n                    `Shutting down because of insecure settings: '${issues.join(\r\n                        \"', '\"\r\n                    )}'`\r\n                );\r\n                return;\r\n            }\r\n        }\r\n    } catch (error) {\r\n        connection.sendNotification(\r\n            \"mcfunction/shutdown\",\r\n            `Shutting down because of insecure settings: '${error}'`\r\n        );\r\n        return;\r\n    }\r\n    global.mcLangSettings = newsettings;\r\n}\r\n\r\nfunction loadData(uri: string): void {\r\n    const doc = documents.get(uri);\r\n    if (doc && doc.pack_segments) {\r\n        const segments = doc.pack_segments;\r\n        manager\r\n            .readPackFolderData(segments.packsFolder)\r\n            .then(first => {\r\n                if (isSuccessful(first)) {\r\n                    connection.client.register(\r\n                        DidChangeWatchedFilesNotification.type,\r\n                        {\r\n                            watchers: [\r\n                                {\r\n                                    globPattern: `${segments.packsFolder}/**/*`\r\n                                }\r\n                            ]\r\n                        }\r\n                    );\r\n                }\r\n                parseDocument(doc, manager, parseCompletionEvents, uri);\r\n                sendDiagnostics(uri);\r\n                handleMiscInfo(first.misc);\r\n            })\r\n            .catch(e => {\r\n                mcLangLog(`Getting pack folder data failed for reason: '${e}'`);\r\n            });\r\n    }\r\n}\r\n\r\nconnection.onDidOpenTextDocument(params => {\r\n    const uri = params.textDocument.uri;\r\n    const uriClass = Uri.parse(uri);\r\n    const parsethis = () => {\r\n        // Sanity check\r\n        if (started && documents.has(uri)) {\r\n            parseDocument(\r\n                documents.get(uri) as FunctionInfo,\r\n                manager,\r\n                parseCompletionEvents,\r\n                uri\r\n            );\r\n            sendDiagnostics(uri);\r\n        }\r\n    };\r\n    if (uriClass.scheme === \"file\") {\r\n        const fsPath = uriClass.fsPath;\r\n        const dataPackSegments = parseDataPath(fsPath);\r\n        documents.set(uri, {\r\n            lines: splitLines(params.textDocument.text),\r\n            pack_segments: dataPackSegments\r\n        });\r\n        if (started) {\r\n            loadData(uri);\r\n        }\r\n        parsethis();\r\n    } else {\r\n        documents.set(uri, {\r\n            lines: splitLines(params.textDocument.text),\r\n            pack_segments: undefined\r\n        });\r\n    }\r\n    parsethis();\r\n});\r\n\r\nconnection.onDidChangeTextDocument(params => {\r\n    const uri = params.textDocument.uri;\r\n    const document = documents.get(uri) as FunctionInfo;\r\n    const changedlines = runChanges(params, document);\r\n    if (started) {\r\n        parseLines(document, manager, parseCompletionEvents, uri, changedlines);\r\n        sendDiagnostics(uri);\r\n    }\r\n});\r\n\r\nfunction sendDiagnostics(uri: string): void {\r\n    const doc = documents.get(uri) as FunctionInfo;\r\n    const diagnostics: Diagnostic[] = [];\r\n    for (let line = 0; line < doc.lines.length; line++) {\r\n        const lineContent = doc.lines[line];\r\n        if (!!lineContent.parseInfo && !!lineContent.parseInfo.errors) {\r\n            diagnostics.push(\r\n                ...lineContent.parseInfo.errors.map(error =>\r\n                    commandErrorToDiagnostic(error, line)\r\n                )\r\n            );\r\n        }\r\n    }\r\n    connection.sendDiagnostics({ uri, diagnostics });\r\n}\r\n\r\nconnection.onDidCloseTextDocument(params => {\r\n    // Clear diagnostics - might not be needed\r\n    connection.sendDiagnostics({\r\n        diagnostics: [],\r\n        uri: params.textDocument.uri\r\n    });\r\n    documents.delete(params.textDocument.uri);\r\n});\r\n\r\nconnection.onDidChangeWatchedFiles(async e => {\r\n    const result = await manager.handleChanges(e);\r\n    handleMiscInfo(result.misc);\r\n});\r\n\r\nfunction handleMiscInfo(miscInfos: MiscInfo[]): void {\r\n    const changedFileErrors = new Set<string>();\r\n    for (const misc of miscInfos) {\r\n        if (misc.kind === \"FileError\") {\r\n            changedFileErrors.add(misc.filePath);\r\n            const value = fileErrors.get(misc.filePath);\r\n            if (value) {\r\n                fileErrors.set(misc.filePath, {\r\n                    ...value,\r\n                    group: misc.message\r\n                });\r\n            } else {\r\n                fileErrors.set(misc.filePath, {\r\n                    group: misc.message\r\n                });\r\n            }\r\n        }\r\n        if (misc.kind === \"ClearError\") {\r\n            changedFileErrors.add(misc.filePath);\r\n            const group = misc.group;\r\n            if (group) {\r\n                const value = fileErrors.get(misc.filePath);\r\n                if (value) {\r\n                    const { group: _, ...rest } = value;\r\n                    fileErrors.set(misc.filePath, { ...rest });\r\n                }\r\n            } else {\r\n                fileErrors.delete(misc.filePath);\r\n            }\r\n        }\r\n    }\r\n    for (const uri of changedFileErrors) {\r\n        const value = fileErrors.get(uri);\r\n        if (value) {\r\n            const diagnostics: Diagnostic[] = [];\r\n            for (const group of Object.keys(value)) {\r\n                diagnostics.push({\r\n                    message: value[group],\r\n                    range: {\r\n                        end: { line: 0, character: 0 },\r\n                        start: { line: 0, character: 0 }\r\n                    }\r\n                });\r\n            }\r\n            connection.sendDiagnostics({ uri, diagnostics });\r\n        }\r\n    }\r\n}\r\n\r\nconnection.onCompletion(params => {\r\n    const doc = documents.get(params.textDocument.uri) as FunctionInfo;\r\n    const line = doc.lines[params.position.line];\r\n    const computeCompletionsLocal = () =>\r\n        computeCompletions(\r\n            params.position.line,\r\n            params.position.character,\r\n            doc,\r\n            manager\r\n        );\r\n    if (!started) {\r\n        return [];\r\n    }\r\n    if (line.hasOwnProperty(\"parseInfo\")) {\r\n        return computeCompletionsLocal();\r\n    } else {\r\n        return promisify(cb =>\r\n            parseCompletionEvents.once(\r\n                `${params.textDocument.uri}:${params.position.line}`,\r\n                cb\r\n            )\r\n        )().then<CompletionList>(computeCompletionsLocal);\r\n    }\r\n});\r\n\r\nconnection.onHover(params => {\r\n    if (started) {\r\n        const docLine = getLine(params);\r\n        if (docLine) {\r\n            function computeIntervalHovers<T extends Interval>(\r\n                intervals: T[],\r\n                commandLine: CommandLine,\r\n                line: number,\r\n                map: (intervals: T[]) => Hover[\"contents\"]\r\n            ): Hover {\r\n                const end: Position = {\r\n                    character: intervals.reduce(\r\n                        (acc, v) => Math.max(acc, v.high),\r\n                        0\r\n                    ),\r\n                    line\r\n                };\r\n                const start: Position = {\r\n                    character: intervals.reduce(\r\n                        (acc, v) => Math.min(acc, v.low),\r\n                        commandLine.text.length\r\n                    ),\r\n                    line\r\n                };\r\n                return {\r\n                    contents: map(intervals),\r\n                    range: { start, end }\r\n                };\r\n            }\r\n            const hovers = getActionsOfKind(docLine, params.position, \"hover\");\r\n            if (hovers.length > 0) {\r\n                return computeIntervalHovers(\r\n                    hovers,\r\n                    docLine,\r\n                    params.position.line,\r\n                    i => i.map(v => v.data)\r\n                );\r\n            } else {\r\n                const tree = getNodeTree(docLine);\r\n                if (tree) {\r\n                    const matching = tree.search(\r\n                        params.position.character,\r\n                        params.position.character\r\n                    );\r\n                    if (matching.length > 0) {\r\n                        return computeIntervalHovers(\r\n                            matching,\r\n                            docLine,\r\n                            params.position.line,\r\n                            i =>\r\n                                i.map<string>(node => {\r\n                                    const data = followPath(\r\n                                        manager.globalData.commands,\r\n                                        node.path\r\n                                    ) as CommandNode;\r\n                                    return `${\r\n                                        data.type === \"literal\"\r\n                                            ? \"literal\"\r\n                                            : `\\`${data.parser}\\` parser`\r\n                                    } on path '${node.path.join(\", \")}'`;\r\n                                })\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return undefined;\r\n});\r\n\r\nconnection.onDefinition(params => {\r\n    const docLine = getLine(params);\r\n    if (docLine) {\r\n        const actions = getActionsOfKind(docLine, params.position, \"source\");\r\n        const start: Position = { line: 0, character: 0 };\r\n        return actions.map<Location>(a => ({\r\n            range: { start, end: start },\r\n            uri: Uri.file(a.data as any).toString()\r\n        }));\r\n    }\r\n    return [];\r\n});\r\n\r\nfunction getLine(params: TextDocumentPositionParams): CommandLine | undefined {\r\n    const doc = documents.get(params.textDocument.uri);\r\n    if (doc) {\r\n        const line = doc.lines[params.position.line];\r\n\r\n        return line;\r\n    }\r\n    return undefined;\r\n}\r\n\r\nfunction getActionsOfKind(\r\n    line: CommandLine,\r\n    position: Position,\r\n    kind: SubAction[\"type\"]\r\n): SubAction[] {\r\n    if (line.parseInfo) {\r\n        if (!line.actions) {\r\n            line.actions = new IntervalTree();\r\n            for (const action of line.parseInfo.actions) {\r\n                line.actions.insert(action);\r\n            }\r\n        }\r\n        const tree = line.actions;\r\n        return tree\r\n            .search(position.character, position.character)\r\n            .filter(v => v.type === kind);\r\n    }\r\n    return [];\r\n}\r\n\r\nfunction getNodeTree(line: CommandLine): IntervalTree<ParseNode> | undefined {\r\n    if (line.nodes) {\r\n        return line.nodes;\r\n    }\r\n    if (line.parseInfo) {\r\n        const tree = new IntervalTree<ParseNode>();\r\n        for (const node of line.parseInfo.nodes) {\r\n            tree.insert(node);\r\n        }\r\n        return tree;\r\n    }\r\n    return undefined;\r\n}\r\n"]}