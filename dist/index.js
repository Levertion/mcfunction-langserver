parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"qA/9":[function(require,module,exports) {
"use strict";function t(t,n){for(const r of t)if(e(n,r.path))return r.data}function e(t,e){return t.length===e.length&&t.every((t,n)=>t===e[n])}function n(t,e){let n=[0,void 0];for(const r of t)r.path.length>n[0]&&r.path.length<=e.length&&r.path.every((t,n)=>t===e[n])&&(n=[r.path.length,r.data]);return n[1]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.resolvePaths=t,exports.startPaths=n;
},{}],"WIIZ":[function(require,module,exports) {
"use strict";function e(e,t,r,n,o){return{context:n,data:t,node_properties:e.properties||{},path:r,suggesting:o}}function t(e){return r(e.split(/\r?\n/))}function r(e){const t=[];for(const r of e)t.push({text:r});return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createParserInfo=e,exports.splitLines=t,exports.createCommandLines=r;
},{}],"xb+0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.COMMENT_START="#",exports.SPACE=" ",exports.DEFAULT_NAMESPACE="minecraft",exports.NAMESPACE=":",exports.DATAFOLDER="data",exports.SLASH="/",exports.MCMETAFILE="pack.mcmeta",exports.TAG_START="#";
},{}],"JulZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../consts");function t(e,t){return n(e,t)&&e.path===t.path}function n(e,t){return e.namespace===t.namespace||a(e)&&a(t)}function a(t){return void 0===t.namespace||t.namespace===e.DEFAULT_NAMESPACE}function s(t){return(t.namespace?t.namespace:e.DEFAULT_NAMESPACE)+e.NAMESPACE+t.path}function r(t,n=e.NAMESPACE){const a=t.indexOf(n);if(a>=0){const e=t.substring(a+n.length,t.length);return a>=1?{namespace:t.substring(0,a),path:e}:{path:e}}return{path:t}}exports.namespacesEqual=t,exports.namesEqual=n,exports.isNamespaceDefault=a,exports.stringifyNamespace=s,exports.convertToNamespace=r;
},{"../consts":"xb+0"}],"8nfD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./namespace");function t(e,t){return s(t,e.globalData,e.localData)}function s(e,t,s){const o=[],r=t.resources[e];if(r&&o.push(...r),s)for(const t in s.packs)if(s.packs.hasOwnProperty(t)){const r=s.packs[t];if(r.data.hasOwnProperty(e)){const t=r.data[e];t&&o.push(...t)}}return o}function o(t,s){const o=[];for(const r of t)e.namespacesEqual(r,s)&&o.push(r);return o}exports.getResourcesofType=t,exports.getResourcesSplit=s,exports.getMatching=o;
},{"./namespace":"JulZ"}],"3The":[function(require,module,exports) {
"use strict";function e(e,r,t){return{filePath:e,group:"extension",kind:"FileError",message:`File has incorrect extension: Expected ${r}, got ${t}.`}}function r(e,r){return{filePath:e,group:"json",kind:"FileError",message:`JSON parsing failed: '${r}'`}}function t(e,r){return{kind:"ClearError",filePath:e,group:r}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createExtensionFileError=e,exports.createJSONFileError=r,exports.createFileClear=t;
},{}],"lIyQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("vscode-languageserver/lib/main"),t=require("../misc-functions");class r{constructor(t,r,s=e.DiagnosticSeverity.Error){this.code=t,this.default=r,this.severity=s}create(e,t,...r){return Object.assign(this.createBlank(...r),{range:{start:e,end:t}})}createBlank(...e){return{code:this.code,severity:this.severity,substitutions:e,text:t.MCFormat(this.default,...e)}}}function s(e,t,r){return Object.assign({},e,{range:{start:t,end:r}})}exports.CommandErrorBuilder=r,exports.fillBlankError=s;
},{"../misc-functions":"irtH"}],"UL96":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.success=!0,exports.failure=!1;
},{}],"S4yr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const s=require("../brigadier/errors"),t=require("../types");function e(){return{actions:[],errors:[],suggestions:[],misc:[]}}function i(s){return s.kind===t.success}function r(t,e,i){const r=[];for(const g of t.errors)r.push(s.fillBlankError(g,e,i));return Object.assign({},t,{errors:r})}exports.isSuccessful=i,exports.fillBlanks=r;class g{constructor(s){if(this.data=e(),void 0!==s){if("boolean"==typeof s)return void(this.suggesting=s);this.suggesting=s.suggesting}}addActions(...s){return void 0!==this.suggesting&&this.suggesting||this.data.actions.push(...s),this}addErrors(...s){return void 0!==this.suggesting&&this.suggesting||this.data.errors.push(...s),this}addFileErrorIfFalse(s,t,e,i){return s?this.addMisc({group:e,filePath:t,kind:"ClearError"}):this.addMisc({group:e,message:i,filePath:t,kind:"FileError"}),s}addMisc(...s){return void 0!==this.suggesting&&this.suggesting||this.data.misc.push(...s),this}addSuggestion(s,t,e,i){return(void 0===this.suggesting||this.suggesting)&&this.addSuggestions({description:i,kind:e,start:s,text:t}),this}addSuggestions(...s){return(void 0===this.suggesting||this.suggesting)&&this.data.suggestions.push(...s),this}fail(s){return s&&!this.suggesting&&this.addErrors(s),Object.assign({},this.getShared(),{kind:t.failure})}failWithData(s){return Object.assign({},this.getShared(),{data:s,kind:t.failure})}getShared(){return this.data}merge(s,t){return this.mergeChain(s,t),i(s)}mergeChain(s,t){let e;switch(void 0!==t?e=t:void 0!==this.suggesting&&(e=this.suggesting),e){case!0:this.mergeSuggestions(s);break;case!1:this.mergeSafe(s);break;default:this.mergeSuggestions(s),this.mergeSafe(s)}return this}return(s){return this.merge(s)?this.succeed(s.data):this.failWithData(s.data)}succeed(s){return Object.assign({},this.getShared(),{data:s,kind:t.success})}mergeSafe(s){this.addActions(...s.actions),this.addErrors(...s.errors),this.addMisc(...s.misc)}mergeSuggestions(s){this.addSuggestions(...s.suggestions)}}function n(s,t){const e=new g(t);return e.merge(s)?e.succeed():e.fail()}exports.ReturnHelper=g,exports.prepareForParser=n;
},{"../brigadier/errors":"lIyQ","../types":"UL96"}],"DjTX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const r=require("tslib"),e=r.__importStar(require("fs")),t=r.__importStar(require("path")),i=require("util.promisify");i.shim();const s=require("util"),a=require("./file-errors"),n=require("./return-helper");async function o(r){const e=await exports.readFileAsync(r);return JSON.parse(e.toString())}async function c(r,e){await exports.saveFileAsync(r,JSON.stringify(e))}async function p(r){const e=new n.ReturnHelper;let t;try{t=await exports.readFileAsync(r)}catch(t){return mcLangLog(`File at '${r}' not available: ${t}`),e.fail()}try{const i=JSON.parse(t.toString());return e.succeed(i)}catch(t){return e.addMisc(a.createJSONFileError(r,t)).fail()}}async function u(r){const e=[];try{e.push(...await exports.readDirAsync(r))}catch(r){return[]}const i=e.map(async e=>{try{const i=[],s=t.join(r,e);return(await exports.statAsync(s)).isDirectory()?i.push(...await u(s)):i.push(s),i}catch(r){return[]}}),s=await Promise.all(i);return[].concat(...s)}exports.readFileAsync=s.promisify(e.readFile),exports.saveFileAsync=s.promisify(e.writeFile),exports.mkdirAsync=s.promisify(e.mkdir),exports.readDirAsync=s.promisify(e.readdir),exports.statAsync=s.promisify(e.stat),exports.readJSONRaw=o,exports.writeJSON=c,exports.readJSON=p,exports.walkDir=u;
},{"./file-errors":"3The","./return-helper":"S4yr"}],"IXKy":[function(require,module,exports) {
"use strict";function e(e){return Object.keys(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.typed_keys=e;
},{}],"Pj+z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("tslib"),t=e.__importStar(require("path")),s=require("../consts"),a=require("./group-resources"),n=require("./namespace"),o=require("./promisified-fs"),r=require("./return-helper"),i=require("./third_party/typed-keys");function c(e,s=t){const a=s.parse(s.normalize(e)),n=a.dir.split(s.sep),o=n.indexOf("datapacks");if(-1!==o){const e=n.slice(o+1);if(e.length>=1){let t=s.join(...n.slice(0,o+1));"/"!==s.sep||s.isAbsolute(t)||(t=s.sep+t),t=s.format({dir:t});const r=s.join(...e.slice(1),a.base);return{packsFolder:t,pack:e[0],rest:r}}}}function l(e,a=t){const n=a.normalize(e).split(a.sep);if(n[0]===s.DATAFOLDER&&n.length>2){const e=n.splice(2);for(const t of i.typed_keys(exports.resourceTypes)){const o=exports.resourceTypes[t];if(o.path.every((t,s)=>e[s]===t)){const r=n[1],i=e.slice(o.path.length);if(i.length>0){const e=i[i.length-1];if(a.extname(e)===o.extension){return{kind:t,location:{namespace:r,path:a.join(...i.slice(0,-1),e.slice(0,-o.extension.length)).replace(a.sep,s.SLASH)}}}}}}}}function p(e,a,n,o=t){return o.join(a,s.DATAFOLDER,e.namespace,...exports.resourceTypes[n].path,e.path.replace(s.SLASH,o.sep).concat(exports.resourceTypes[n].extension))}function u(e,s,a,n=t){if(e.pack){const t=s.packs[e.pack];return p(e,n.join(s.location,t.name),a,n)}}async function d(e,t,i,c,l){const u=new r.ReturnHelper,d=p(e,t,i),g=await o.readJSON(d);if(u.merge(g)&&u.addFileErrorIfFalse(!!g.data.values,d,"InvalidTagNoValues",`tag does not have a values key: ${JSON.stringify(g.data)}`)&&u.addFileErrorIfFalse(Array.isArray(g.data.values),d,"InvalidTagValuesNotArray",`tag values is not an array: ${JSON.stringify(g.data.values)}`)&&u.addFileErrorIfFalse(g.data.values.every(e=>"string"==typeof e),d,"InvalidTagValuesNotString",`tag values contains a non string value: ${JSON.stringify(g.data.values)}`)){const t=new Set,o=new Set,r=new Set;for(const e of g.data.values)if(t.has(e)&&o.add(e),t.add(e),e.startsWith(s.TAG_START)){0===a.getMatching(c,n.convertToNamespace(e)).length&&r.add(e)}else l(e)||r.add(e);return u.addFileErrorIfFalse(0===o.size,d,"InvalidTagValuesDuplicates",`Tag contains duplicate values: "${[...o].join('", "')}"`),u.addFileErrorIfFalse(0===r.size,d,"InvalidTagValuesUnknown",`Tag contains unknown values: "${[...r].join('", "')}"`),u.succeed(Object.assign({},e,{data:g.data}))}return u.succeed(e)}exports.parseDataPath=c,exports.resourceTypes={advancements:{extension:".json",path:["advancements"]},block_tags:{extension:".json",mapFunction:async(e,t,s,n)=>d(e,t,"block_tags",a.getResourcesSplit("block_tags",s,n),e=>s.blocks.hasOwnProperty(e)),path:["tags","blocks"]},function_tags:{extension:".json",mapFunction:async(e,t,s,o)=>{const r=a.getResourcesSplit("functions",s,o);return d(e,t,"function_tags",a.getResourcesSplit("function_tags",s,o),e=>a.getMatching(r,n.convertToNamespace(e)).length>0)},path:["tags","functions"]},functions:{extension:".mcfunction",path:["functions"]},item_tags:{extension:".json",mapFunction:async(e,t,s,n)=>d(e,t,"item_tags",a.getResourcesSplit("item_tags",s,n),e=>-1!==s.items.indexOf(e)),path:["tags","items"]},loot_tables:{extension:".json",path:["loot_tables"]},recipes:{extension:".json",path:["recipes"]},structures:{extension:".nbt",path:["structures"]}},exports.getKindAndNamespace=l,exports.getPath=p,exports.buildPath=u;
},{"../consts":"xb+0","./group-resources":"8nfD","./namespace":"JulZ","./promisified-fs":"DjTX","./return-helper":"S4yr","./third_party/typed-keys":"IXKy"}],"0ADi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("sprintf-js");function e(){return"en-us"!==mcLangSettings.translation.lang.toLowerCase()}function r(e,...r){return t.vsprintf(e,r)}exports.shouldTranslate=e,exports.MCFormat=r;
},{}],"kVgt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("vscode-languageserver/lib/main"),t=require("./creators"),n=require("./translation");function r(t,r){const s={end:{line:r,character:t.range.end},start:{line:r,character:t.range.start}},i=n.shouldTranslate()?`'${t.text}': Translation is not yet supported`:t.text;return e.Diagnostic.create(s,i,t.severity,t.code,"mcfunction")}function s(e,n){const r=[];for(const s of e.contentChanges)if(s.range){const{start:e,end:i}=s.range,a=n.lines[e.line].text.substring(0,e.character).concat(s.text,n.lines[i.line].text.substring(i.character)),o=i.line-e.line+1,c=t.splitLines(a);n.lines.splice(e.line,o,...c),r.forEach((t,n)=>{t>e.line&&(r[n]=t-o+c.length)}),r.push(...Array.from(new Array(c.length),(t,n)=>e.line+n))}const s=r.filter((e,t,n)=>n.indexOf(e)===t);return s.sort((e,t)=>e-t),s}exports.commandErrorToDiagnostic=r,exports.runChanges=s;
},{"./creators":"WIIZ","./translation":"0ADi"}],"jwqV":[function(require,module,exports) {
"use strict";function e(e,t){let o=e;for(const e of t)o.children&&o.children[e]&&(o=o.children[e]);return o}function t(t,o,r){const n=t.redirect;return n?{node:e(r,n),path:n}:t.children||t.executable?{node:t,path:o}:{node:r,path:[]}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.followPath=e,exports.getNextNode=t;
},{}],"T7Hz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("tslib"),s=e.__importStar(require("path")),t=require("../misc-functions/promisified-fs"),r=require("../misc-functions/third_party/typed-keys");if(!process.env.MCFUNCTION_CACHE_DIR)throw new Error("Environment variable MCFUNCTION_CACHE_DIR must be set");const n=process.env.MCFUNCTION_CACHE_DIR,i={blocks:"blocks.json",commands:"commands.json",items:"items.json",meta_info:"meta_info.json",resources:"resources.json"};async function o(){const e={},o=r.typed_keys(i);return await Promise.all(o.map(async r=>{e[r]=await t.readJSONRaw(s.join(n,i[r]))})),e}async function a(e){try{await t.mkdirAsync(n,"777")}catch(e){}const o=r.typed_keys(i);await Promise.all(o.map(async r=>t.writeJSON(s.join(n,i[r]),e[r])))}async function c(e){await t.saveFileAsync(s.join(n,"security.json"),JSON.stringify(e))}async function u(){try{return await t.readJSONRaw(s.join(n,"security.json"))}catch(e){return{}}}exports.readCache=o,exports.cacheData=a,exports.storeSecurity=c,exports.readSecurity=u;
},{"../misc-functions/promisified-fs":"DjTX","../misc-functions/third_party/typed-keys":"IXKy"}],"7l1Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../data/cache");function t(e,t){const r=[];if(e.data&&(e.data.customJar&&!0!==t.JarPath&&r.push("JarPath"),e.data.javaPath&&!0!==t.JavaPath&&r.push("JavaPath")),e.parsers)throw new Error("Custom parsers are not supported for client implementations.\nTo request this feature be enabled, open an issue at https://github.com/Levertion/mcfunction-langserver");return r}async function r(t,r,a){let s=!1;for(const e of t){const t=await Promise.resolve(r.window.showErrorMessage(`[MCFUNCTION] You have the potentially insecure setting '${e}' set, but no confirmation has been recieved.`,{title:"Yes"},{title:"No (Stops server)"}));if(!t||"Yes"!==t.title)return!1;a[e]=!0,s=!0}return await(async()=>{s&&await e.storeSecurity(a)})(),!0}exports.securityIssues=t,exports.actOnSecurity=r;
},{"../data/cache":"T7Hz"}],"9OF7":[function(require,module,exports) {
"use strict";function n(n){const e=e=>{n.console.log(e)};global.mcLangLog=Object.assign(e,{internal:n=>{mcLangSettings.trace.internalLogging&&e(`[McFunctionInternal] ${n}`)}})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.setup_logging=n;
},{}],"D271":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require(".."),a=require("../../brigadier/errors"),t=require("../namespace"),r={invalid_id:new a.CommandErrorBuilder("argument.id.invalid","Invalid character '%s' in location %s")},n=/[^a-z0-9_.-]/g;function s(e){return e.readWhileRegexp(/^[0-9a-z_:\/\.-]$/)}function i(e,a){return void 0===a.namespace?t.isNamespaceDefault(e)&&e.path.startsWith(a.path)||!!e.namespace&&e.namespace.startsWith(a.path):t.namesEqual(e,a)&&e.path.startsWith(a.path)}function c(a,t,r){const n=[];for(const s of a)i(s,t)&&n.push({text:e.stringifyNamespace(s),start:r});return n}function o(a,t,r){return c(a.map(a=>e.convertToNamespace(a)),t,r)}function p(a){const t=new e.ReturnHelper,i=a.cursor,c=s(a),o=e.convertToNamespace(c);let p,u=!1;do{if(p=n.exec(o.path)){const e=c.indexOf(":")+1+p.index+i;u=!0,t.addErrors(r.invalid_id.create(e,e+1,p[0],c))}}while(p);return u?t.fail():t.succeed(o)}function u(a,t,r){const n=new e.ReturnHelper,s=a.cursor,i=p(a);if(n.merge(i)){const e=d(i.data,t,!a.canRead(),s,r);return n.merge(e),e.data.length>0?n.succeed({literal:i.data,values:e.data}):n.failWithData(i.data)}return n.failWithData(void 0)}function d(a,t,r,n,s){const c=[],o=new e.ReturnHelper;for(const p of t)e.namespacesEqual(p,a)&&c.push(p),r&&i(p,a)&&o.addSuggestion(n,e.stringifyNamespace(p),s);return o.succeed(c)}exports.readNamespaceText=s,exports.namespaceStart=i,exports.namespaceSuggestions=c,exports.namespaceSuggestionString=o,exports.parseNamespace=p,exports.parseNamespaceOption=u,exports.processParsedNamespaceOption=d;
},{"..":"irtH","../../brigadier/errors":"lIyQ","../namespace":"JulZ"}],"pi1w":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("vscode-languageserver/lib/main"),t=require(".."),a=require("../../consts"),r=require("./namespace");function s(s,n,c){const i=new t.ReturnHelper(n),u=s.cursor;if(s.peek()===a.TAG_START){if(s.skip(),"string"==typeof c){const a=t.getResourcesofType(n.data,c),u=r.parseNamespaceOption(s,a,e.CompletionItemKind.Folder);if(i.merge(u)){const e=u.data.values,t=[];for(const r of e)t.push(...o(r,a));return i.succeed({parsed:u.data.literal,resolved:t,values:e})}return i.failWithData(u.data)}return r.readNamespaceText(s),i.fail(c.create(u,s.cursor))}{s.canRead()||"string"!=typeof c||i.addSuggestion(s.cursor,a.TAG_START,e.CompletionItemKind.Operator);const t=r.parseNamespace(s);return i.merge(t)?i.succeed({parsed:t.data}):i.fail()}}function o(e,r){if(!e.data)return[];const s=[];for(const n of e.data.values)if(n[0]===a.TAG_START){const e=t.convertToNamespace(n.substring(1));for(const a of r)t.namespacesEqual(e,a)&&s.push(...o(a,r))}else s.push(t.convertToNamespace(n));return s}function n(e,a,r,s){const o=new t.ReturnHelper;for(const n of e)if(n.data&&o.addActions({data:`\`\`\`json\n${JSON.stringify(n.data,void 0,4)}\n\`\`\``,high:r,low:a,type:"hover"}),s){const e=t.buildPath(n,s,"block_tags");e&&o.addActions({data:e,high:r,low:a,type:"source"})}return o.succeed()}exports.parseNamespaceOrTag=s,exports.buildTagActions=n;
},{"..":"irtH","../../consts":"xb+0","./namespace":"D271"}],"irtH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const r=require("tslib");r.__exportStar(require("./context"),exports),r.__exportStar(require("./creators"),exports),r.__exportStar(require("./datapack-folder"),exports),r.__exportStar(require("./file-errors"),exports),r.__exportStar(require("./group-resources"),exports),r.__exportStar(require("./lsp-conversions"),exports),r.__exportStar(require("./namespace"),exports),r.__exportStar(require("./node-tree"),exports),r.__exportStar(require("./promisified-fs"),exports),r.__exportStar(require("./return-helper"),exports),r.__exportStar(require("./security"),exports),r.__exportStar(require("./setup"),exports),r.__exportStar(require("./translation"),exports),r.__exportStar(require("./parsing/namespace"),exports),r.__exportStar(require("./parsing/nmsp-tag"),exports);
},{"./context":"qA/9","./creators":"WIIZ","./datapack-folder":"Pj+z","./file-errors":"3The","./group-resources":"8nfD","./lsp-conversions":"kVgt","./namespace":"JulZ","./node-tree":"jwqV","./promisified-fs":"DjTX","./return-helper":"S4yr","./security":"7l1Z","./setup":"9OF7","./translation":"0ADi","./parsing/namespace":"D271","./parsing/nmsp-tag":"pi1w"}],"f1BJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../misc-functions"),t=require("../misc-functions/third_party/typed-keys"),r=require("./errors"),s={EXPECTED_BOOL:new r.CommandErrorBuilder("parsing.bool.expected","Expected bool"),EXPECTED_END_OF_QUOTE:new r.CommandErrorBuilder("parsing.quote.expected.end","Unclosed quoted string"),EXPECTED_FLOAT:new r.CommandErrorBuilder("parsing.float.expected","Expected float"),EXPECTED_INT:new r.CommandErrorBuilder("parsing.int.expected","Expected integer"),EXPECTED_START_OF_QUOTE:new r.CommandErrorBuilder("parsing.quote.expected.start","Expected quote to start a string"),EXPECTED_STRING_FROM:new r.CommandErrorBuilder("parsing.expected.option","Expected string from %s, got '%s'"),EXPECTED_SYMBOL:new r.CommandErrorBuilder("parsing.expected","Expected '%s'"),INVALID_BOOL:new r.CommandErrorBuilder("parsing.bool.invalid","Invalid bool, expected true or false but found '%s'"),INVALID_ESCAPE:new r.CommandErrorBuilder("parsing.quote.escape","Invalid escape sequence '\\%s' in quoted string)"),INVALID_FLOAT:new r.CommandErrorBuilder("parsing.float.invalid","Invalid float '%s'"),INVALID_INT:new r.CommandErrorBuilder("parsing.int.invalid","Invalid integer '%s'")},i='"',n="\\";class a{constructor(e){this.cursor=0,this.string=e}canRead(e=1){return this.cursor+e<=this.string.length}expect(t){const r=new e.ReturnHelper;t.startsWith(this.getRemaining())&&r.addSuggestions({text:t,start:this.cursor});const i=this.string.substr(this.cursor,t.length);return i!==t?r.fail(s.EXPECTED_SYMBOL.create(this.cursor,Math.min(this.string.length,this.cursor+t.length),i,t)):(this.cursor+=t.length,r.succeed())}getRead(){return this.string.substring(0,this.cursor)}getRemaining(){return this.string.substring(this.cursor)}getRemainingLength(){return this.string.length-this.cursor}getTotalLength(){return this.string.length}peek(e=0){return this.string.charAt(this.cursor+e)}read(){return this.string.charAt(this.cursor++)}readBoolean(){const r=new e.ReturnHelper,i=this.cursor,n=this.readOption(t.typed_keys(a.bools),!1);return r.merge(n)?r.succeed(a.bools[n.data]):!1!==n.data?r.fail(s.INVALID_BOOL.create(i,this.cursor,n.data)):r.fail()}readFloat(){const t=new e.ReturnHelper,r=this.cursor,i=this.readWhileRegexp(a.charAllowedNumber);if(0===i.length)return t.fail(s.EXPECTED_FLOAT.create(r,this.string.length));if((i.match(/\./g)||[]).length>1)return t.fail(s.INVALID_FLOAT.create(r,this.cursor,this.string.substring(r,this.cursor)));try{return t.succeed(parseFloat(i))}catch(e){return t.fail(s.INVALID_FLOAT.create(r,this.cursor,i))}}readInt(){const t=new e.ReturnHelper,r=this.cursor,i=this.readWhileRegexp(a.charAllowedNumber);if(0===i.length)return t.fail(s.EXPECTED_INT.create(r,this.string.length));if(-1!==i.indexOf("."))return t.fail(s.INVALID_INT.create(r,this.cursor,this.string.substring(r,this.cursor)));try{return t.succeed(Number.parseInt(i,10))}catch(e){return t.fail(s.INVALID_INT.create(r,this.cursor,i))}}readOption(t,r=!0,n,a="both"){const o=this.cursor,u=new e.ReturnHelper;let c,d=!1;switch(this.peek()===i&&(d=!0),a){case"both":c=this.readString();break;case"yes":c=this.readQuotedString();break;case"no":c=new e.ReturnHelper(!1).succeed(this.readUnquotedString());break;default:c=this.readString()}const h=c;if(!u.merge(h,!1)){if(d&&!this.canRead()){const e=this.string.substring(o+1);u.addSuggestions(...t.filter(t=>t.startsWith(e)).map(e=>({kind:n,start:o,text:`${i}${e}${i}`})))}return u.failWithData(!1)}let l;for(const e of t)e===h.data&&(l=e);return this.canRead()||u.addSuggestions(...t.filter(e=>e.startsWith(h.data)).map(e=>({kind:n,start:o,text:d||e.includes('"')||e.includes("\\")?i+e.replace("\\","\\\\").replace('"','\\"')+i:e}))),l?u.succeed(l):(r&&u.addErrors(s.EXPECTED_STRING_FROM.create(o,this.cursor,JSON.stringify(t),h.data)),u.failWithData(h.data))}readQuotedString(){const t=new e.ReturnHelper,r=this.cursor;if(!this.canRead())return t.succeed("");if(this.peek()!==i)return t.fail(s.EXPECTED_START_OF_QUOTE.create(this.cursor,this.string.length));let a="",o=!1;for(;this.canRead();){this.skip();const e=this.peek();if(o){if(e!==i&&e!==n)return t.fail(s.INVALID_ESCAPE.create(this.cursor-1,this.cursor+1,e));a+=e,o=!1}else if(e===n)o=!0;else{if(e===i)return this.skip(),t.succeed(a);a+=e}}return t.addSuggestion(this.cursor,i),t.fail(s.EXPECTED_END_OF_QUOTE.create(r,this.string.length))}readString(){if(this.canRead()&&this.peek()===i)return this.readQuotedString();{const t=new e.ReturnHelper;return this.canRead()||t.addSuggestions({start:this.cursor,text:i}),t.succeed(this.readUnquotedString())}}readUnquotedString(){return this.readWhileRegexp(a.charAllowedInUnquotedString)}readUntilRegexp(e){return this.readWhileFunction(t=>!e.test(t))}readWhileFunction(e){const t=this.cursor;for(;e(this.peek());){if(!this.canRead())return this.string.substring(t);this.skip()}return this.string.substring(t,this.cursor)}readWhileRegexp(e){return this.readWhileFunction(t=>e.test(t))}skip(){this.cursor++}skipWhitespace(){this.readWhileRegexp(/\s/)}}a.charAllowedInUnquotedString=/^[0-9A-Za-z_\-\.+]$/,a.charAllowedNumber=/^[0-9\-\.]$/,a.bools={true:!0,false:!1},exports.StringReader=a;
},{"../misc-functions":"irtH","../misc-functions/third_party/typed-keys":"IXKy","./errors":"lIyQ"}],"Hlv0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("vscode-languageserver/lib/main"),r=require("../../misc-functions");exports.boolParser={kind:e.CompletionItemKind.Keyword,parse:(e,o)=>r.prepareForParser(e.readBoolean(),o)};
},{"../../misc-functions":"irtH"}],"5O9u":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../../misc-functions");exports.stringParser={parse:(r,t)=>{const s=new e.ReturnHelper(t);switch(t.node_properties.type){case"greedy":return r.cursor=r.string.length,s.succeed();case"word":return r.readUnquotedString(),s.succeed();default:return s.merge(r.readString())?s.succeed():s.fail()}}};
},{"../../misc-functions":"irtH"}],"pmd6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const r=require("../../brigadier/errors"),e=require("../../misc-functions"),t=2147483647,n=-2147483648,o={TOOBIG:new r.CommandErrorBuilder("argument.integer.big","Integer must not be more than %s, found %s"),TOOSMALL:new r.CommandErrorBuilder("argument.integer.low","Integer must not be less than %s, found %s")};exports.intParser={parse:(r,t)=>{const s=new e.ReturnHelper(t),a=r.cursor,i=r.readInt();if(!s.merge(i))return s.fail();const u=t.node_properties.max,d=t.node_properties.min,m=Math.min("number"==typeof u?u:2147483647,2147483647),c=Math.max("number"==typeof d?d:n,n);return i.data>m&&s.addErrors(o.TOOBIG.create(a,r.cursor,m.toString(),i.data.toString())),i.data<c&&s.addErrors(o.TOOSMALL.create(a,r.cursor,c.toString(),i.data.toString())),s.succeed()}};
},{"../../brigadier/errors":"lIyQ","../../misc-functions":"irtH"}],"3Cuu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const r=require("../../brigadier/errors"),e=require("../../misc-functions"),t=-2139095039,o=2139095039,a={TOOBIG:new r.CommandErrorBuilder("argument.float.big","Float must not be more than %s, found %s"),TOOSMALL:new r.CommandErrorBuilder("argument.float.low","Float must not be less than %s, found %s")};exports.floatParser={parse:(r,t)=>{const o=new e.ReturnHelper(t),n=r.cursor,s=r.readFloat();if(!o.merge(s))return o.fail();const u=t.node_properties.max,d=t.node_properties.min,i=Math.min("number"==typeof u?u:2139095039,2139095039),m=Math.max("number"==typeof d?d:-2139095039,-2139095039);return s.data>i&&o.addErrors(a.TOOBIG.create(n,r.cursor,i.toString(),s.data.toString())),s.data<m&&o.addErrors(a.TOOSMALL.create(n,r.cursor,m.toString(),s.data.toString())),o.succeed()}};
},{"../../brigadier/errors":"lIyQ","../../misc-functions":"irtH"}],"7xRZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("tslib");e.__exportStar(require("./bool"),exports),e.__exportStar(require("./string"),exports),e.__exportStar(require("./integer"),exports),e.__exportStar(require("./float"),exports);
},{"./bool":"Hlv0","./string":"5O9u","./integer":"pmd6","./float":"3Cuu"}],"OX8H":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("vscode-languageserver/lib/main"),t=require("../misc-functions");exports.literalParser={kind:e.CompletionItemKind.Method,parse:(e,r)=>{const n=new t.ReturnHelper(r),s=e.cursor,i=r.path[r.path.length-1];if(r.suggesting&&i.startsWith(e.getRemaining())&&n.addSuggestions(i),e.canRead(i.length)){const t=s+i.length;if(e.string.substring(s,t)===i&&(e.cursor=t," "===e.peek()||!e.canRead()))return n.succeed()}return n.fail()}};
},{"../misc-functions":"irtH"}],"IZJ1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("vscode-languageserver/lib/main"),r=require("../../brigadier/errors"),o=require("../../misc-functions"),n=require("../../misc-functions/parsing/nmsp-tag");exports.predicateParser={parse:(e,r)=>t(e,r,!0)},exports.stateParser={parse:(e,r)=>t(e,r,!1)};const a={block_properties:{duplicate:new r.CommandErrorBuilder("argument.block.property.duplicate","Property '%s' can only be set once for block %s"),invalid:new r.CommandErrorBuilder("argument.block.property.invalid","Block %s does not accept '%s' for %s property"),novalue:new r.CommandErrorBuilder("argument.block.property.novalue","Expected value for property '%s' on block %s"),unknown:new r.CommandErrorBuilder("argument.block.property.unknown","Block %s does not have property '%s'")},invalid_block:new r.CommandErrorBuilder("argument.block.id.invalid","Unknown block type '%s'"),no_tags:new r.CommandErrorBuilder("argument.block.tag.disallowed","Tags aren't allowed here, only actual blocks"),tag_properties:{duplicate:new r.CommandErrorBuilder("argument.block_tag.property.duplicate","Property '%s' can only be set once for block tag %s"),invalid:new r.CommandErrorBuilder("argument.block_tag.property.invalid","Block tag %s does not accept '%s' for %s property"),novalue:new r.CommandErrorBuilder("argument.block_tag.property.novalue","Expected value for property '%s' on block tag %s"),unknown:new r.CommandErrorBuilder("argument.block_tag.property.unknown","Block tag %s does not have property '%s'")},unknown_properties:{duplicate:new r.CommandErrorBuilder("argument.unknown_block_tag.property.duplicate","Property '%s' can only be set once for unknown block tag %s"),invalid:new r.CommandErrorBuilder("argument.unknown_block_tag.property.invalid","Unknown block tag %s might not accept '%s' for %s property",e.DiagnosticSeverity.Warning),novalue:new r.CommandErrorBuilder("argument.unknown_block_tag.property.novalue","Expected value for property '%s' on unknown block tag %s"),unknown:new r.CommandErrorBuilder("argument.unknown_block_tag.property.unknown","Unknown block tag %s might not have property '%s'",e.DiagnosticSeverity.Warning)},unclosed_props:new r.CommandErrorBuilder("argument.block.property.unclosed","Expected closing ] for block state properties"),unknown_tag:new r.CommandErrorBuilder("arguments.block.tag.unknown","Unknown block tag '%s'")};function t(e,r,t){const i=new o.ReturnHelper(r),l=e.cursor,p=t?"block_tags":a.no_tags,u=n.parseNamespaceOrTag(e,r,p);let d;if(i.merge(u)){const t=u.data;if(t.resolved&&t.values){d=`#${o.stringifyNamespace(t.parsed)}`,i.merge(n.buildTagActions(t.values,l+1,e.cursor,r.data.localData));const p=s(e,c(t.resolved,r.data.globalData.blocks)||{},a.tag_properties,d);if(!i.merge(p))return i.fail()}else{d=o.stringifyNamespace(u.data.parsed),r.suggesting&&!e.canRead()&&i.addSuggestions(...o.namespaceSuggestionString(Object.keys(r.data.globalData.blocks),u.data.parsed,l));const n=r.data.globalData.blocks[d];n||i.addErrors(a.invalid_block.create(l,e.cursor));const t=s(e,n||{},a.block_properties,d);if(!i.merge(t))return i.fail()}}else{if(!u.data)return i.fail();{i.addErrors(a.unknown_tag.create(l,e.cursor,o.stringifyNamespace(u.data))),d=`#${o.stringifyNamespace(u.data)}`;const r=s(e,{},a.unknown_properties,d);if(!i.merge(r))return i.fail()}}return i.succeed()}function s(r,n,t,s){const c=new o.ReturnHelper,i=new Map;if("["===r.peek()){const o=r.cursor;r.skip();const l=Object.keys(n);for(r.skipWhitespace();r.canRead()&&"]"!==r.peek();){r.skipWhitespace();const p=r.cursor,u=r.readOption(l,!1,e.CompletionItemKind.Property),d=u.data,g=c.merge(u);if(!1===d)return c.fail();if(g||c.addErrors(t.unknown.create(p,r.cursor,s,d)),i.has(d)&&c.addErrors(t.duplicate.create(p,r.cursor,d,s)),r.skipWhitespace(),!r.canRead()||"="!==r.peek())return c.fail(t.novalue.create(p,r.cursor,d,s));r.skip(),r.skipWhitespace();const k=r.cursor,m=r.readOption(n[d]||[],!1,e.CompletionItemKind.EnumMember),b=c.merge(m),f=m.data;if(!1===f)return c.fail();const w=t.invalid.create(k,r.cursor,s,f,d),y=e=>e&&g&&!b?c.addErrors(w):void 0;if(y(f.length>0),i.set(d,f),r.skipWhitespace(),r.canRead()){if(","===r.peek()){y(0===f.length),r.skip();continue}if("]"===r.peek()){y(0===f.length);break}}return c.fail(a.unclosed_props.create(o,r.cursor))}if(!r.canRead())return c.addSuggestions(...l.map(o=>({kind:e.CompletionItemKind.Property,start:r.cursor,text:o}))),c.fail(a.unclosed_props.create(o,r.cursor));r.expect("]")}return c.succeed(i)}function c(e,r){const n={};for(const a of e){const e=r[o.stringifyNamespace(a)];if(e)for(const r in e)e.hasOwnProperty(r)&&(n[r]=Array.from(new Set((n[r]||[]).concat(e[r]))))}return n}exports.parseBlockArgument=t;
},{"../../brigadier/errors":"lIyQ","../../misc-functions":"irtH","../../misc-functions/parsing/nmsp-tag":"pi1w"}],"cUI8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const r=require("../../brigadier/errors"),e=require("../../misc-functions"),t=new r.CommandErrorBuilder("argument.pos.mixed","Cannot mix world & local coordinates (everything must either use ^ or not)"),o=new r.CommandErrorBuilder("argument.pos.incomplete","Incomplete position argument. Only %s coords are present, when %s should be"),s=new r.CommandErrorBuilder("argument.pos.nolocal","Local coords are not allowed"),a="^",n="~",c=(r,e,t,s,c,u,l)=>(s||e.addSuggestions({start:r.cursor,text:a}),c||e.addSuggestions({start:r.cursor,text:n}),e.fail(o.create(u,r.cursor,(l+1).toString(),t.toString())));class u{constructor(r){this.rules=r}parse(r,o){const u=new e.ReturnHelper(o);let l=!1,i=!1;const d=r.cursor;for(let e=0;e<this.rules.count;e++){if(!r.canRead())return c(r,u,this.rules.count,i,l,d,0);const o=r.cursor;switch(r.peek()){case n:if(i=!0,r.skip(),!u.merge(this.parseNumber(r)))return u.fail();l&&u.addErrors(t.create(o,r.cursor));break;case a:if(this.rules.local||u.addErrors(s.create(r.cursor,r.cursor+1)),l=!0,r.skip(),!u.merge(this.parseNumber(r)))return u.fail();i&&u.addErrors(t.create(o,r.cursor));break;default:if(i=!0,!u.merge(this.parseNumber(r,!1)))return u.fail();l&&u.addErrors(t.create(o,r.cursor))}if(e<this.rules.count-1&&(!r.canRead()||!u.merge(r.expect(" "))))return c(r,u,this.rules.count,i,l,d,e)}return u.succeed()}parseNumber(r,t=!0){return r.canRead()&&!r.peek().match(/\s/)||!t?this.rules.float?r.readFloat():r.readInt():(new e.ReturnHelper).succeed(0)}}exports.CoordParser=u,exports.rotation=new u({count:2,float:!0,local:!1}),exports.vec2=new u({count:2,float:!0,local:!0}),exports.vec3=new u({count:3,float:!0,local:!0}),exports.blockPos=new u({count:3,float:!1,local:!0});
},{"../../brigadier/errors":"lIyQ","../../misc-functions":"irtH"}],"MBE2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../../brigadier/errors"),a=require("../../misc-functions"),r=new e.CommandErrorBuilder("argument.item.tag.disallowed","Tags aren't allowed here, only actual items"),s=new e.CommandErrorBuilder("arguments.item.tag.unknown","Unknown item tag '%s'"),t=new e.CommandErrorBuilder("argument.item.id.invalid","Unknown item '%s'");class n{constructor(e){this.useTags=e}parse(e,n){const i=new a.ReturnHelper(n),d=e.cursor,o=a.parseNamespaceOrTag(e,n,this.useTags?"item_tags":r);if(i.merge(o)){const r=[];if(o.data.resolved&&o.data.values)i.merge(a.buildTagActions(o.data.values,d+1,e.cursor,n.data.localData)),o.data.values.forEach(e=>{r.push(...(e.data||{values:[]}).values)});else{n.suggesting&&!e.canRead()&&i.addSuggestions(...a.namespaceSuggestionString(n.data.globalData.items,o.data.parsed,d));const s=a.stringifyNamespace(o.data.parsed);n.data.globalData.items.indexOf(s)<0&&i.addErrors(t.create(d,e.cursor,s)),r.push(s)}}else{if(!o.data)return i.fail();i.addErrors(s.create(d,e.cursor,a.stringifyNamespace(o.data)))}return i.succeed()}}exports.ItemParser=n,exports.stack=new n(!1),exports.predicate=new n(!0);
},{"../../brigadier/errors":"lIyQ","../../misc-functions":"irtH"}],"Td8d":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.COLORS=["black","dark_blue","dark_green","dark_aqua","dark_red","dark_purple","gold","gray","dark_gray","blue","green","aqua","red","light_purple","yellow","white","reset"];
},{}],"yLru":[function(require,module,exports) {
"use strict";function e(){const e=[];e.push("armor.chest","armor.feet","armor.head","armor.legs");for(let r=0;r<54;r++)e.push(`container.${r}`);for(let r=0;r<27;r++)e.push(`enderchest.${r}`);for(let r=0;r<25;r++)e.push(`horse.${r}`);e.push("horse.armor","horse.chest","horse.saddle");for(let r=0;r<9;r++)e.push(`hotbar.${r}`);for(let r=0;r<27;r++)e.push(`inventory.${r}`);for(let r=0;r<8;r++)e.push(`villager.${r}`);return e.push("weapon","weapon.mainhand","weapon.offhand"),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.itemSlots=e();
},{}],"C8ve":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../../colors");function o(){const o=[];o.push("list","sidebar","belowName");for(const s of e.COLORS)o.push(`sidebar.team.${s}`);return o}exports.scoreboardSlots=o();
},{"../../colors":"Td8d"}],"xAGc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../../colors");exports.anchors=["feet","eyes"],exports.operations=["+=","-=","*=","/=","%=","=",">","<","><"],exports.colors=e.COLORS,exports.effects=["minecraft:speed","minecraft:slowness","minecraft:haste","minecraft:mining_fatigue","minecraft:strength","minecraft:instant_health","minecraft:instant_damage","minecraft:jump_boost","minecraft:nausea","minecraft:regeneration","minecraft:resistance","minecraft:fire_resistance","minecraft:water_breathing","minecraft:invisibility","minecraft:blindness","minecraft:night_vision","minecraft:hunger","minecraft:weakness","minecraft:poison","minecraft:wither","minecraft:health_boost","minecraft:absorption","minecraft:saturation","minecraft:glowing","minecraft:levitation","minecraft:luck","minecraft:unluck","minecraft:slow_falling","minecraft:conduit_power","minecraft:dolphins_grace"],exports.enchantments=["minecraft:protection","minecraft:fire_protection","minecraft:feather_falling","minecraft:blast_protection","minecraft:projectile_protection","minecraft:respiration","minecraft:aqua_affinity","minecraft:thorns","minecraft:depth_strider","minecraft:frost_walker","minecraft:binding_curse","minecraft:sharpness","minecraft:smite","minecraft:bane_of_arthropods","minecraft:knockback","minecraft:fire_aspect","minecraft:looting","minecraft:sweeping","minecraft:efficiency","minecraft:silk_touch","minecraft:unbreaking","minecraft:fortune","minecraft:power","minecraft:punch","minecraft:flame","minecraft:infinity","minecraft:luck_of_the_sea","minecraft:lure","minecraft:loyalty","minecraft:impaling","minecraft:riptide","minecraft:channeling","minecraft:mending","minecraft:vanishing_curse"],exports.particles=["minecraft:ambient_entity_effect","minecraft:angry_villager","minecraft:barrier","minecraft:block","minecraft:bubble","minecraft:cloud","minecraft:crit","minecraft:damage_indicator","minecraft:dragon_breath","minecraft:dripping_lava","minecraft:dripping_water","minecraft:dust","minecraft:effect","minecraft:elder_guardian","minecraft:enchanted_hit","minecraft:enchant","minecraft:end_rod","minecraft:entity_effect","minecraft:explosion_emitter","minecraft:explosion","minecraft:falling_dust","minecraft:firework","minecraft:fishing","minecraft:flame","minecraft:happy_villager","minecraft:heart","minecraft:instant_effect","minecraft:item","minecraft:item_slime","minecraft:item_snowball","minecraft:large_smoke","minecraft:lava","minecraft:mycelium","minecraft:note","minecraft:poof","minecraft:portal","minecraft:rain","minecraft:smoke","minecraft:spit","minecraft:squid_ink","minecraft:sweep_attack","minecraft:totem_of_undying","minecraft:underwater","minecraft:splash","minecraft:witch","minecraft:bubble_pop","minecraft:current_down","minecraft:bubble_column_up","minecraft:nautilus"],exports.entities=["area_effect_cloud","armor_stand","arrow","bat","blaze","boat","cave_spider","chicken","cod","cow","creeper","donkey","dolphin","dragon_fireball","drowned","elder_guardian","end_crystal","ender_dragon","enderman","endermite","evoker_fangs","evoker","experience_orb","eye_of_ender","falling_block","firework_rocket","ghast","giant","guardian","horse","husk","illusioner","item","item_frame","fireball","leash_knot","llama","llama_spit","magma_cube","minecart","chest_minecart","command_block_minecart","furnace_minecart","hopper_minecart","spawner_minecart","tnt_minecart","mule","mooshroom","ocelot","painting","parrot","pig","pufferfish","zombie_pigman","polar_bear","tnt","rabbit","salmon","sheep","shulker","shulker_bullet","silverfish","skeleton","skeleton_horse","slime","small_fireball","snow_golem","snowball","spectral_arrow","spider","squid","stray","tropical_fish","turtle","egg","ender_pearl","experience_bottle","potion","vex","villager","iron_golem","vindicator","witch","wither","wither_skeleton","wither_skull","wolf","zombie","zombie_horse","zombie_villager","phantom","lightning_bolt","trident"],exports.dimensions=["overworld","the_nether","the_end"];
},{"../../colors":"Td8d"}],"ZBji":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const r=require("vscode-languageserver"),e=require("../../brigadier/errors"),o=require("../../colors"),s=require("../../data/lists/item-slot"),n=require("../../data/lists/scoreboard-slot"),t=require("../../data/lists/statics"),i=require("../../misc-functions");class a{constructor(r,e){this.options=r,this.error=e}parse(e,o){const s=e.cursor,n=new i.ReturnHelper(o),t=e.readOption(this.options,!1,r.CompletionItemKind.EnumMember,"no");return n.merge(t)?n.succeed():n.fail(this.error.create(s,e.cursor,t.data.toString()))}}exports.ListParser=a;const l=new e.CommandErrorBuilder("argument.color.invalid","Unknown color '%s'");exports.colorParser=new a(o.COLORS,l);const c=new e.CommandErrorBuilder("argument.anchor.invalid","Invalid entity anchor position %s");exports.entityAnchorParser=new a(t.anchors,c);const d=new e.CommandErrorBuilder("slot.unknown","Unknown slot '%s'");exports.itemSlotParser=new a(s.itemSlots,d);const u=new e.CommandErrorBuilder("arguments.operation.invalid","Invalid operation");exports.operationParser=new a(t.operations,u);const m=new e.CommandErrorBuilder("argument.scoreboardDisplaySlot.invalid","Unknown display slot '%s'");exports.scoreBoardSlotParser=new a(n.scoreboardSlots,m);
},{"../../brigadier/errors":"lIyQ","../../colors":"Td8d","../../data/lists/item-slot":"yLru","../../data/lists/scoreboard-slot":"C8ve","../../data/lists/statics":"xAGc","../../misc-functions":"irtH"}],"o/51":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../../misc-functions");exports.messageParser={parse:r=>(r.cursor=r.getTotalLength(),(new e.ReturnHelper).succeed())};
},{"../../misc-functions":"irtH"}],"pM/l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../../brigadier/errors"),n=require("../../data/lists/statics"),r=require("../../misc-functions");class s{constructor(e,n){this.options=e,this.error=n}parse(e,n){const s=new r.ReturnHelper(n),t=e.cursor,o=r.parseNamespaceOption(e,this.options.map((e,n)=>r.convertToNamespace(e)));return s.merge(o)?s.succeed():o.data?s.addErrors(this.error.create(t,e.cursor,r.stringifyNamespace(o.data))).succeed():s.fail()}}exports.NamespaceListParser=s;const t=new e.CommandErrorBuilder("entity.notFound","Unknown entity: %s");exports.summonParser=new s(n.entities,t);const o=new e.CommandErrorBuilder("enchantment.unknown","Unknown enchantment: %s");exports.enchantmentParser=new s(n.enchantments,o);const a=new e.CommandErrorBuilder("effect.effectNotFound","Unknown effect: %s");exports.mobEffectParser=new s(n.effects,a);const i=new e.CommandErrorBuilder("particle.notFound","Unknown particle: %s");exports.particleParser=new s(n.particles,i);const c=new e.CommandErrorBuilder("argument.dimension.invalid","Unknown dimension: '%s'");exports.dimensionParser=new s(n.dimensions,c);
},{"../../brigadier/errors":"lIyQ","../../data/lists/statics":"xAGc","../../misc-functions":"irtH"}],"mhMo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("vscode-languageserver"),r=require("../../brigadier/errors"),a=require("../../misc-functions"),n={advancement_notfound:new r.CommandErrorBuilder("advancement.advancementNotFound","Unknown advancement: %s"),nobossbar:new r.CommandErrorBuilder("commands.bossbar.unknown","No bossbar exists with the ID '%s'"),recipe_notfound:new r.CommandErrorBuilder("recipe.notFound","Unkown recipe: %s"),unknown_function:new r.CommandErrorBuilder("arguments.function.unknown","Unknown function '%s'"),unknown_resource:new r.CommandErrorBuilder("argument.id.unknown","Unknown resource '%s'"),unknown_tag:new r.CommandErrorBuilder("arguments.function.tag.unknown","Unknown function tag '#%s'")};exports.functionParser={parse:(r,s)=>{const t=new a.ReturnHelper(s),o=r.cursor,c=a.parseNamespaceOrTag(r,s,"function_tags");if(t.merge(c)){const u=c.data;if(u.resolved&&u.values)return t.succeed();{const c=a.getResourcesofType(s.data,"functions"),d=a.processParsedNamespaceOption(u.parsed,c,s.suggesting&&!r.canRead(),o,e.CompletionItemKind.Method);return 0===d.data.length&&t.addErrors(n.unknown_function.create(o,r.cursor,a.stringifyNamespace(u.parsed))),t.mergeChain(d).succeed()}}return c.data?t.addErrors(n.unknown_tag.create(o,r.cursor,a.stringifyNamespace(c.data))).succeed():t.fail()}};const s={parse:a.parseNamespace},t={parse:(e,r)=>{const s=new a.ReturnHelper(r);if(r.data.localData&&r.data.localData.nbt.level){const t=e.cursor,o=r.data.localData.nbt.level.Data.CustomBossEvents,c=Object.keys(o).map((e,r)=>a.convertToNamespace(e)),u=a.parseNamespaceOption(e,c);return s.merge(u)?s.succeed():u.data?s.addErrors(n.nobossbar.create(t,e.cursor,a.stringifyNamespace(u.data))).succeed():s.fail()}return s.return(a.parseNamespace(e))}},o=[{data:{issue:n.advancement_notfound,resource:"advancements"},path:["advancement"]},{data:{resource:s},path:["bossbar","add"]},{data:{resource:t},path:["bossbar"]},{data:{resource:t},path:["execute","store","result"]},{data:{resource:s},path:["playsound"]},{data:{resource:s},path:["stopsound"]},{data:{resource:"recipes",issue:n.advancement_notfound},path:["recipe"]}];exports.resourceParser={parse:(e,r)=>{const n=e.cursor,s=new a.ReturnHelper(r),t=a.startPaths(o,r.path);if(t){if("object"==typeof t.resource)return s.return(t.resource.parse(e,r));{const o=a.parseNamespaceOption(e,a.getResourcesofType(r.data,t.resource));return s.merge(o)?s.succeed():o.data?s.addErrors(t.issue.create(n,e.cursor,a.stringifyNamespace(o.data))).succeed():s.fail()}}throw new Error(`Resource at path ${r.path} does not have a supported resource`)}};
},{"../../brigadier/errors":"lIyQ","../../misc-functions":"irtH"}],"vlho":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const r=require("tslib"),e=r.__importStar(require("./brigadier")),t=require("./literal"),a=r.__importStar(require("./minecraft/block")),i=r.__importStar(require("./minecraft/coordinates")),n=r.__importStar(require("./minecraft/item")),s=r.__importStar(require("./minecraft/lists")),c=require("./minecraft/message"),o=r.__importStar(require("./minecraft/namespace-list")),m=require("./minecraft/resources"),l={"brigadier:bool":e.boolParser,"brigadier:float":e.floatParser,"brigadier:integer":e.intParser,"brigadier:string":e.stringParser,"minecraft:block_pos":i.blockPos,"minecraft:block_predicate":a.predicateParser,"minecraft:block_state":a.stateParser,"minecraft:color":s.colorParser,"minecraft:entity_anchor":s.entityAnchorParser,"minecraft:entity_summon":o.summonParser,"minecraft:function":m.functionParser,"minecraft:item_enchantment":o.enchantmentParser,"minecraft:item_predicate":n.predicate,"minecraft:item_slot":s.itemSlotParser,"minecraft:item_stack":n.stack,"minecraft:message":c.messageParser,"minecraft:mob_effect":o.mobEffectParser,"minecraft:operation":s.operationParser,"minecraft:particle":o.particleParser,"minecraft:resource_location":m.resourceParser,"minecraft:rotation":i.rotation,"minecraft:scoreboard_slot":s.scoreBoardSlotParser,"minecraft:vec2":i.vec2,"minecraft:vec3":i.vec3};function f(r){switch(r.type){case"literal":return t.literalParser;case"argument":if(r.parser)return g(r.parser)}}function g(r){if(global.mcLangSettings&&global.mcLangSettings.parsers&&global.mcLangSettings.parsers.hasOwnProperty(r))try{return global.mcLangSettings.parsers[r]}catch(e){mcLangLog(`${global.mcLangSettings.parsers[r]} could not be loaded`)}if(l.hasOwnProperty(r))return l[r];mcLangLog(`Argument with parser id ${r} has no associated parser.\nPlease consider reporting this at https://github.com/Levertion/mcfunction-language-server/issues`)}exports.getParser=f;
},{"./brigadier":"7xRZ","./literal":"OX8H","./minecraft/block":"IZJ1","./minecraft/coordinates":"cUI8","./minecraft/item":"MBE2","./minecraft/lists":"ZBji","./minecraft/message":"o/51","./minecraft/namespace-list":"pM/l","./minecraft/resources":"mhMo"}],"aDYY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("vscode-languageserver/lib/main"),t=require("./brigadier/string-reader"),r=require("./consts"),n=require("./misc-functions/creators"),o=require("./misc-functions/node-tree"),s=require("./parsers/get-parser");function i(t,n,o,s){const i=o.lines[t];if(void 0===i.parseInfo||i.text.startsWith(r.COMMENT_START))return e.CompletionList.create([],!0);const c={globalData:s.globalData,localData:s.getPackFolderData(o.pack_segments)},l=i.parseInfo?i.parseInfo.nodes:[];if(0===l.length)return e.CompletionList.create(a(t,0,n,i.text,[],c,{}),!0);const d=[],u=[];for(const e of l)e.high<n?e.final&&d.push(e):e.low<=n&&u.push(e);const p=[];for(const e of d)p.push(...a(t,e.high+1,n,i.text,e.path,c,e.context));for(const e of u){const r=e.path.slice().slice(0,-1);p.push(...a(t,e.low,n,i.text,r,c,e.context))}return e.CompletionList.create(p,!0)}function a(e,r,i,a,l,d,u){const p=o.getNextNode(o.followPath(d.globalData.commands,l),l,d.globalData.commands).node,f=[];if(p.children)for(const o in p.children)if(p.children.hasOwnProperty(o)){const h=p.children[o],g=[...l,o],m=n.createParserInfo(h,d,g,u,!0),x=s.getParser(h);if(x){const n=new t.StringReader(a.substring(r,i)),o=x.parse(n,m);o&&f.push(...c(o.suggestions,e,r,i,x.kind))}}return f}function c(t,r,n,o,s=e.CompletionItemKind.Keyword){const i=[];for(const e of t)if("string"==typeof e)i.push({kind:s,label:e,textEdit:{newText:e,range:{end:{character:o,line:r},start:{character:n,line:r}}}});else{const t={kind:e.kind||s,label:e.text,textEdit:{newText:e.text,range:{end:{character:o,line:r},start:{character:n+e.start,line:r}}}};e.description&&(t.detail=e.description),i.push(t)}return i}exports.computeCompletions=i;
},{"./brigadier/string-reader":"f1BJ","./consts":"xb+0","./misc-functions/creators":"WIIZ","./misc-functions/node-tree":"jwqV","./parsers/get-parser":"vlho"}],"xUTu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../../misc-functions"),s=require("../../misc-functions/third_party/typed-keys"),t=require("path");async function a(t,a,n,c){const r={},o=new e.ReturnHelper,i=[];for(const p of s.typed_keys(t)){const s=r[p]=[],u=t[p],y=e.resourceTypes[p].mapFunction;y?i.push(...u.map(async e=>{const t=await y(e,n,a,c);o.merge(t),s.push(t.data)})):s.push(...u)}return await Promise.all(i),o.succeed(r)}async function n(n,c){const r=new e.ReturnHelper,o=Object.assign({},n,{packs:{}}),i=s.typed_keys(n.packs).map(async e=>{const s=n.packs[e],i=await a(s.data,c,t.join(n.location,s.name),n);r.merge(i),o.packs[e]=Object.assign({},s,{data:i.data})});return await Promise.all(i),r.succeed(o)}exports.runMapFunctions=a,exports.mapPacksInfo=n;
},{"../../misc-functions":"irtH","../../misc-functions/third_party/typed-keys":"IXKy"}],"JBbW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("tslib"),e=t.__importStar(require("long"));class i{constructor(t){this.index=0,this.buf=t}getByte(){const t=this.buf.readInt8(this.index);return this.index++,t}getDouble(){const t=this.buf.readDoubleBE(this.index);return this.index+=8,t}getFloat(){const t=this.buf.readFloatBE(this.index);return this.index+=4,t}getInt(){const t=this.buf.readInt32BE(this.index);return this.index+=4,t}getLong(){const t=this.buf.subarray(this.index,this.index+8);return this.index+=8,e.fromBytesBE([...t])}getShort(){const t=this.buf.readInt16BE(this.index);return this.index+=2,t}getUTF8(){const t=this.getShort(),e=this.buf.toString("utf8",this.index,this.index+t);return this.index+=t,e}}exports.BufferStream=i;
},{}],"ztQI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("tslib"),e=require("util"),r=t.__importStar(require("zlib")),n=require("./buffer-stream"),o=e.promisify(r.unzip);let s;const u=t=>t.getByte(),g=t=>t.getShort(),c=t=>t.getInt(),i=t=>t.getLong(),l=t=>t.getFloat(),f=t=>t.getDouble(),p=t=>{const e=t.getInt(),r=[];for(let n=0;n<e;n++)r.push(t.getByte());return r},a=t=>t.getUTF8(),y=t=>{const e=t.getByte(),r=t.getInt(),n=s[e],o=[];for(let e=0;e<r;e++)o.push(n(t));return o},B=t=>{let e=t.getByte();const r={};for(;0!==e;){const n=t.getUTF8(),o=s[e];r[n]=o(t),e=t.getByte()}return r},h=t=>{const e=t.getInt(),r=[];for(let n=0;n<e;n++)r.push(t.getInt());return r},I=t=>{const e=t.getInt(),r=[];for(let n=0;n<e;n++)r.push(t.getLong());return r};async function b(t,e=!0){let r;try{r=await o(t)}catch(e){r=t}const u=new n.BufferStream(r),g=u.getByte();return e&&u.getUTF8(),(0,s[g])(u)}s={1:u,2:g,3:c,4:i,5:l,6:f,7:p,8:a,9:y,10:B,11:h,12:I},exports.parse=b;
},{"./buffer-stream":"JBbW"}],"or7h":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("tslib"),r=e.__importStar(require("path")),t=require("../../misc-functions"),a=require("./parser");async function s(e){const s={},c=r.resolve(e,"./level.dat");try{const e=await t.readFileAsync(c);s.level=await a.parse(e)}catch(e){}const o=r.resolve(e,"./data/scoreboards.dat");try{const e=await t.readFileAsync(o);s.scoreboard=await a.parse(e)}catch(e){}return s}exports.loadNBT=s;
},{"../../misc-functions":"irtH","./parser":"ztQI"}],"xvnx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("tslib"),a=e.__importStar(require("path")),t=require("../consts"),r=require("../misc-functions"),n=require("../misc-functions/file-errors"),s=require("../misc-functions/promisified-fs"),i=require("../misc-functions/third_party/typed-keys"),c=require("./extractor/mapfunctions"),o=require("./nbt/nbt-cache");async function u(e,c,o,u={}){const p=new r.ReturnHelper,m=a.join(c,e),l=await d(m);return await Promise.all(i.typed_keys(r.resourceTypes).map(async i=>{const c=r.resourceTypes[i];if(-1===l.indexOf(c.path[0]))return;const d=a.join(m,...c.path),y=await s.walkDir(d);if(0===y.length)return;const w=u[i]||[];await Promise.all(y.map(async r=>{const s=a.extname(r);s!==c.extension&&p.addMisc(n.createExtensionFileError(r,c.extension,s));const i=a.relative(d,r),u={namespace:e,pack:o,path:i.slice(0,-s.length).replace(a.sep,t.SLASH)};w.push(u)})),u[i]=w})),p.succeed(u)}async function p(e,n,i){const c=new r.ReturnHelper,o=a.join(e,t.DATAFOLDER),[u,p]=await Promise.all([s.readJSON(a.join(e,t.MCMETAFILE)),m(o,n)]),l={id:n,data:p.data,name:i};return c.merge(p),c.merge(u)&&(l.mcmeta=u.data),c.succeed(l)}async function m(e,a){const t=new r.ReturnHelper,n=await d(e),s={};return await Promise.all(n.map(async r=>{const n=await u(r,e,a,s);return t.merge(n),n.data})),t.succeed(s)}async function l(e,t){const n=await d(e),s=new r.ReturnHelper,i=[...n.entries()],u=await o.loadNBT(a.resolve(e,"../")),m={location:e,packnamesmap:{},packs:{},nbt:u},l=i.map(async([t,r])=>{const n=a.join(e,r),i=await p(n,t,r);s.merge(i),m.packs[t]=i.data,m.packnamesmap[r]=t});await Promise.all(l);const y=await c.mapPacksInfo(m,t);return s.mergeChain(y).succeed(y.data)}async function d(e){let t=[];try{t=await s.readDirAsync(e)}catch(e){return[]}const r=t.map(async t=>{try{return(await s.statAsync(a.join(e,t))).isDirectory()}catch(e){return!1}}),n=await Promise.all(r);return t.filter((e,a)=>n[a])}exports.getNamespaceResources=u,exports.getPacksInfo=l;
},{"../consts":"xb+0","../misc-functions":"irtH","../misc-functions/file-errors":"3The","../misc-functions/promisified-fs":"DjTX","../misc-functions/third_party/typed-keys":"IXKy","./extractor/mapfunctions":"xUTu","./nbt/nbt-cache":"or7h"}],"R7Qt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("tslib"),r=e.__importStar(require("fs")),t=e.__importStar(require("path")),s=require("util.promisify");s.shim();const n=require("util"),o=require("../../consts"),i=require("../../misc-functions"),a=require("../datapack-resources"),c=require("./mapfunctions"),u=n.promisify(r.readFile);async function p(e,r){const t=new i.ReturnHelper,s={meta_info:{version:e}},n=await Promise.all([j(r),m(r),l(r),f(r)]);for(const e of n)s[e[0]]=e[1];const o=await c.runMapFunctions(s.resources,s,r);return t.mergeChain(o).succeed(Object.assign({},s,{resources:o.data}))}async function f(e){const r=t.join(e,o.DATAFOLDER);return["resources",(await a.getNamespaceResources("minecraft",r,void 0)).data]}async function m(e){const r=JSON.parse((await u(t.join(e,"reports","items.json"))).toString());return["items",Object.keys(r)]}async function l(e){return["commands",JSON.parse((await u(t.join(e,"reports","commands.json"))).toString())]}async function j(e){return["blocks",d(JSON.parse((await u(t.join(e,"reports","blocks.json"))).toString()))]}function d(e){const r={};for(const t in e)if(e.hasOwnProperty(t)){const s=e[t];r[t]={},s.properties&&Object.assign(r[t],s.properties)}return r}exports.collectData=p;
},{"../../consts":"xb+0","../../misc-functions":"irtH","../datapack-resources":"xvnx","./mapfunctions":"xUTu"}],"Y+vF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("tslib"),e=t.__importStar(require("fs")),r=t.__importStar(require("path")),a=t.__importDefault(require("request-promise-native"));async function n(t,e){return mcLangSettings.data.customJar?{jarPath:mcLangSettings.data.customJar,version:""}:s(e,t)}async function s(t,n){const s=await o();if(s.id!==t){const t=await a.default(s.url,{json:!0}).promise(),o=r.join(n,`minecraft-function-${s.id}.jar`),i=a.default(t.downloads.server.url);return i.pipe(e.createWriteStream(o)),await Promise.resolve(i),{jarPath:o,version:s.id}}throw new Error("Downloading new global data not needed as current version is the same as the latest version.")}async function o(){const t=await a.default("https://launchermeta.mojang.com/mc/game/version_manifest.json",{json:!0}).promise();return u(i(t),t)}function i(t){return mcLangSettings.data.snapshots?t.latest.snapshot:t.latest.release}function u(t,e){return e.versions.find(e=>e.id===t)}exports.getPathToJar=n,exports.downloadJar=s;
},{}],"lioB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("tslib"),t=require("child_process"),r=e.__importStar(require("path")),a=require("util.promisify");a.shim();const i=require("util"),n=i.promisify(t.execFile);async function o(){const e=mcLangSettings.data.javaPath||"java";try{return await n(e,["-version"],{env:process.env}),e}catch(e){throw new Error(`Could not find Java executable. Got message: '${e}'`)}}async function s(e,t,a){const i=r.join(t,"generated");return await n(e,["-cp",a,"net.minecraft.data.Main","--output",i,"--all"]),i}exports.checkJavaPath=o,exports.runGenerator=s;
},{}],"2KFe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("tslib"),a=e.__importStar(require("fs")),t=require("os"),r=e.__importStar(require("path")),i=require("util.promisify");i.shim();const n=require("util"),o=require("../../misc-functions"),c=require("../cache"),s=require("./collect-data"),u=require("./download"),l=require("./extract-data"),d=n.promisify(a.mkdtemp);async function m(e=""){if(mcLangSettings.data.enabled){const a=await l.checkJavaPath(),i=await d(r.join(t.tmpdir(),"mcfunction")),n=await u.getPathToJar(i,e),m=await l.runGenerator(a,i,n.jarPath);mcLangLog("Generator Finished");const p=new o.ReturnHelper,h=await s.collectData(n.version,m);return await c.cacheData(h.data),p.mergeChain(h).succeed(h.data)}throw new Error("Data Obtainer disabled in settings. To obtain data automatically, please enable it.")}exports.collectGlobalData=m;
},{"../../misc-functions":"irtH","../cache":"T7Hz","./collect-data":"R7Qt","./download":"Y+vF","./extract-data":"lioB"}],"OaLX":[function(require,module,exports) {
"use strict";async function e(){return{}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadNonCached=e;
},{}],"zth0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const a=require("vscode-languageserver"),e=require("path"),t=require("../consts"),r=require("../misc-functions"),s=require("../misc-functions/file-errors"),c=require("../misc-functions/promisified-fs"),n=require("./cache"),i=require("./datapack-resources"),o=require("./extractor"),l=require("./noncached");class p{constructor(){this.globalDataInternal={},this.packDataComplete={},this.packDataPromises={}}static newWithData(a,e){const t=new p;return t.globalDataInternal=a||t.globalDataInternal,Object.assign(t.packDataComplete,e),t}get globalData(){return this.globalDataInternal}getPackFolderData(a){if(a&&this.packDataComplete.hasOwnProperty(a.packsFolder)){const e=this.packDataComplete[a.packsFolder];return Object.assign({},e,{current:e.packnamesmap[a.pack]})}}async handleChanges(n){const i=new r.ReturnHelper(!1),o=new Set,l=n.changes.map(async n=>{try{const l=r.parseDataPath(n.uri);if(l){const p=async()=>{await this.readPackFolderData(l.packsFolder)&&o.add(l.packsFolder);const a=this.getPackFolderData(l);if(!a)throw new Error("Could not load data from datapacks folder");const e=a.packnamesmap[l.pack];return{data:a,pack:a.packs[e],packID:e}};if(l.rest===t.MCMETAFILE){const{pack:a}=await p();if(!o.has(l.packsFolder)){const e=await c.readJSON(n.uri);a.mcmeta=i.merge(e)?e.data:void 0}}else{const t=r.getKindAndNamespace(l.rest);if(t){const{pack:c,packID:d,data:u}=await p();if(!o.has(l.packsFolder)){const o=n.type===a.FileChangeType.Changed&&r.resourceTypes[t.kind].mapFunction;let p=c.data[t.kind];if((n.type===a.FileChangeType.Deleted||o)&&p)for(let a=0;a<p.length;a++){const e=p[a];if(r.namespacesEqual(e,t.location)){p.splice(a,1);break}}if(n.type===a.FileChangeType.Created||o){p||(p=c.data[t.kind]=[]);const a=Object.assign({},t.location,{pack:d}),o=e.extname(n.uri),h=r.resourceTypes[t.kind].extension;if(o===h){const s=r.resourceTypes[t.kind].mapFunction;if(s){const t=await s(a,e.join(l.packsFolder,l.pack),this.globalData,u);i.merge(t)&&p.push(t.data)}else p.push(a)}else i.addMisc(s.createExtensionFileError(n.uri,h,o))}}}}}}catch(a){mcLangLog(`Change ${JSON.stringify(n)} could not be completed, due to '${JSON.stringify(a)}'`)}});return await Promise.all(l),i.succeed()}async loadGlobalData(){let a;this.globalData.meta_info&&(a=this.globalData.meta_info.version);try{const e=new r.ReturnHelper,t=await o.collectGlobalData(a);return e.merge(t),this.globalDataInternal=t.data,!0}catch(a){return`Error loading global data: ${a.stack||a.toString()}`}}async readCache(){try{const a=await n.readCache(),e=await l.loadNonCached();return this.globalDataInternal=Object.assign({},a,e),mcLangLog("Cache Successfully read"),!0}catch(a){return mcLangLog(`Reading cache failed with error ${JSON.stringify(a)}`),!1}}async readPackFolderData(a){const e=new r.ReturnHelper;if(this.packDataPromises.hasOwnProperty(a))return await this.packDataPromises[a],e.fail();{this.packDataPromises[a]=i.getPacksInfo(a,this.globalData);const t=await this.packDataPromises[a];return this.packDataComplete[a]=t.data,e.merge(t),e.succeed()}}}exports.DataManager=p;
},{"../consts":"xb+0","../misc-functions":"irtH","../misc-functions/file-errors":"3The","../misc-functions/promisified-fs":"DjTX","./cache":"T7Hz","./datapack-resources":"xvnx","./extractor":"2KFe","./noncached":"OaLX"}],"NZkF":[function(require,module,exports) {
"use strict";function e(e){return e&&"object"==typeof e&&!Array.isArray(e)}function t(r,...s){if(!s.length)return r;const n=s.shift();if(e(r)&&e(n))for(const s in n)e(n[s])?(r[s]||Object.assign(r,{[s]:{}}),t(r[s],n[s])):Object.assign(r,{[s]:n[s]});return t(r,...s)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isObject=e,exports.mergeDeep=t;
},{}],"X+eG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("vscode-languageserver/lib/main"),r=require("./brigadier/errors"),n=require("./brigadier/string-reader"),t=require("./consts"),s=require("./misc-functions"),a=require("./parsers/get-parser"),o={Ambiguity:new r.CommandErrorBuilder("parsing.command.ambiguous","Command text is possibly ambiguous",e.DiagnosticSeverity.Information),NoSuccesses:new r.CommandErrorBuilder("command.parsing.matchless","No nodes which matched '%s' found"),NotRunnable:new r.CommandErrorBuilder("parsing.command.executable","The command '%s' cannot be run.",e.DiagnosticSeverity.Warning)};function c(e,r,a){if(0===e.length||e.startsWith(t.COMMENT_START))return;const o={globalData:r,localData:a},c=i(new n.StringReader(e),r.commands,[],o,{}),u=[];return s.isSuccessful(c)&&u.push(...c.data),{actions:c.actions,nodes:u,errors:c.errors}}function i(e,r,n,a,c){const d=s.getNextNode(r,n,a.globalData.commands),m=new s.ReturnHelper,l=d.node.children;if(l){const r=[],n=e.cursor;let s=0,f=e.getTotalLength();for(const p of Object.keys(l)){const b=l[p],h=[...d.path,p],x=u(e,b,h,a,c);if(m.merge(x)){const u={context:c,final:!0,high:e.cursor,low:n,path:h},d=x.data;function g(){return!!e.canRead()||(d.node.executable||m.addErrors(o.NotRunnable.create(0,e.cursor,e.string)),!1)}if(g()){if(e.peek()===t.SPACE){if(s++,e.skip(),g()){const n=d.newContext?d.newContext:c,t=i(e,d.node,h,a,n);m.merge(t)&&(f=Math.min(f,e.cursor),r.push(...t.data),u.final=!1)}r.push(u)}}else s++,r.push(u)}e.cursor=n}return 0===s?m.fail(o.NoSuccesses.create(e.cursor,e.getTotalLength(),e.getRemaining())):(s>1&&m.addErrors(o.Ambiguity.create(n,f)),m.succeed(r))}return d.node.executable||mcLangLog(`Malformed tree at path ${JSON.stringify(n)}. No children and not executable`),m.fail()}function u(e,r,n,t,o){const c=a.getParser(r),i=new s.ReturnHelper(!1);if(c){const a=c.parse(e,s.createParserInfo(r,t,n,o,!1));if(a){if(i.merge(a)){const n=Object.assign({},o,a.data);return i.succeed({max:e.cursor,newContext:n,node:r})}return i.fail()}return i.succeed({max:e.cursor,node:r})}return i.fail()}function d(e,r,n,t,s){for(const a of s){const s=e.lines[a],o=r.getPackFolderData(e.pack_segments);let i;o&&e.pack_segments&&(i=Object.assign({},o,{current:o.packnamesmap[e.pack_segments.pack]}));const u=c(s.text,r.globalData,i);s.parseInfo=u||!1,s.actions=void 0,s.nodes=void 0,n.emit(`${t}:${a}`)}}function m(e,r,n,t){const s=e.lines.map((e,r)=>r);d(e,r,n,t,s)}exports.parseCommand=c,exports.parseLines=d,exports.parseDocument=m;
},{"./brigadier/errors":"lIyQ","./brigadier/string-reader":"f1BJ","./consts":"xb+0","./misc-functions":"irtH","./parsers/get-parser":"vlho"}],"7QCb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("tslib"),t=require("events"),n=require("util"),i=require("util.promisify");i.shim();const o=require("node-interval-tree"),r=require("vscode-languageserver/lib/main"),s=require("./completions"),a=require("./data/cache"),c=require("./data/manager"),u=require("./misc-functions"),l=require("./misc-functions/third_party/merge-deep"),f=require("./parse"),g=r.createConnection(new r.IPCMessageReader(process),new r.IPCMessageWriter(process));let p;g.listen();const d=new Map,h=new Map,m=new t.EventEmitter;let D,w=!1,P=!1;async function y(e){const t=await D,n=l.mergeDeep({},global.mcLangSettings,e.mcfunction);try{const e=u.securityIssues(n,t);if(e.length>0){if(!await u.actOnSecurity(e,g,t))return void g.sendNotification("mcfunction/shutdown",`Shutting down because of insecure settings: '${e.join("', '")}'`)}}catch(e){return void g.sendNotification("mcfunction/shutdown",`Shutting down because of insecure settings: '${e}'`)}global.mcLangSettings=n}function v(e){const t=d.get(e),n=[];for(let e=0;e<t.lines.length;e++){const i=t.lines[e];i.parseInfo&&i.parseInfo.errors&&n.push(...i.parseInfo.errors.map(t=>u.commandErrorToDiagnostic(t,e)))}g.sendDiagnostics({uri:e,diagnostics:n})}function x(t){const n=new Set;for(const i of t){if("FileError"===i.kind){n.add(i.filePath);const e=h.get(i.filePath);e?h.set(i.filePath,Object.assign({},e,{group:i.message})):h.set(i.filePath,{group:i.message})}if("ClearError"===i.kind){if(n.add(i.filePath),i.group){const t=h.get(i.filePath);if(t){const{group:n}=t,o=e.__rest(t,["group"]);h.set(i.filePath,Object.assign({},o))}}else h.delete(i.filePath)}}for(const e of n){const t=h.get(e);if(t){const n=[];for(const e of Object.keys(t))n.push({message:t[e],range:{end:{line:0,character:0},start:{line:0,character:0}}});g.sendDiagnostics({uri:e,diagnostics:n})}}}function C(e){const t=d.get(e.textDocument.uri);if(t){return t.lines[e.position.line]}}function b(e,t,n){if(e.parseInfo){if(!e.actions){e.actions=new o.IntervalTree;for(const t of e.parseInfo.actions)e.actions.insert(t)}return e.actions.search(t.character,t.character).filter(e=>e.type===n)}return[]}function I(e){if(e.nodes)return e.nodes;if(e.parseInfo){const t=new o.IntervalTree;for(const n of e.parseInfo.nodes)t.insert(n);return t}}g.onInitialize(()=>(u.setup_logging(g),p=new c.DataManager,{capabilities:{completionProvider:{resolveProvider:!1},hoverProvider:!0,textDocumentSync:{change:r.TextDocumentSyncKind.Incremental,openClose:!0}}})),g.onDidChangeConfiguration(async e=>{let t=!1;P||(P=!0,t=!0,global.mcLangSettings={},D=a.readSecurity()),await y(e.settings);const n=()=>{for(const[e,t]of d.entries())f.parseDocument(t,p,m,e),v(e)};if(t){const e=await p.readCache();e&&(w=!0,n());const t=await p.loadGlobalData();if(!0===t)w=!0,n();else if(!e)return void g.sendNotification("mcfunction/shutdown",t)}}),g.onDidOpenTextDocument(e=>{const t=e.textDocument.uri,n=u.parseDataPath(t),i=()=>{d.has(t)&&(f.parseDocument(d.get(t),p,m,t),v(t))};d.set(t,{lines:u.splitLines(e.textDocument.text),pack_segments:n}),n&&p.readPackFolderData(n.packsFolder).then(e=>{u.isSuccessful(e)&&g.client.register(r.DidChangeWatchedFilesNotification.type,{watchers:[{globPattern:`${n}**/*`}]}),w&&d.hasOwnProperty(t)&&i(),x(e.misc)}).catch(e=>{mcLangLog(`Getting pack folder data failed for reason: '${e}'`)}),w&&i()}),g.onDidChangeTextDocument(e=>{const t=e.textDocument.uri,n=d.get(t),i=u.runChanges(e,n);w&&(f.parseLines(n,p,m,t,i),v(t))}),g.onDidCloseTextDocument(e=>{g.sendDiagnostics({diagnostics:[],uri:e.textDocument.uri}),d.delete(e.textDocument.uri)}),g.onDidChangeWatchedFiles(async e=>{x((await p.handleChanges(e)).misc)}),g.onCompletion(e=>{const t=d.get(e.textDocument.uri),i=t.lines[e.position.line],o=()=>s.computeCompletions(e.position.line,e.position.character,t,p);return w?i.hasOwnProperty("parseInfo")?o():n.promisify(t=>m.once(`${e.textDocument.uri}:${e.position.line}`,t))().then(o):[]}),g.onHover(e=>{if(w){const n=C(e);if(n){function t(e,t,n,i){const o={character:e.reduce((e,t)=>Math.max(e,t.high),0),line:n},r={character:e.reduce((e,t)=>Math.min(e,t.low),t.text.length),line:n};return{contents:i(e),range:{start:r,end:o}}}const i=b(n,e.position,"hover");if(i.length>0)return t(i,n,e.position.line,e=>e.map(e=>e.data));{const i=I(n);if(i){const o=i.search(e.position.character,e.position.character);if(o.length>0)return t(o,n,e.position.line,e=>e.map(e=>{const t=u.followPath(p.globalData.commands,e.path);return`${"literal"===t.type?"literal":`\`${t.parser}\` parser`} on path '${e.path.join(", ")}'`}))}}}}});
},{"./completions":"aDYY","./data/cache":"T7Hz","./data/manager":"zth0","./misc-functions":"irtH","./misc-functions/third_party/merge-deep":"NZkF","./parse":"X+eG"}]},{},["7QCb"], null)
//# sourceMappingURL=/index.map